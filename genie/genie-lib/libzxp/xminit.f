      SUBROUTINE XMINIT
C To initialize ZXPLOT package (Called by XDEVIC when setting up device)
      CHARACTER CLABEL*20
CPV
C
      COMMON /XPVD01/ IPV,IPSC,IPSCTMP,ICOLTX(4),IPSCEXP,IMASKCOL
C
C
      include 'colours.inc'
CPV
C
      INTEGER J
      INTEGER IPV
      INTEGER IPSC
      INTEGER ICOLTX
      INTEGER IPSCEXP
      INTEGER IMASKCOL
      REAL PL
      REAL PR
      REAL XSIDE
      REAL PB
      REAL PT
      REAL YSIDE
      REAL XRANGE
      REAL YRANGE
      REAL X1
      REAL X2
      REAL Y1
      REAL Y2
      REAL XSCALE
      REAL YSCALE
      REAL XFACTR
      REAL YFACTR
      REAL XMREF
      REAL YMREF
      REAL XMPREF
      REAL YMPREF
      REAL XPREF
      REAL DXPO
      REAL DYPO
      REAL DXMOP
      REAL DYMOP
      REAL XMPEN
      REAL YMPEN
      REAL HCTR
      REAL SCTR
      REAL CRATIO
      INTEGER KFONT
      INTEGER NUNDLN
      REAL DRANG
      REAL CRANG
      REAL SRANG
      INTEGER KSR
      REAL XA
      REAL YA
      REAL SINDRA
      REAL COSDRA
      REAL SINMRA
      REAL COSMRA
      REAL SINSRA
      REAL COSSRA
      REAL SINXA
      REAL COSXA
      REAL SINYA
      REAL COSYA
      REAL XANGLE
      REAL XSYMAN
      REAL CHSIN
      REAL CHCOS
      REAL HHH
      REAL HF1
      REAL HB1
      REAL HF2
      REAL HB2
      INTEGER LFULL
      INTEGER LTHICK
      REAL DTHICK
      INTEGER ICLI
      INTEGER LCLAB
      REAL DLABEL
      REAL HLABEL
      REAL SIZLB
      INTEGER LABROT
      INTEGER KLBTYP
      REAL WLABEL
      INTEGER ICLON
      REAL CLREF
      INTEGER LCPTN
      INTEGER LABTYP
      INTEGER ICLF
      INTEGER LHILIT
      INTEGER IHLF
      INTEGER KCT0
      INTEGER KANX
      INTEGER KTKX
      INTEGER KANY
      INTEGER KTKY
      INTEGER LLBFMT
      INTEGER LAXFMT
      REAL DH
      INTEGER KARTYP
      INTEGER KVMODE
      REAL VSC
      INTEGER NTMAG
      INTEGER NMIN
      INTEGER NMAX
      INTEGER NSUBDV
      INTEGER MTD
      REAL PI
      INTEGER I
      REAL XCIR
      REAL YCIR
      REAL RPOINT
      INTEGER KPROJC
      INTEGER IASCII
      INTEGER IPSCTMP
      REAL YPREF
      REAL XPEN
      REAL YPEN
      REAL FLEN
      REAL BLEN
      INTEGER NPD
      REAL XCHPEN
      REAL YCHPEN
      REAL XCHMO
      REAL YCHMO
      REAL XCHPO
      REAL YCHPO
      REAL ANMAG
      REAL ANSIZ
C     
      COMMON /XPSD01/ XSIDE, YSIDE
      COMMON /XPHY01/ PL,PR,PB,PT,XRANGE,YRANGE
      COMMON /XPHO03/ DXPO,DYPO
      COMMON /XMAP04/ X1,X2,Y1,Y2,XSCALE,YSCALE
      COMMON /XMAO05/ DXMOP,DYMOP
      COMMON /XFTR06/ XFACTR,YFACTR
      COMMON /XPRF07/ XPREF,YPREF
      COMMON /XMRF08/ XMREF,YMREF,XMPREF,YMPREF
      COMMON /XAGS09/ DRANG,CRANG,XANGLE,XSYMAN,SRANG,KSR,XA,YA
      COMMON /XSCS10/ SINDRA,COSDRA,SINMRA,COSMRA,SINSRA,COSSRA
     :               ,SINXA,COSXA,SINYA,COSYA ,CHSIN,CHCOS
      COMMON /XPEN11/ XPEN,YPEN,FLEN,BLEN,NPD,XMPEN,YMPEN
      COMMON /XCHA20/ HCTR,SCTR,CRATIO, KFONT,NUNDLN
      COMMON /XASC12/ IASCII(300)
      COMMON /XCHP21/ XCHPEN, YCHPEN ,XCHMO,YCHMO,XCHPO,YCHPO
      COMMON /XLPN13/ HF1,HB1,HF2,HB2 , LFULL ,LTHICK, DTHICK
      COMMON /XLAB14/ DLABEL,WLABEL,HLABEL,SIZLB,KLBTYP,ICLI,ICLON
      COMMON /XLAB15/ CLABEL
      COMMON /XLAB16/ LCLAB
      COMMON /XLBA33/ LABROT
      COMMON /XCRF17/ CLREF,LCPTN,LABTYP,ICLF,LHILIT,IHLF,KCT0
      COMMON /XAXS18/ KANX,KANY, KTKX,KTKY
      COMMON /XCLM19/ NMIN, NMAX
      COMMON /XCDV23/ NSUBDV
      COMMON /XCMD24/ MTD
      COMMON /XCIR25/ XCIR(9) ,YCIR(9) , RPOINT
      COMMON /XPRJ26/ KPROJC
      COMMON /XCHR31/ CHDATA
      COMMON /XCHR32/ ICDATA
      COMMON /XFMT33/ LBFMT, AXFMT
      COMMON /XFMT34/ LLBFMT,LAXFMT
      COMMON /XHCH35/ DH
      COMMON /XART36/ KARTYP,KVMODE,VSC
      COMMON /XAXM35/ NTMAG, ANMAG, ANSIZ
      CHARACTER CHDATA(127)*300,LBFMT*50,AXFMT*10
      INTEGER ICDATA (0:150, 32:127)
      INTEGER NASCII(300)
      DATA (NASCII(J),J=64,300) /
     +32 ,
*  65-80
     +000,000,000,000,000,000,000,000,000,000,46 ,60 ,40 ,43 ,124,38 ,
*  81-96
     +000,000,000,000,000,000,000,000,000,33 ,36 ,42 ,41 ,59 ,126,45 ,
*  97-112
     +47 ,000,000,000,000,000,000,000,000,000,44 ,37 ,95 ,62 ,63 ,000,
*  113-128
     +94 ,000,000,000,000,000,000,000,96 ,58 ,35 ,64 ,000,61 ,34 ,000,
*  129-144
     +97 ,98 ,99 ,100,101,102,103,104,105,000,000,000,000,000,000,000,
*  145-160
     +106,107,108,109,110,111,112,113,114,000,000,000,000,000,000,000,
*  161-176
     +000,115,116,117,118,119,120,121,122,000,000,000,91 ,000,000,000,
*  177-192
     +000,000,000,000,000,000,000,000,000,000,000,000,93 ,000,000,123,
*  193-208
     +65 ,66 ,67 ,68 ,69 ,70 ,71 ,72 ,73 ,000,000,000,000,000,000,125,
*  209-224
     +74 ,75 ,76 ,77 ,78 ,79 ,80 ,81 ,82 ,000,000,000,000,000,000,92 ,
*  225-240
     +000,83 ,84 ,85 ,86 ,87 ,88 ,89 ,90 ,000,000,000,000,000,000,48 ,
*  241-256
     +49 ,50 ,51 ,52 ,53 ,54 ,55 ,56 ,57 ,000,000,000,000,000,000,000,
*  257-272
     +000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,
*  273-288
     +000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,
*  289-300
     +000,000,000,000,000,000,000,000,000,000,000,000             /
C Note XSIDE and YSIDE are the length of the ND-space x and y sides.
C They should be defined outside this package passing through common
C block PSIDES. The prefered values are XSIDE=1.5, YSIDE=1.0
CPV
      DO 15 J=1,63
 15   NASCII(J)=0
      IPV=1
      IPSC=0
      ICOLTX(1)=1
      ICOLTX(2)=1
      ICOLTX(3)=0
      ICOLTX(4)=1
      IPSCEXP=0
      IMASKCOL=-1
CPV
      GIFARRAY(1,0)=-999
      PL=0.0
CPV
      PR=XSIDE
C     PR=YSIDE
CPV
      PB=0.0
      PT=YSIDE
      XRANGE=PR-PL
      YRANGE=PT-PB
      X1=0.0
      X2=1.0
      Y1=0.0
      Y2=1.0
      XSCALE=X2-X1
      YSCALE=Y2-Y1
      XFACTR=XRANGE/XSCALE
      YFACTR=YRANGE/YSCALE
      XMREF=X1
      YMREF=Y1
      XMPREF=PL
      YMPREF=PB
      XPREF=0.5*(PL+PR)
      XPREF=0.5*(PT+PB)
      DXPO=0.0
      DYPO=0.0
      DXMOP=0.0
      DYMOP=0.0
      XMPEN=XMREF
      YMPEN=YMREF
      HCTR=0.02
      SCTR=0.02/YFACTR
      CRATIO=0.75
      KFONT=2
      NUNDLN=0
      DRANG=0.0
      CRANG=0.0
      SRANG=90.0
      KSR=0
      XA=0.0
      YA=0.0
      SINDRA=0.0
      COSDRA=1.0
      SINMRA=0.0
      COSMRA=1.0
      SINSRA=1.0
      COSSRA=0.0
      SINXA=0.0
      COSXA=1.0
      SINYA=0.0
      COSYA=1.0
 
      XANGLE=CRANG+DRANG+(90-SRANG)*KSR+XA
      XSYMAN=0.0
      CHSIN=0.0
      CHCOS=1.0
 
      HHH  =0.001*YSIDE
      HF1=HHH*10
      HB1=HHH*5
      HF2=HHH*10
      HB2=HHH*5
      LFULL=1
      LTHICK=1
      DTHICK=0.0007*YSIDE
 
      ICLI=3
      CLABEL=' '
      LCLAB=1
      DLABEL=XRANGE/ICLI
      HLABEL=0.015
      SIZLB =0.015
      LABROT=1
      KLBTYP=-1
      WLABEL=HLABEL*LCLAB*0.77
      ICLON=0
 
      CLREF=0.0
      LCPTN=0
      LABTYP=2
      ICLF=2
      LHILIT=1
      IHLF=4
      KCT0=1
 
      KANX=-1
      KTKX=1
      KANY=-1
      KTKY=1
      AXFMT= '*'
      LBFMT= '*'
      LLBFMT=1
      LAXFMT=1
      DH=0.015
      KARTYP=2
      KVMODE=1
      VSC=1.0
      NTMAG=0
 
      NMIN=8
      NMAX=20
 
      NSUBDV=4
      MTD=0
 
      PI=4*ATAN(1.)
      DO 6 I=1,9
      XCIR(I)=COS((I-1)*0.25*PI)
 6    YCIR(I)=SIN((I-1)*0.25*PI)
      RPOINT=0.0010*YSIDE
      KPROJC=0
      DO 10 I=1,300
 10   IASCII(I)=NASCII(I)
 
      GOTO ( 501, 502, 503, 504 ) KFONT
 501  CALL XCSETB(CHDATA)
      GOTO 505
 502  CALL XCSETC(CHDATA)
      GOTO 505
 503  CALL XCSETA(CHDATA)
      GOTO 505
 504  CALL XCSETD(CHDATA)
 505  CONTINUE
      DO 1 I=32,127
 1      ICDATA(0,I)=0
      RETURN
      END
