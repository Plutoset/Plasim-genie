(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    643484,      15199]
NotebookOptionsPosition[    632308,      14896]
NotebookOutlinePosition[    632667,      14912]
CellTagsIndexPosition[    632624,      14909]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["1. Set-up ensemble", "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.40006644521875*^9}, {
   3.40006649821875*^9, 3.400066566703125*^9}, {3.437727312162577*^9, 
   3.437727319537369*^9}, 3.438600136025002*^9}],

Cell[BoxData[{
 RowBox[{"nvars", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"varvalues", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "varvalues", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nruns", "=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"nvars", "[", 
     RowBox[{"[", "i", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "vartitles", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nvar", "=", 
  RowBox[{"Length", "[", "nvars", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ensemtitles", "=", 
   RowBox[{"Tuples", "[", "varvalues", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.441538341116005*^9, {3.449404058155914*^9, 3.449404058507246*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"runtimeroot", "~~", "\"\<genie_configpatches\>\""}], 
  "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437305180442156*^9, 3.437305224812024*^9}, {
   3.437305661211609*^9, 3.437305670940866*^9}, {3.437305919504172*^9, 
   3.437305920845261*^9}, {3.437312334053088*^9, 3.437312337551785*^9}, 
   3.437312609333096*^9, 3.437312855434543*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", "ensembledatafile", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437305672496187*^9, 3.437305689387822*^9}, {
   3.437305746959771*^9, 3.437305749869405*^9}, {3.437305904154634*^9, 
   3.437305916043773*^9}, 3.43731225448402*^9, 3.437312855434631*^9, 
   3.437730185266686*^9}],

Cell[BoxData[
 RowBox[{"data", "//", "TableForm"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437388124227457*^9, 3.437388127723834*^9}, 
   3.437727278991881*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ensemblevariables", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ensemblevariables", ",", 
        RowBox[{"data", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437385216043894*^9, 3.437385239098998*^9}, {
   3.437462244949592*^9, 3.437462258499213*^9}, {3.43746228928843*^9, 
   3.4374623086146*^9}, {3.437462838206169*^9, 3.437462845353513*^9}, {
   3.437480515288293*^9, 3.4374805178425*^9}, 3.437727278992127*^9, {
   3.448033150327888*^9, 3.448033153162504*^9}}],

Cell[BoxData[
 RowBox[{"ensemblevariables", "//", "TableForm"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437385246631396*^9, 3.437385250359722*^9}, 
   3.437727278992213*^9}],

Cell[BoxData[
 RowBox[{"ensemblenos", "=", 
  RowBox[{"Tuples", "[", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nvar"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437462334227381*^9, 3.437462426710731*^9}, {
   3.437462484557187*^9, 3.437462487913423*^9}, {3.437462611810893*^9, 
   3.43746261521469*^9}, {3.437462872125887*^9, 3.437462881465459*^9}, 
   3.437727278992378*^9, 3.448033240173172*^9, {3.449491694825908*^9, 
   3.449491701804827*^9}, 3.449491933496463*^9}],

Cell[BoxData[
 RowBox[{"ensemblenames", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"ensemblenos", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"ensemblenos", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437462619427707*^9, 3.437462641757507*^9}, {
   3.43746267643106*^9, 3.437462760389817*^9}, 3.437727278992462*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data2", "=", "data"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"data2", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"data2", ",", 
       RowBox[{"ensemblevariables", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "ensemblevariables", "]"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.448033398402607*^9, 3.448033459761943*^9}, {
  3.44803364429108*^9, 3.448033650815338*^9}}],

Cell[BoxData[
 RowBox[{"data2", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.44803346195415*^9, 3.448033465250487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combos", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ensemblevariables", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "ensemblevariables", "]"}]}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437308268887915*^9, 3.437308308260672*^9}, {
   3.437308367715228*^9, 3.437308369409268*^9}, {3.437308477300217*^9, 
   3.437308478463541*^9}, 3.437309149907782*^9, {3.437312717574444*^9, 
   3.437312718528534*^9}, 3.43731285543498*^9, 3.437318195835075*^9, 
   3.437318490407573*^9, 3.437319581914832*^9, 3.437385272746102*^9, 
   3.448034010155017*^9, {3.448034068519421*^9, 3.448034087786552*^9}, {
   3.448035260975069*^9, 3.44803526457807*^9}, 3.448035844180265*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{
             RowBox[{"combos", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "grouper"}], "]"}],
            "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"divisions", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{
                 RowBox[{"combos", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "grouper"}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"StringPosition", "[", 
                  RowBox[{
                   RowBox[{"combos", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "grouper"}], 
                  "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"divisions", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"divisions", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"divisions", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "+", "1"}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", "divisions", "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", 
            RowBox[{"PrependTo", "[", 
             RowBox[{"divisions", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"divisions", ",", 
             RowBox[{"StringLength", "[", 
              RowBox[{"combos", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"divisions", "=", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "divisions", "]"}], ",", "2"}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"combos", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"combos", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                RowBox[{"divisions", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", "divisions", "]"}]}], "}"}]}], 
             "]"}]}]}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"combos", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"combos", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"combos", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "combos", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.448034380941491*^9, 3.448034485646677*^9}, {
  3.448034604381918*^9, 3.448034651592639*^9}, {3.448034684979101*^9, 
  3.448034693094561*^9}, {3.44803474496352*^9, 3.448034758202669*^9}, {
  3.448034851597198*^9, 3.448034912847838*^9}, {3.448034996109511*^9, 
  3.448035014542403*^9}, {3.448035046239887*^9, 3.448035118148189*^9}, {
  3.44803517696527*^9, 3.448035198889271*^9}, {3.448035234879873*^9, 
  3.448035332278723*^9}, {3.44803541640471*^9, 3.448035419851892*^9}, {
  3.448035605292502*^9, 3.448035634800794*^9}, {3.448035705032129*^9, 
  3.44803575102898*^9}, {3.448035973430007*^9, 3.448036022570307*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "data2", ",", 
    "\"\<# --- GENERATED ENSEMBLE VARIABLES \
------------------------------\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.448036157136875*^9, 3.448036235099135*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ensemble", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"data2", ",", 
        RowBox[{"combos", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "combos", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.43730834831728*^9, 3.43730835214054*^9}, {
   3.437308415212715*^9, 3.437308426509233*^9}, {3.437308484349802*^9, 
   3.437308564612874*^9}, 3.43731285543506*^9, 3.437319109834671*^9, {
   3.437319185030524*^9, 3.437319185349919*^9}, {3.437319550358546*^9, 
   3.437319550563873*^9}, {3.437385281789301*^9, 3.43738528897278*^9}, {
   3.43738538167751*^9, 3.437385430211385*^9}, {3.437388556033823*^9, 
   3.437388560172378*^9}, {3.43738957448816*^9, 3.437389580792564*^9}, {
   3.437480706592944*^9, 3.437480723759231*^9}, {3.448036263357203*^9, 
   3.448036289909379*^9}, {3.448036381819408*^9, 3.448036381958136*^9}}],

Cell[BoxData[
 RowBox[{"StringDrop", "[", 
  RowBox[{"ensembledatafile", ",", 
   RowBox[{"-", "4"}]}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437462177597984*^9, 3.437462184203157*^9}, 
   3.437727278992567*^9, 3.43773018529467*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"configpatchnames", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
      RowBox[{"ensemblenames", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "ensemblenames", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437309086525793*^9, 3.437309108096391*^9}, 
   3.437312855435231*^9, {3.437399179531263*^9, 3.437399180614523*^9}, {
   3.437399787291454*^9, 3.437399796005046*^9}, {3.437462190976701*^9, 
   3.437462200191472*^9}, {3.437462807498799*^9, 3.437462809622643*^9}, 
   3.437730185304919*^9, {3.443191130326613*^9, 3.443191136977477*^9}, {
   3.448033940030489*^9, 3.448033942200061*^9}, 3.448036328664929*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"ensemble", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"configpatchnames", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], "}"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437386337713633*^9, 3.437386401429137*^9}, 
   3.437727278992656*^9}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"ensemoutput", "\[Equal]", "1"}], ",", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"configpatchnames", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"ensemble", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Text\>\""}], "]"}], ";"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "ensemble", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.43730858845427*^9, {3.437308656844641*^9, 3.437308741729794*^9}, {
   3.437309119765719*^9, 3.437309122228322*^9}, 3.437312855435312*^9, {
   3.43772624579504*^9, 3.437726247458486*^9}, 3.437743887082997*^9, {
   3.443191165351613*^9, 3.443191176978434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<#!/bin/bash\>\"", ",", "\n", "\"\<#$-q short.q\>\"", ",", "\n", 
     "\"\<#$-cwd\>\"", ",", "\n", "\"\<#$-j y\>\"", ",", "\n", 
     "\"\<#$-o run_log/\>\"", ",", "\[IndentingNewLine]", "\"\<#\>\"", ",", 
     "\[IndentingNewLine]", "\"\<cd ../genie/genie-tools/runscripts\>\""}], 
    "}"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437308872698663*^9, 3.437308936731315*^9}, 
   3.43731285543539*^9, {3.445700097652572*^9, 3.445700159055496*^9}, {
   3.449228330868396*^9, 3.449228331138156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"linestart", "=", 
   RowBox[{
   "\"\</bin/bash qsub_rungenie_2.sh \>\"", "~~", "config", "~~", 
    "\"\< \>\""}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437308964945929*^9, 3.437308996977038*^9}, 
   3.437309261429315*^9, {3.437312497080707*^9, 3.437312539455997*^9}, 
   3.43731285543547*^9, {3.445697097612621*^9, 3.445697099113401*^9}, {
   3.445697375874232*^9, 3.44569737681419*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineend", "=", 
   RowBox[{"\"\< \>\"", "~~", 
    RowBox[{"ToString", "[", "nyears", "]"}], "~~", "\"\< \>\"", "~~", 
    RowBox[{"ToString", "[", "saveblock", "]"}], "~~", "\"\< \>\"", "~~", 
    RowBox[{"ToString", "[", "startyear", "]"}]}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437308991293896*^9, 3.437309047470191*^9}, {
   3.437312350535358*^9, 3.437312429951935*^9}, {3.437312748021003*^9, 
   3.43731277860915*^9}, {3.437312809253908*^9, 3.437312813795105*^9}, 
   3.437312855435549*^9, {3.453036205870787*^9, 3.453036225997066*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qsub", "=", "header"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437309236845291*^9, 3.43730923996475*^9}, 
   3.437309331971712*^9, 3.437312855435636*^9, 3.437386452744617*^9}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"qsub", ",", 
      RowBox[{"linestart", "~~", 
       RowBox[{"configpatchnames", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "~~", "lineend", "~~", "\"\< \>\"", "~~",
        "restart", "~~", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dropvar", "<", "0"}], ",", "\"\<\>\"", ",", 
         RowBox[{"StringDrop", "[", 
          RowBox[{
           RowBox[{"ensemblenames", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "dropvar"}], "]"}]}], 
        "]"}]}]}], "]"}], ";", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"qsub", ",", "\"\<sleep 3\>\""}], "]"}], ";"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "ensemble", "]"}]}], "}"}]}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437309058107655*^9, 3.437309059597661*^9}, {
   3.437309202695956*^9, 3.43730934584069*^9}, 3.437309399077782*^9, 
   3.437312855435713*^9, 3.437394277077922*^9, {3.437394927301978*^9, 
   3.437394927425556*^9}, 3.437463616347103*^9, {3.453036228093845*^9, 
   3.453036230585668*^9}, {3.453546616385504*^9, 3.453546623057978*^9}, {
   3.453546694854614*^9, 3.453546702244574*^9}, {3.453639567517257*^9, 
   3.453639576685488*^9}}],

Cell[BoxData[
 RowBox[{"qsub", "//", "TableForm"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437309412399374*^9, 3.437309416221157*^9}, 
   3.437312855435793*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"datestring", "=", 
   RowBox[{"ToString", "[", 
    RowBox[{"PaddedForm", "[", 
     RowBox[{
      RowBox[{"Date", "[", "]"}], ",", "5", ",", 
      RowBox[{"NumberPadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<0\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"commas", "=", 
   RowBox[{"StringPosition", "[", 
    RowBox[{"datestring", ",", "\"\<,\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{"date", "=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringTake", "[", 
      RowBox[{"datestring", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"commas", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "2"}], ",", 
         RowBox[{
          RowBox[{"commas", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "commas", "]"}]}], "}"}]}], "]"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"date2", "=", 
   RowBox[{"date", "~~", 
    RowBox[{"StringTake", "[", 
     RowBox[{"datestring", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", 
        RowBox[{"-", "6"}]}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4373116685171*^9, 3.437311695295956*^9}, {
   3.437311906309518*^9, 3.437311910912631*^9}, 3.437312079237319*^9, 
   3.437312855435875*^9, 3.43861622364723*^9, 3.438616436068714*^9, {
   3.438616466709279*^9, 3.438616481574791*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"runtimeroot", "~~", "\"\<genie_runlog\>\""}], "]"}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437313296207452*^9, 3.437313299878512*^9}, 
   3.437318174670967*^9, {3.445953443625007*^9, 3.445953488896438*^9}, {
   3.449228885420027*^9, 3.449228886683226*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"ensemoutput", "\[Equal]", "1"}], ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<qsub_rungenie_expt_\>\"", "~~", "date"}], ",", "qsub", ",", 
     "\"\<Text\>\""}], "]"}]}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437309453720287*^9, 3.437309462942131*^9}, {
   3.437309537742015*^9, 3.43730954463957*^9}, {3.437312097295039*^9, 
   3.437312158608758*^9}, 3.437312855436128*^9, {3.437313269335313*^9, 
   3.437313271425142*^9}, {3.437726211023338*^9, 3.437726228880369*^9}, 
   3.437743893630581*^9, {3.443191210281732*^9, 3.443191218242106*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Set-up results", "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.40006644521875*^9}, {
   3.40006649821875*^9, 3.400066566703125*^9}, {3.437727332049819*^9, 
   3.437727336449887*^9}, 3.43860013906525*^9}],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
   RowBox[{"archivefolder", "=", 
    RowBox[{
    "\"\<G:\\\\home\\\\gcolbourn\\\\Documents\\\\cluster1 stuff\\\\\>\"", "~~", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"archivefoldersuffix", ",", 
       RowBox[{"\"\</\>\"", "\[Rule]", "\"\<\\\\\>\""}]}], "]"}]}]}], ",", 
   RowBox[{"archivefolder", "=", 
    RowBox[{"runtimeroot", "~~", "archivefoldersuffix"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
   RowBox[{"outputfolder", "=", 
    RowBox[{
    "\"\<G:\\\\home\\\\gcolbourn\\\\Documents\\\\cluster1 stuff\\\\\>\"", "~~", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"outputfoldersuffix", ",", 
       RowBox[{"\"\</\>\"", "\[Rule]", "\"\<\\\\\>\""}]}], "]"}]}]}], ",", 
   RowBox[{"outputfolder", "=", 
    RowBox[{"runtimeroot", "~~", "outputfoldersuffix"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
   RowBox[{"resultsfolder", "=", 
    RowBox[{"\"\<G:\\\\\>\"", "~~", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"resultsfoldersuffix", ",", 
       RowBox[{"\"\</\>\"", "\[Rule]", "\"\<\\\\\>\""}]}], "]"}]}]}], ",", 
   RowBox[{"resultsfolder", "=", 
    RowBox[{
    "runtimeroot", "~~", "resultsfoldersuffix", "~~", "ensemblename"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.420974776589038*^9, {3.42574420718297*^9, 3.425744259503344*^9}, 
   3.432925717240114*^9, 3.437729939663035*^9, {3.437730336956736*^9, 
   3.437730353030532*^9}, 3.437748054567616*^9, {3.437748099924204*^9, 
   3.437748100276252*^9}, 3.437845884317079*^9, {3.447088292707085*^9, 
   3.447088345832435*^9}, {3.447088442134716*^9, 3.447088448306633*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"nruns", "\[Equal]", "1"}], ",", 
    RowBox[{
     RowBox[{"runids", "=", 
      RowBox[{"{", "configshort", "}"}]}], ";", 
     RowBox[{"runidslong", "=", 
      RowBox[{"{", 
       RowBox[{"config", "~~", "\"\<.\>\"", "~~", "configpatch"}], "}"}]}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"runids", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
        "configshort", "~~", "\"\<.\>\"", "~~", "ensemshort", "~~", 
         "\"\<_\>\"", "~~", 
         RowBox[{"ensemblenames", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runidslong", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"config", "~~", "\"\<.\>\"", "~~", 
         RowBox[{"configpatchnames", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ";"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.443194466069848*^9, 3.443194564796686*^9}, {
  3.444471529772019*^9, 3.444471530822548*^9}}],

Cell[BoxData[
 RowBox[{"runids", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.429456779428397*^9, 3.429456783060244*^9}, 
   3.435489407093715*^9, {3.443194508022165*^9, 3.443194509938158*^9}}],

Cell[BoxData[
 RowBox[{"runidslong", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.429456789109263*^9, 3.429456790788937*^9}, 
   3.435927296665291*^9, 3.436100926356923*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmodules", "=", 
   RowBox[{"Length", "[", "modules", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"nfilenames", "=", 
    RowBox[{"shortfilenames", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "nmodules", "}"}]}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.449331739764493*^9, 3.449331764936702*^9}, {
  3.449332619126485*^9, 3.449332655832499*^9}, {3.449332796154225*^9, 
  3.449332796245981*^9}, {3.449333740650164*^9, 3.449333741271542*^9}, {
  3.449333963199907*^9, 3.449333963468897*^9}, {3.449340804119933*^9, 
  3.449340807283965*^9}, {3.449340901659104*^9, 3.449340901823024*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SetDirectory", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
         RowBox[{"runids", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
         RowBox[{"modules", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"\"\</\>\"", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
           "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filenames", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"nfilenames", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"shortfilenames", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{"{", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringCases", "[", 
            RowBox[{
             RowBox[{"FileNames", "[", "]"}], ",", "\"\<series\>\""}], "]"}], 
           "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
          RowBox[{"{", "\"\<series\>\"", "}"}]}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{
           RowBox[{"filenames", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"FileNames", "[", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"FileNames", "[", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nfilenames", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", 
      RowBox[{"Length", "[", 
       RowBox[{"filenamenos", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"shortfilenames", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"o", "+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "1"}], ",", "0", ",", 
             RowBox[{"nfilenames", "[", 
              RowBox[{"[", 
               RowBox[{"j", "-", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"filenames", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", 
                 RowBox[{"filenamenos", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"15", ",", 
                RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"\"\<_\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"o", ",", 
          RowBox[{"nfilenames", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"i", ",", 
       RowBox[{"shortfilenames", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.40568105446875*^9, 3.40568106134375*^9}, {
   3.40568112484375*^9, 3.405681169921875*^9}, 3.405682975578125*^9, {
   3.4056831911875*^9, 3.4056832191875*^9}, 3.405683251375*^9, {
   3.405954274375*^9, 3.405954290484375*^9}, 3.4064602158125*^9, {
   3.412506955086789*^9, 3.412506957180737*^9}, {3.413633526521269*^9, 
   3.413633533011408*^9}, {3.413633622560993*^9, 3.413633626055824*^9}, {
   3.413634024234622*^9, 3.413634060815319*^9}, {3.413634370702666*^9, 
   3.413634383329464*^9}, {3.416915831960219*^9, 3.416915833284295*^9}, {
   3.416915866563551*^9, 3.416915901570986*^9}, 3.416915940295479*^9, {
   3.416916212711458*^9, 3.416916237962626*^9}, {3.41691648356764*^9, 
   3.41691648401001*^9}, {3.418570594765625*^9, 3.418570596078125*^9}, 
   3.418653983171875*^9, {3.418730069352401*^9, 3.418730070410226*^9}, {
   3.419150537453138*^9, 3.419150543769904*^9}, {3.420292234703125*^9, 
   3.420292262765625*^9}, {3.420974932459383*^9, 3.420974932761445*^9}, {
   3.420974981961089*^9, 3.42097504920739*^9}, {3.433517938307689*^9, 
   3.433517981962365*^9}, 3.447089920915796*^9, 3.447089961390764*^9, {
   3.447091445226249*^9, 3.447091451303115*^9}, 3.447091603755146*^9, {
   3.449331779776346*^9, 3.449331788760982*^9}, {3.449331821075534*^9, 
   3.449331828750874*^9}, {3.449331942884233*^9, 3.449331943072048*^9}, {
   3.449332394921558*^9, 3.44933239584822*^9}, {3.449332455140278*^9, 
   3.449332463310565*^9}, {3.449332682052312*^9, 3.449332740380363*^9}, {
   3.449333065917264*^9, 3.449333067057826*^9}, {3.449333107966489*^9, 
   3.449333145589846*^9}, {3.449333701019214*^9, 3.449333702869451*^9}, {
   3.449333743516143*^9, 3.449333743844179*^9}, {3.449333821710575*^9, 
   3.449333849191146*^9}, {3.449333960394198*^9, 3.449333984162127*^9}, {
   3.449334030945402*^9, 3.449334054889826*^9}, {3.449340800380933*^9, 
   3.449340812861128*^9}, {3.449340873325955*^9, 3.449340900556914*^9}, 
   3.449905077828073*^9}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"shortfilenames", "[", 
      RowBox[{"[", "j", "]"}], "]"}], "//", "TableForm"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.449335307313322*^9, 3.44933534661411*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"filenames", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"filenames", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
     "TableForm"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.422098069691958*^9, 3.422098140608643*^9}, 
   3.42209818421513*^9, 3.42453611837479*^9, {3.449333627755319*^9, 
   3.449333640717381*^9}, {3.449334099012357*^9, 3.449334100465105*^9}, {
   3.449334131348616*^9, 3.449334136369762*^9}, {3.449335357291222*^9, 
   3.449335389510263*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Import data, then export to .xls files", "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066498234375*^9}, 
   3.40006656671875*^9, {3.400072210765625*^9, 3.400072236359375*^9}, 
   3.438600140410165*^9, {3.447090974499921*^9, 3.447090980098923*^9}, {
   3.447091105410268*^9, 3.447091107810409*^9}}],

Cell[CellGroupData[{

Cell["3 a. Read in data", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.42028242375*^9, 3.420282431671875*^9}, 3.4202824705625*^9, 
   3.438600144092343*^9, 3.447091176068694*^9}],

Cell[CellGroupData[{

Cell["ii. Read in data direct from ouptut folders", "Subsection",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066498234375*^9}, 
   3.40006656671875*^9, {3.400072210765625*^9, 3.400072236359375*^9}, 
   3.438600140410165*^9, {3.447090987428429*^9, 3.447091015395765*^9}, {
   3.447091066548961*^9, 3.447091089810422*^9}, 3.447091145747695*^9, {
   3.447091183428233*^9, 3.447091183650327*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"data2", "=", 
    RowBox[{"columntitles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nfilenames", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", "nruns", "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"filename", "=", 
     RowBox[{"filenames", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", 
        RowBox[{"filenamenos", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\n-- \>\"", "~~", "filename", "~~", "\"\< --\\n\>\""}], 
     "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<processing \>\"", "~~", 
         RowBox[{"runids", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", 
        RowBox[{"outputfolder", "~~", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
           "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
         RowBox[{"runids", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "~~", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
           "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
         RowBox[{"modules", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Import", "[", "filename", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data2", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"data", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"titlestring", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", "\"\< \>\""}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"data", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"slashes", "=", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"titlestring", ",", 
          RowBox[{"columntitledividers", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"slashes2", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"slashes", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "slashes", "]"}]}], "}"}]}], "]"}], 
            ",", "2"}], "]"}], ",", 
          RowBox[{"StringLength", "[", "titlestring", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"slashes3", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"slashes2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"slashes2", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"Length", "[", "slashes2", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"columntitles", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"titlestring", ",", 
            RowBox[{"slashes3", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "slashes3", "]"}]}], "}"}]}], "]"}]}], 
       ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", " ", "nruns"}], "}"}]}], "]"}], ";"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"j", ",", "nmodules"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"o", ",", 
     RowBox[{"nfilenames", "[", 
      RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.453648079040388*^9, 3.453648097280603*^9}, {
  3.453648374263811*^9, 3.453648433927595*^9}, {3.453648508656731*^9, 
  3.453648509181136*^9}, {3.453648929451217*^9, 3.453648949933952*^9}, {
  3.453649154643218*^9, 3.45364918408242*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3 b. Export to .xls files", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.42028242375*^9, 3.420282431671875*^9}, 3.4202824705625*^9, 
   3.438600144092343*^9, {3.447091176068694*^9, 3.447091201475065*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"data2", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"data2", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"___", ",", "$Failed", ",", "___"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"o", ",", 
      RowBox[{"nfilenames", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4064610354375*^9, 3.406461125703125*^9}, 
   3.420274736503625*^9, {3.449334912205724*^9, 3.449334912684616*^9}, 
   3.449335103121739*^9, 3.449335170728045*^9, {3.449335481853687*^9, 
   3.44933548326061*^9}, {3.449339653989768*^9, 3.44933965485566*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"data2", "[", 
      RowBox[{"[", "j", "]"}], "]"}], "//", "TableForm"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.449335222807071*^9, 3.449335279574142*^9}, {
  3.449335401160638*^9, 3.449335416918466*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"columntitles2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"columntitles", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "o", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"filenames", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", 
          RowBox[{"filenamenos", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"o", ",", 
       RowBox[{"nfilenames", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.406039757171875*^9, 3.406039796078125*^9}, {
   3.406039849578125*^9, 3.406039873265625*^9}, 3.420274706909875*^9, 
   3.4202931704375*^9, 3.449335062103937*^9, {3.449335499031359*^9, 
   3.449335522590863*^9}}],

Cell[BoxData[
 RowBox[{"columntitles2", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.41922673193302*^9, 3.419226741187695*^9}}],

Cell[BoxData["columntitles2"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"valueoutput", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"data2", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "o", ",", "k", ",", "i", ",", "n"}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"o", ",", 
       RowBox[{"nfilenames", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "2", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"data2", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "nruns"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"data2", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4059533906875*^9, 3.40595339109375*^9}, {
   3.40595379571875*^9, 3.4059537960625*^9}, 3.40595437534375*^9, {
   3.405955090984375*^9, 3.405955092734375*^9}, {3.449334913738901*^9, 
   3.449334915902254*^9}, {3.449335561418235*^9, 3.449335635787954*^9}, {
   3.449339658517889*^9, 3.449339659764987*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"columntitles", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "o", ",", "1"}], "]"}], "]"}], "!=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{
       RowBox[{"PrependTo", "[", 
        RowBox[{
         RowBox[{"valueoutput", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "o", ",", "n"}], "]"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"data2", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "1", ",", "1", ",", "i", ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data2", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], 
            "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"runids2", "=", 
        RowBox[{"Prepend", "[", 
         RowBox[{"runids", ",", 
          RowBox[{
           RowBox[{"columntitles", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "o", ",", "1", ",", 
              RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "~~", 
           "\"\< / year:\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"PrependTo", "[", 
          RowBox[{
           RowBox[{"valueoutput", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "o", ",", "n", ",", "k"}], "]"}], "]"}], ",", 
           RowBox[{"runids2", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"nruns", "+", "1"}]}], "}"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"valueoutput", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o", ",", "n"}], "]"}], "]"}], "//", 
        "TableForm"}], "]"}], "*)"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", "nmodules"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"o", ",", 
      RowBox[{"nfilenames", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"n", ",", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"data2", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
       "-", "1"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.397303565140625*^9, 3.39730357584375*^9}, {
   3.3973044488125*^9, 3.39730454834375*^9}, {3.397304819125*^9, 
   3.397304967703125*^9}, {3.3973050009375*^9, 3.397305091875*^9}, {
   3.397305123046875*^9, 3.397305123390625*^9}, {3.399728408203125*^9, 
   3.39972845075*^9}, 3.4000664990625*^9, 3.400066567125*^9, {
   3.40595048703125*^9, 3.405950530328125*^9}, {3.405952659359375*^9, 
   3.405952689640625*^9}, {3.40595274034375*^9, 3.4059527445625*^9}, {
   3.40595278965625*^9, 3.405952863484375*^9}, {3.40595306415625*^9, 
   3.405953089171875*^9}, {3.405953141046875*^9, 3.40595327459375*^9}, {
   3.405953382921875*^9, 3.40595338296875*^9}, {3.405953443734375*^9, 
   3.405953449890625*^9}, {3.405953549859375*^9, 3.4059535503125*^9}, {
   3.405953607390625*^9, 3.405953609546875*^9}, {3.40595367846875*^9, 
   3.405953756953125*^9}, 3.40595437603125*^9, {3.405954992578125*^9, 
   3.405954992875*^9}, {3.4059550573125*^9, 3.405955078171875*^9}, 
   3.40595511078125*^9, {3.41432770497571*^9, 3.414327714459198*^9}, 
   3.449334917819784*^9, {3.449335063141326*^9, 3.449335064088242*^9}, {
   3.449335692789014*^9, 3.449335767430754*^9}, {3.449336069153198*^9, 
   3.449336071320286*^9}, {3.44933618231123*^9, 3.449336184063833*^9}, {
   3.449337102071159*^9, 3.449337134610016*^9}, {3.4493396618545*^9, 
   3.449339663661231*^9}, {3.44933991429961*^9, 3.449339916689397*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CreateDirectory", "[", "resultsfolder", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "resultsfolder", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newdirectory", "=", "date"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateDirectory", "[", "newdirectory", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "newdirectory", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateDirectory", "[", "\"\<spreadsheets\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40595421909375*^9, 3.4059542193125*^9}, {
   3.40595468359375*^9, 3.405954751296875*^9}, {3.418045631447148*^9, 
   3.418045642868332*^9}, {3.418045729125949*^9, 3.418045730606485*^9}, 
   3.429458825536433*^9, {3.437730003036887*^9, 3.437730071163718*^9}, {
   3.437730185330001*^9, 3.437730199199943*^9}, {3.437730304809731*^9, 
   3.437730305068668*^9}, {3.437840893426595*^9, 3.437840897582639*^9}, {
   3.438533711990813*^9, 3.438533744345454*^9}, {3.438684925708059*^9, 
   3.43868492591744*^9}, {3.438684974810623*^9, 3.438685002798927*^9}, {
   3.438685419980732*^9, 3.438685420684483*^9}, {3.438685633169322*^9, 
   3.438685634216837*^9}, {3.447418803598625*^9, 3.447418805096189*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", "\"\<spreadsheets\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.438685016780076*^9, 3.438685017339175*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{"\"\<0_titles-\>\"", "~~", "date", "~~", "\"\<.xls\>\""}], "]"}],
     ",", "columntitles2"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.406038875078125*^9, 3.406038966234375*^9}, 
   3.418045665692821*^9, 3.429458876276978*^9, 3.429458962968997*^9, {
   3.437934241654069*^9, 3.437934245302839*^9}, {3.438684927530408*^9, 
   3.438684927676111*^9}, {3.447420309875525*^9, 3.447420310253495*^9}, {
   3.449919826833085*^9, 3.449919856350192*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"exportname", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{
       "ensemblename", "~~", "\"\<-\>\"", "~~", "date", "~~", "\"\<-\>\"", "~~", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"filenames", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", 
             RowBox[{"filenamenos", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", "\"\<.xls\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"exportname", ",", 
       RowBox[{"valueoutput", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", "nmodules"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"o", ",", 
      RowBox[{"nfilenames", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.397305175828125*^9, 3.397305232109375*^9}, {
   3.39970790915625*^9, 3.39970791628125*^9}, {3.399882261765625*^9, 
   3.399882261875*^9}, 3.4000664990625*^9, 3.400066567125*^9, 
   3.400077438015625*^9, {3.40007750621875*^9, 3.400077519328125*^9}, {
   3.400077556703125*^9, 3.400077575*^9}, 3.401708415609375*^9, {
   3.402396968234375*^9, 3.402396979015625*^9}, {3.40595402596875*^9, 
   3.405954032109375*^9}, 3.405954227828125*^9, 3.4059543951875*^9, {
   3.4059544370625*^9, 3.40595447725*^9}, {3.405954628609375*^9, 
   3.405954628703125*^9}, {3.4059548375625*^9, 3.40595484590625*^9}, {
   3.405954932*^9, 3.405954935578125*^9}, {3.405955203359375*^9, 
   3.405955206625*^9}, {3.414487569562969*^9, 3.414487575861656*^9}, {
   3.418045676545762*^9, 3.418045676693176*^9}, 3.429458878106448*^9, {
   3.429458948908481*^9, 3.429458953735986*^9}, {3.447420323772731*^9, 
   3.447420324354779*^9}, {3.448274389967014*^9, 3.448274394250403*^9}, {
   3.44827486108697*^9, 3.448274862459041*^9}, {3.449337167273574*^9, 
   3.449337178952849*^9}, {3.449337229949539*^9, 3.449337230154534*^9}, {
   3.449337271662654*^9, 3.449337273577942*^9}, {3.449337449082576*^9, 
   3.449337460992585*^9}, {3.449911346854529*^9, 3.449911357153678*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["4. Plot Results", "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066413671875*^9}, 
   3.4000664990625*^9, 3.400066567125*^9, {3.413627432215925*^9, 
   3.413627447655179*^9}, 3.438600143049686*^9, {3.454246581173926*^9, 
   3.454246581442442*^9}}],

Cell[CellGroupData[{

Cell["4 a. Read in data", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.42028242375*^9, 3.420282431671875*^9}, 3.4202824705625*^9, 
   3.438600144092343*^9}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"resultsfolder", "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", "\"\<\\\\\>\"", 
     ",", "\"\</\>\""}], "]"}], "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], ",",
      "newdirectory", ",", ",", "collatedoutputfolder"}], "]"}], "~~", 
   "\"\</spreadsheets\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.39980179275*^9, 3.399801829625*^9}, {3.3998019566875*^9,
    3.399801983640625*^9}, {3.39980203053125*^9, 3.39980205940625*^9}, {
   3.399882263125*^9, 3.399882263359375*^9}, 3.4000664990625*^9, 
   3.400066567125*^9, {3.40007760271875*^9, 3.400077604828125*^9}, {
   3.400078553625*^9, 3.40007857340625*^9}, {3.400082026046875*^9, 
   3.40008209096875*^9}, {3.40024609440625*^9, 3.40024609784375*^9}, {
   3.400256072*^9, 3.40025607684375*^9}, {3.400326687828125*^9, 
   3.40032669040625*^9}, {3.400326768984375*^9, 3.40032677775*^9}, {
   3.4060315940625*^9, 3.406031639046875*^9}, {3.406034827984375*^9, 
   3.406034865734375*^9}, {3.4060390665*^9, 3.406039068484375*^9}, {
   3.4064601176875*^9, 3.406460119640625*^9}, {3.412507043597781*^9, 
   3.412507044339521*^9}, 3.4185677058125*^9, 3.420975958558697*^9, 
   3.420976191325378*^9, 3.43868509337937*^9, {3.438685125601233*^9, 
   3.438685140867417*^9}, 3.438691607270291*^9, 3.438697338574204*^9, 
   3.447088419146059*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], ",", 
    RowBox[{"yaxislabels", "=", "columntitles2"}], ",", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"yaxislabels", "=", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNames", "[", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yaxislabels", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"yaxislabels", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yaxislabels", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"yaxislabels", ",", "\"\<\>\"", ",", "2"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4060391641875*^9, 3.406039216859375*^9}, {
   3.40604000715625*^9, 3.40604003903125*^9}, {3.406040317125*^9, 
   3.40604032521875*^9}, 3.40604041571875*^9, {3.406040460109375*^9, 
   3.40604049859375*^9}, {3.40604062709375*^9, 3.406040631*^9}, 
   3.438533682032006*^9, {3.438686283954595*^9, 3.438686284059481*^9}, {
   3.44939031918336*^9, 3.449390420667019*^9}, {3.449390690522747*^9, 
   3.449390690698145*^9}, {3.449390720895147*^9, 3.449390721035194*^9}}],

Cell[BoxData["yaxislabels"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "valueoutput", "]"}], "\[Equal]", "List"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"data3", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"valueoutput", ",", "1"}], "]"}]}], ",", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{",", 
        RowBox[{"{", 
         RowBox[{"Total", "[", "nfilenames", "]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"data3", "[", 
          RowBox[{"[", "o", "]"}], "]"}], "=", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNames", "[", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"o", "+", "1"}], "]"}], "]"}], "]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", 
         RowBox[{"Total", "[", "nfilenames", "]"}]}], "}"}]}], "]"}], ";"}]}],
    "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.400082256515625*^9, 3.400082293546875*^9}, {
   3.400082413265625*^9, 3.4000824133125*^9}, 3.400246075828125*^9, 
   3.40025608909375*^9, {3.400326681703125*^9, 3.400326684015625*^9}, {
   3.404486109421875*^9, 3.40448611596875*^9}, {3.404486256484375*^9, 
   3.404486257359375*^9}, {3.404486349203125*^9, 3.40448634925*^9}, 
   3.404651676203125*^9, {3.4046517446875*^9, 3.4046517488125*^9}, 
   3.404742596328125*^9, 3.404743705453125*^9, {3.405065760072625*^9, 
   3.405065763010125*^9}, {3.4053462220625*^9, 3.405346225359375*^9}, {
   3.405346874078125*^9, 3.40534687475*^9}, {3.40603184246875*^9, 
   3.40603190609375*^9}, {3.4060335106875*^9, 3.4060335110625*^9}, {
   3.406033561046875*^9, 3.406033579578125*^9}, {3.4060338016875*^9, 
   3.40603388709375*^9}, {3.4060348891875*^9, 3.40603489059375*^9}, {
   3.406039107375*^9, 3.406039109828125*^9}, {3.4060407596875*^9, 
   3.40604078959375*^9}, 3.438533680866326*^9, {3.438684666459361*^9, 
   3.438684666565204*^9}, {3.43868571543898*^9, 3.438685715578111*^9}, {
   3.438686075688273*^9, 3.43868607614797*^9}, {3.449340025450368*^9, 
   3.449340034017435*^9}, {3.449340151360769*^9, 3.449340157709928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"data3", "[", 
      RowBox[{"[", 
       RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "=", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"data3", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], ",", "1"}], "]"}]}],
     ",", 
    RowBox[{"{", 
     RowBox[{"o", ",", 
      RowBox[{"Total", "[", "nfilenames", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"data3", "[", 
        RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"data3", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.404553475859375*^9, 3.404553509890625*^9}, {
   3.406033909703125*^9, 3.4060339369375*^9}, {3.4060359688125*^9, 
   3.4060359863125*^9}, {3.420286426640625*^9, 3.4202864275625*^9}, 
   3.449340064444722*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data4", "=", "data3"}], ";"}]], "Input",
 CellChangeTimes->{{3.420286429546875*^9, 3.4202864333125*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["4 b. Calculate stuff for plots", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.4202861539375*^9}, 3.438600148873443*^9, 
   3.449390204662346*^9}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.437736666901913*^9, 3.437736668148636*^9}, 
   3.437736755452814*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"startvalues", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"data4", "[", 
      RowBox[{"[", 
       RowBox[{"o", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"o", ",", 
       RowBox[{"Total", "[", "nfilenames", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"data4", "[", 
         RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.40603636040625*^9, 3.40603643665625*^9}, 
   3.40603852490625*^9, {3.413630982636126*^9, 3.413630997285053*^9}, {
   3.413631033123114*^9, 3.413631036032098*^9}, {3.420284518953125*^9, 
   3.420284520921875*^9}, {3.437931382904541*^9, 3.437931386052095*^9}, {
   3.437931430979428*^9, 3.437931474081523*^9}, 3.449340069571957*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxima", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"data4", "[", 
             RowBox[{"[", 
              RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}], 
            "]"}], "==", "Real"}], ",", 
          RowBox[{"data4", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"10.", "^", "99"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"10.", "^", "99"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"data4", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"data4", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "]"}]}], 
         "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"o", ",", 
       RowBox[{"Total", "[", "nfilenames", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"data4", "[", 
         RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.40603636040625*^9, 3.40603643665625*^9}, 
   3.40603852490625*^9, {3.413630982636126*^9, 3.413630997285053*^9}, {
   3.413631033123114*^9, 3.413631036032098*^9}, {3.420284518953125*^9, 
   3.420284520921875*^9}, 3.449340070488808*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"minima", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"data4", "[", 
             RowBox[{"[", 
              RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}], 
            "]"}], "==", "Real"}], ",", 
          RowBox[{"data4", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"10.", "^", "99"}], ",", 
          RowBox[{"10.", "^", "99"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"data4", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"data4", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "]"}]}], 
         "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"o", ",", 
       RowBox[{"Total", "[", "nfilenames", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"data4", "[", 
         RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.406036792609375*^9, 3.40603679315625*^9}, 
   3.40603852559375*^9, {3.413630459729421*^9, 3.41363058042411*^9}, {
   3.413630665066338*^9, 3.413630667654705*^9}, {3.4202845214375*^9, 
   3.4202845230625*^9}, 3.449340071168204*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"infotable", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"shortfilenames", ",", "1"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"yaxislabels", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"2", "+", "j"}]}], "]"}], "]"}], ",", 
            RowBox[{"startvalues", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"minima", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"maxima", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"minima", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
       "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Total", "[", "nfilenames", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{"infotable", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<name\>\"", ",", "\"\<start\>\"", 
      ",", "\"\<min\>\"", ",", "\"\<max\>\"", ",", "\"\<name\>\"", ",", 
      "\"\<start\>\"", ",", "\"\<min\>\"", ",", "\"\<max\>\"", ",", 
      "\"\<name\>\"", ",", "\"\<start\>\"", ",", "\"\<min\>\"", ",", 
      "\"\<max\>\"", ",", "\"\<name\>\"", ",", "\"\<start\>\"", ",", 
      "\"\<min\>\"", ",", "\"\<max\>\""}], "}"}]}], "]"}], ";", 
  RowBox[{"PrependTo", "[", 
   RowBox[{"infotable", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<variable no.\>\"", ",", "\"\<variable name\>\"", ",", 
      "\"\<units 1\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", 
      ",", "\"\<units 2\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
      "\"\<\>\"", ",", "\"\<units 3\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", 
      ",", "\"\<\>\"", ",", "\"\<units 4\>\""}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.414410004322269*^9, 3.414410274772533*^9}, {
   3.438522597026306*^9, 3.438522602347891*^9}, {3.438522691167782*^9, 
   3.43852271629736*^9}, {3.4386153417435*^9, 3.438615355506441*^9}, {
   3.438615426309544*^9, 3.438615477608904*^9}, 3.449340072378151*^9, {
   3.449340267288207*^9, 3.449340273567676*^9}, {3.449340323470059*^9, 
   3.449340328171671*^9}, {3.449390804169097*^9, 3.449390806898786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"Rotate", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"vartitles", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "24"}], "]"}], ",", 
        RowBox[{"Pi", "/", "2"}]}], "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.438524434044539*^9, 3.438524465837272*^9}, {
   3.43852486116086*^9, 3.438524892409525*^9}, 3.438525385588963*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "alpha", "=", 
   "\"\<abcdefghigklmnopqrstuvABCDEFGHIJKLMNOPQRSTUVwWxXyYzZ+-\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tab1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"i", "+", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tab2", "=", 
   RowBox[{"tab1", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabcode", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tab2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ">", "9"}], ",", 
       RowBox[{"StringTake", "[", 
        RowBox[{"alpha", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tab2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", "9"}], "}"}]}], "]"}], ",", 
       RowBox[{"ToString", "[", 
        RowBox[{"tab2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "tab2", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ensemkey", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"tabcode", ",", "\"\<code\>\""}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"tab2", ",", "\"\<tab\>\""}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"ensemblenames", ",", "\"\<ensemble no.\>\""}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"ensemtitles", ",", "vartitles"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"nruns", "+", "1"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.438604690035904*^9, 3.438604733386248*^9}, {
   3.438604777725465*^9, 3.438604844946107*^9}, 3.438609639399927*^9, 
   3.438617478957814*^9, {3.438618638188683*^9, 3.438618639833333*^9}, {
   3.438618679566794*^9, 3.438618680234129*^9}, 3.438675121449068*^9, 
   3.438675756288437*^9, {3.438675807888369*^9, 3.438675810985942*^9}, {
   3.438675906772621*^9, 3.438675923273077*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"resultsfolder", "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", "\"\<\\\\\>\"", 
     ",", "\"\</\>\""}], "]"}], "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], ",",
      "newdirectory", ",", ",", "collatedoutputfolder"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.438686147828602*^9, 3.447088421931659*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"ensemblename", "~~", "\"\<_key.csv\>\""}], ",", "ensemkey"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.438609948522819*^9, 3.438610001059826*^9}, {
   3.438610112153635*^9, 3.438610120933462*^9}, 3.438610657851572*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<variables_key.csv\>\"", ",", "infotable"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.438615558338198*^9, 3.438615572497434*^9}}],

Cell[BoxData[
 RowBox[{"CreateDirectory", "[", "\"\<graphs\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.438685811117919*^9, 3.438685828953817*^9}, {
  3.438686153448858*^9, 3.43868615522011*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"latexscale", "=", "\"\<0.5\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"latexfile", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateDirectory", "[", "\"\<graphs/latex\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.438680887580527*^9, 3.438680896110188*^9}, {
   3.438681350358302*^9, 3.438681366046799*^9}, {3.438684779608757*^9, 
   3.438684782884986*^9}, 3.438684937992948*^9, {3.438684998076542*^9, 
   3.438684998717404*^9}, {3.438685430023393*^9, 3.438685430363502*^9}, {
   3.438685933698274*^9, 3.438685937902888*^9}, {3.438686159242111*^9, 
   3.438686160371177*^9}, {3.438688716368187*^9, 3.438688717917066*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["4 c. Legend", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.4202861539375*^9}, 3.438600148873443*^9, 
   3.449390204662346*^9, {3.449404813119494*^9, 3.449404824221339*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nstyles", "=", 
   RowBox[{"Length", "[", "varstyles", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449402432615134*^9, 3.449402446563244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combvars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Tuples", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"varvalues", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"varstyles", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Last", "[", 
           RowBox[{"varstyles", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449397079932847*^9, 3.449397147433615*^9}, {
   3.449397849866284*^9, 3.449397854534144*^9}, {3.449400391807015*^9, 
   3.449400541023386*^9}, {3.449400944654583*^9, 3.449400966106236*^9}, 
   3.449402457140818*^9, 3.449403479276941*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"style1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "\"\<ColorFunction\>\""}], "]"}], "[", "i", "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"nvars", "[", 
          RowBox[{"[", 
           RowBox[{"varstyles", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"varstyles", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449396253522225*^9, 3.449396338446557*^9}, 
   3.449398580313285*^9, {3.449400220205092*^9, 3.449400230445555*^9}, {
   3.449400307406281*^9, 3.44940030868736*^9}, 3.449403459315532*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"style2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Directive", "[", 
      RowBox[{"Thickness", "[", 
       RowBox[{
        RowBox[{"linethicknesses", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", "k"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"nvars", "[", 
          RowBox[{"[", 
           RowBox[{"varstyles", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"varstyles", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449396790156807*^9, 3.449396812668656*^9}, {
   3.449396931332889*^9, 3.449396931483772*^9}, 3.449398581673161*^9, {
   3.449400221928419*^9, 3.449400232525788*^9}, {3.449403059861912*^9, 
   3.449403061537949*^9}, {3.449403303653167*^9, 3.449403336192776*^9}, 
   3.449403462755752*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prod3", "=", 
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"nvars", "[", 
      RowBox[{"[", 
       RowBox[{"varstyles", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"varstyles", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"style3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Directive", "[", 
      RowBox[{"Dashing", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "\[Equal]", "1"}], ",", "10000", ",", 
           RowBox[{
            RowBox[{"dashingwidths", "[", 
             RowBox[{"[", "l", "]"}], "]"}], "*", 
            RowBox[{"1", "/", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}]}]}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "\[Equal]", "1"}], ",", "10000", ",", 
           RowBox[{
            RowBox[{"dashingwidths", "[", 
             RowBox[{"[", "l", "]"}], "]"}], "*", 
            RowBox[{"1", "/", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}]}]}]}], "]"}]}], "}"}], "]"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "prod3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.449396641677572*^9, 3.449396726043309*^9}, {
   3.449396939258357*^9, 3.449396941191736*^9}, {3.449398584003344*^9, 
   3.449398607132716*^9}, {3.449400264411804*^9, 3.449400266228402*^9}, {
   3.449400311429976*^9, 3.449400336003822*^9}, {3.449403071323663*^9, 
   3.449403079270681*^9}, {3.449403353241417*^9, 3.44940335766936*^9}, 
   3.449403468004909*^9, {3.449913972337051*^9, 3.449913986985084*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"legstyles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"style1", ",", 
        RowBox[{"style2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"style3", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449400790959635*^9, 3.449400805990278*^9}, {
   3.449401869573421*^9, 3.449401884755032*^9}, 3.449402461267876*^9, {
   3.449403368522838*^9, 3.449403376095954*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphstyles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"style1", ",", 
        RowBox[{"style2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"style3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449400790959635*^9, 3.449400805990278*^9}, {
   3.449401869573421*^9, 3.449401884755032*^9}, 3.449402461267876*^9, {
   3.449403368522838*^9, 3.449403392971822*^9}, {3.449404379704645*^9, 
   3.449404381032222*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphics2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Directive", "@@", 
      RowBox[{
       RowBox[{"Tuples", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"graphstyles", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"graphstyles", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
       "[", 
       RowBox[{"[", "k", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.449402344830839*^9, 3.449402419377705*^9}, {
  3.449402459199834*^9, 3.449402571969466*^9}, {3.449402669665123*^9, 
  3.449402671364009*^9}, {3.449402731201791*^9, 3.44940273624129*^9}, {
  3.449403108084909*^9, 3.449403111680521*^9}, {3.449403404402832*^9, 
  3.449403411811183*^9}, {3.449403857546124*^9, 3.44940385954889*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gap", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
     RowBox[{"StyleForm", "[", 
      RowBox[{"\"\<\>\"", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "6"}], ",", 
       RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.449399464976869*^9, 3.449399478085022*^9}, {
   3.449399549178922*^9, 3.449399571619639*^9}, 3.449399618517122*^9, 
   3.449399657156193*^9, {3.449399691637409*^9, 3.449399730563807*^9}, {
   3.449401636076439*^9, 3.449401639830877*^9}, {3.449420200261733*^9, 
   3.449420222049136*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"newlegend", "=", "\n", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Append", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Prepend", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Graphics", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"legstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}],
                    "}"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                RowBox[{"StyleForm", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], "<>", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\< \>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", "+", 
                    RowBox[{"StringLength", "[", 
                    RowBox[{"vartitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], "-", 
                    RowBox[{"StringLength", "[", 
                    RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "<>", 
                    RowBox[{"Last", "[", 
                    RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
                    "\"\<\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], ",", 
                  RowBox[{"FontSize", "\[Rule]", "9"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"nvars", "[", 
                   RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}],
                  "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
              RowBox[{"StyleForm", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vartitlesshort", "[", 
                  RowBox[{"[", 
                   RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<>", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "1"}], ",", 
                   RowBox[{"\"\<   \>\"", "<>", 
                    RowBox[{"vartitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                   ",", "\"\<\>\""}], "]"}]}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], ",", 
                RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], "}"}]}],
            "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "gap"}],
          "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"newlegend", "//", "TableForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.449396736239704*^9, 3.449396758462765*^9}, {
   3.449397028804672*^9, 3.449397048528315*^9}, {3.449397186501199*^9, 
   3.449397238786709*^9}, {3.449397860867124*^9, 3.449397920061666*^9}, {
   3.44939834473926*^9, 3.44939835098595*^9}, {3.449399188291791*^9, 
   3.449399258016806*^9}, {3.449399306004867*^9, 3.449399342400782*^9}, {
   3.449399758756582*^9, 3.449399778959378*^9}, {3.449399815330379*^9, 
   3.44939981863954*^9}, 3.449400625551532*^9, {3.449400663638834*^9, 
   3.449400763673587*^9}, {3.449400822460497*^9, 3.449400831275098*^9}, {
   3.449401018027498*^9, 3.449401201969195*^9}, 3.449401253187566*^9, {
   3.449401484763741*^9, 3.449401601359133*^9}, {3.449401643026112*^9, 
   3.449401666145885*^9}, {3.449401800469654*^9, 3.449401805972842*^9}, 
   3.449402463419318*^9, {3.449403429400402*^9, 3.449403429635812*^9}, {
   3.449405295268072*^9, 3.449405295418877*^9}, {3.449422768472385*^9, 
   3.449422770247471*^9}, 3.44948744282713*^9, {3.449913996273783*^9, 
   3.449914006247034*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nvar"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nos1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"nos", "[", 
      RowBox[{"[", 
       RowBox[{"varstyles", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nos2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Tuples", "[", 
      RowBox[{"nos1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlegsecs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"nvars", "[", 
       RowBox[{"[", 
        RowBox[{"varstyles", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legtitlenos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", ">", "1"}], ",", 
        RowBox[{
         RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legspacenos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"legtitlenos", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "nstyles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legdisplaynos", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"legtitlenos", ",", "legspacenos"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.449419861367939*^9, 3.449419863850146*^9}, {
   3.449420070189886*^9, 3.449420108782873*^9}, {3.449420237679497*^9, 
   3.449420237774796*^9}, {3.449420276622715*^9, 3.449420279178228*^9}, 
   3.449422744947204*^9, {3.449422884009843*^9, 3.449422895003143*^9}, 
   3.449486320652346*^9, 3.449486355258896*^9, 3.449486738012975*^9, {
   3.449495567098377*^9, 3.449495567754232*^9}, 3.449495948465181*^9, {
   3.449495984541659*^9, 3.44949598513238*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["4 d. Plot", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, 3.437928334078296*^9, 3.438600152808993*^9, 
   3.449390207397173*^9, 3.449404815374842*^9}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], ",",
      "newdirectory", ",", ",", "collatedoutputfolder"}], "]"}], "~~", 
   "\"\</graphs\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.438533854768155*^9, 3.438533855192011*^9}, {
   3.438681837012005*^9, 3.438681850880044*^9}, {3.438681944025736*^9, 
   3.438681959237815*^9}, 3.438684939301126*^9, 3.438685094735914*^9, 
   3.44708842308526*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newfilenmenos", "=", "filenamenos"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"newfilenmenos", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "+=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"filenames", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "nmodules"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newfilenmenos", "=", 
   RowBox[{"Flatten", "[", "newfilenmenos", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.449391360766912*^9, 3.449391512681769*^9}, 
   3.449391583477477*^9, 3.449902927997006*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"min", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
       RowBox[{
        RowBox[{"minima", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
        RowBox[{"startvalues", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ",", 
       RowBox[{"minima", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "q"}], "]"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"max", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
       RowBox[{
        RowBox[{"maxima", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
        RowBox[{"startvalues", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ",", 
       RowBox[{"maxima", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "q"}], "]"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ymindefault", "=", 
     RowBox[{"min", "-", 
      RowBox[{"0.1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"maxima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
         RowBox[{"minima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ymaxdefault", "=", 
     RowBox[{"max", "+", 
      RowBox[{"0.1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"maxima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
         RowBox[{"minima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"xmindefault", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zerox", "\[Equal]", "False"}], ",", "plotstartyear", ",", 
       "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"plotlabel", "=", 
     RowBox[{"StyleForm", "[", 
      RowBox[{
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<Variation of `` with time for ``\\n ``\\n ``; ``yr run\>\"", ",", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"shortfilenames", ",", "1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "2"}], "]"}], "]"}], ",", "config", ",", "info", 
         ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
           "\"\<relative to preindustrial\>\"", ",", "\"\<\>\""}], "]"}], ",",
          "xmax"}], "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
       RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"nosinuse", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ensemblenos", "[", 
           RowBox[{"[", "tab", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"varstyles", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "tab", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"nosinuse2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"nos2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nosinuse", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"nosinuse", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"nosinuse3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nosinuse2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", "1"}], ",", 
          RowBox[{
           RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nosinuse4", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "nosinuse3", "]"}], ",", "legdisplaynos"}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newlegendplus", "=", 
     RowBox[{"newlegend", "[", 
      RowBox[{"[", "nosinuse4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"graph", "=", 
     RowBox[{"ShowLegend", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListLogLinearPlot", "[", "##", "]"}], ",", 
            RowBox[{"ListPlot", "[", "##", "]"}]}], "}"}], "[", 
          RowBox[{"[", "l", "]"}], "]"}], "&"}], "@", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", "1", ",", "i"}], "]"}], "]"}],
                    "-", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zerox", "\[Equal]", "True"}], ",", 
                    "plotstartyear", ",", "0"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], "-", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}], ",", "0"}], "]"}], "-", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"correctdrift", "\[Equal]", "True"}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}]}], "]"}], "]"}], "]"}], ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}], ",", "i"}], "]"}], "]"}], "-", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", "1"}], "]"}], "]"}], "]"}]}], 
                   "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", ",", 
               "plotlabel"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<year\>\"", ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                  "\"\<change in\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
                RowBox[{"yaxislabels", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", 
                   RowBox[{"2", "+", "q"}]}], "]"}], "]"}]}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", "900", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{"yauto", ",", "Automatic", ",", 
                 RowBox[{"{", 
                  RowBox[{"ymin", ",", "ymax"}], "}"}]}], "]"}]}], "}"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"GridLines", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"graphics2", "[", 
                RowBox[{"[", 
                 RowBox[{"tab", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}]}]}], 
           "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"newlegendplus", ",", "\[IndentingNewLine]", 
         RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LegendPosition", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.9", ",", 
            RowBox[{"-", "0.5"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LegendSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.4", ",", "1"}], "}"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tab2", "=", "tab"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tabcode", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tab2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ">", "9"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"alpha", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tab2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "9"}], "}"}]}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"tab2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "tab2", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"datestring", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{"PaddedForm", "[", 
       RowBox[{
        RowBox[{"Date", "[", "]"}], ",", "5", ",", 
        RowBox[{"NumberPadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<0\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"commas", "=", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"datestring", ",", "\"\<,\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"date", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"datestring", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"commas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "2"}], ",", 
            RowBox[{
             RowBox[{"commas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "commas", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"date2", "=", 
     RowBox[{"date", "~~", 
      RowBox[{"StringTake", "[", 
       RowBox[{"datestring", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "7"}], ",", 
          RowBox[{"-", "6"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"graphtitle", "=", 
     RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
      RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", "\"\<_\>\"", "~~", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", "filenames", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"newfilenmenos", "[", 
           RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"15", ",", 
          RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", "\"\<_\>\"", "~~", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"correctdrift", "\[Equal]", "True"}], ",", 
        "\"\<driftcorr\>\"", ",", "\"\<\>\""}], "]"}], "~~", "\"\<_\>\"", "~~", 
      RowBox[{"ToString", "[", "xmax", "]"}], "~~", "\"\<yr\>\"", "~~", 
      "\"\<_\>\"", "~~", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"l", "\[Equal]", "1"}], ",", "\"\<log\>\"", ",", 
        "\"\<linear\>\""}], "]"}], "~~", "\"\<_\>\"", "~~", "date"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"latex", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\includegraphics[\
scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{figure}\\n\\n\\\
n\>\"", ",", "latexscale", ",", "graphtitle", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], ",", 
         "graphtitle"}], "]"}], ",", "StandardForm"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"\"\<latex/\>\"", "~~", "graphtitle", "~~", "\"\<.txt\>\""}], 
        ",", "latex"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"graphtitle", "~~", "\"\<.\>\"", "~~", 
           RowBox[{"saveformats", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "graph"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"graph", ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", "800", "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"o", ",", "1", ",", "\"\<variable\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Total", "[", "nfilenames", "]"}]}], "}"}]}], "]"}]}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "1", ",", "\"\<units\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"data4", "[", 
           RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"tab", ",", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"xmin", ",", "xmindefault"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"xmax", ",", "nyears"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"ymin", ",", "ymindefault"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"ymax", ",", "ymaxdefault"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"yauto", ",", "True", ",", "\"\<auto y-axis scale\>\""}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "\"\<plot type\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zerox", ",", "False", ",", "\"\<relative x-axis scale\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zeroy", ",", "False", ",", "\"\<relative y-axis scale\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "correctdrift", ",", "False", ",", "\"\<correct for drift\>\""}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"title", ",", "False", ",", "\"\<title\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"saveformats", ",", 
     RowBox[{"{", 
      RowBox[{"{", "\"\<pdf\>\"", "}"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"savegraph", ",", "False", ",", "\"\<save graph\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.399802215546875*^9, 3.399802383140625*^9}, {
   3.39980242046875*^9, 3.399802496328125*^9}, {3.399802546453125*^9, 
   3.399802570390625*^9}, {3.399802622046875*^9, 3.399802665625*^9}, {
   3.399802799484375*^9, 3.3998028529375*^9}, {3.399802930859375*^9, 
   3.39980307659375*^9}, {3.39980311275*^9, 3.399803145015625*^9}, {
   3.399803228078125*^9, 3.399803254625*^9}, {3.399803504703125*^9, 
   3.3998035993125*^9}, {3.399803845796875*^9, 3.39980388490625*^9}, {
   3.399803940890625*^9, 3.399803965921875*^9}, {3.399804274375*^9, 
   3.399804298125*^9}, {3.399804331984375*^9, 3.399804332234375*^9}, {
   3.399804367640625*^9, 3.399804375875*^9}, {3.39980465*^9, 
   3.399804699390625*^9}, {3.399804811984375*^9, 3.399804921453125*^9}, {
   3.399805093765625*^9, 3.39980515209375*^9}, {3.399805188421875*^9, 
   3.399805229609375*^9}, {3.399805281671875*^9, 3.3998052821875*^9}, {
   3.399805317390625*^9, 3.39980531784375*^9}, {3.399805361484375*^9, 
   3.399805406625*^9}, {3.399805464109375*^9, 3.39980549253125*^9}, {
   3.39980554003125*^9, 3.399805559671875*^9}, {3.39980573365625*^9, 
   3.3998058186875*^9}, {3.399805872171875*^9, 3.399805900765625*^9}, {
   3.3998059914375*^9, 3.399806032234375*^9}, {3.399806079171875*^9, 
   3.399806088203125*^9}, {3.399806137546875*^9, 3.399806165015625*^9}, 
   3.39980631121875*^9, {3.399806428796875*^9, 3.399806465421875*^9}, {
   3.399806513296875*^9, 3.399806530203125*^9}, {3.39980658909375*^9, 
   3.3998065908125*^9}, 3.3998066975*^9, {3.3998067385625*^9, 
   3.399806741984375*^9}, {3.3998068225625*^9, 3.399806822859375*^9}, {
   3.399806857140625*^9, 3.39980688875*^9}, {3.39980706328125*^9, 
   3.399807112625*^9}, {3.399807257734375*^9, 3.399807315796875*^9}, {
   3.3998078945625*^9, 3.39980789490625*^9}, {3.399807937*^9, 
   3.3998079471875*^9}, {3.39980801978125*^9, 3.399808040296875*^9}, {
   3.399808643046875*^9, 3.399808646140625*^9}, {3.399808687984375*^9, 
   3.39980885309375*^9}, {3.399808903359375*^9, 3.39980892865625*^9}, {
   3.3998089685*^9, 3.399809003234375*^9}, {3.399809437359375*^9, 
   3.3998094624375*^9}, {3.399812059890625*^9, 3.39981207515625*^9}, {
   3.399812131734375*^9, 3.399812138*^9}, 3.3998121695625*^9, {
   3.39981353325*^9, 3.399813571953125*^9}, {3.399813617515625*^9, 
   3.399813626234375*^9}, {3.399813699234375*^9, 3.399813699515625*^9}, {
   3.399813804234375*^9, 3.3998138060625*^9}, {3.39981383925*^9, 
   3.39981387409375*^9}, {3.399813927859375*^9, 3.39981393828125*^9}, 
   3.3998140469375*^9, {3.39981412225*^9, 3.399814122421875*^9}, {
   3.39981418846875*^9, 3.399814290703125*^9}, {3.399814334671875*^9, 
   3.3998143513125*^9}, {3.399814490453125*^9, 3.39981451796875*^9}, {
   3.39981469209375*^9, 3.399814739890625*^9}, {3.399814807578125*^9, 
   3.399814850109375*^9}, {3.399814894140625*^9, 3.3998149041875*^9}, 
   3.399814940359375*^9, {3.39981499978125*^9, 3.399815007609375*^9}, {
   3.39981503803125*^9, 3.399815067671875*^9}, {3.3998152955625*^9, 
   3.399815300875*^9}, {3.3998153395625*^9, 3.39981536596875*^9}, {
   3.3998154519375*^9, 3.399815456421875*^9}, {3.3998167785625*^9, 
   3.399817003328125*^9}, {3.39981748321875*^9, 3.399817488359375*^9}, {
   3.39981752996875*^9, 3.399817544953125*^9}, {3.3998176238125*^9, 
   3.399817689171875*^9}, {3.3998182713125*^9, 3.399818281953125*^9}, {
   3.400065533703125*^9, 3.4000655338125*^9}, 3.400066499078125*^9, 
   3.400066567125*^9, {3.40022856978125*^9, 3.40022860265625*^9}, {
   3.400246474265625*^9, 3.400246477828125*^9}, {3.400313103421875*^9, 
   3.40031310365625*^9}, {3.40031340453125*^9, 3.400313405875*^9}, 
   3.400913551328125*^9, {3.40092106834375*^9, 3.400921072484375*^9}, {
   3.4009211148125*^9, 3.40092113275*^9}, 3.4009400641875*^9, {
   3.402396705421875*^9, 3.40239671475*^9}, {3.404486792578125*^9, 
   3.404486795671875*^9}, 3.404553764515625*^9, 3.404652035265625*^9, {
   3.404742854203125*^9, 3.40474286246875*^9}, {3.4047433488125*^9, 
   3.404743371765625*^9}, {3.4047434075625*^9, 3.404743424234375*^9}, {
   3.40474385228125*^9, 3.40474386396875*^9}, 3.40506599040075*^9, {
   3.40506705815075*^9, 3.405067058291375*^9}, {3.40507001652575*^9, 
   3.405070020853875*^9}, 3.405174842322625*^9, {3.405175980135125*^9, 
   3.4051759802445*^9}, {3.40517605115075*^9, 3.405176053510125*^9}, {
   3.405347353640625*^9, 3.405347362*^9}, 3.4060317349375*^9, {
   3.406034676640625*^9, 3.406034682140625*^9}, {3.4060350235*^9, 
   3.40603506378125*^9}, {3.40603518359375*^9, 3.40603518625*^9}, {
   3.40603521959375*^9, 3.406035311734375*^9}, {3.406035484328125*^9, 
   3.40603548440625*^9}, {3.4060355195*^9, 3.40603552171875*^9}, 
   3.40603558621875*^9, {3.40603562325*^9, 3.406035630171875*^9}, {
   3.4060357995625*^9, 3.4060358579375*^9}, {3.40603600509375*^9, 
   3.406036012296875*^9}, {3.406036104015625*^9, 3.4060361326875*^9}, {
   3.406036809453125*^9, 3.406036833328125*^9}, {3.40603688309375*^9, 
   3.4060369260625*^9}, {3.40603716503125*^9, 3.40603718265625*^9}, {
   3.406037214546875*^9, 3.40603724534375*^9}, {3.4060373131875*^9, 
   3.406037347421875*^9}, {3.406037412609375*^9, 3.406037428515625*^9}, {
   3.4060374625*^9, 3.4060374796875*^9}, {3.40603759159375*^9, 
   3.406037659109375*^9}, {3.406037805203125*^9, 3.406037818140625*^9}, {
   3.40603801615625*^9, 3.406038017734375*^9}, {3.4060381910625*^9, 
   3.406038200734375*^9}, {3.406038327453125*^9, 3.406038343828125*^9}, {
   3.40603846653125*^9, 3.406038472515625*^9}, 3.406038557796875*^9, {
   3.406040687015625*^9, 3.406040710546875*^9}, {3.406280406140625*^9, 
   3.406280456265625*^9}, {3.406280498515625*^9, 3.406280517734375*^9}, {
   3.406280653484375*^9, 3.406280714359375*^9}, {3.4062816714375*^9, 
   3.406281672640625*^9}, 3.414401783513013*^9, {3.414409279644401*^9, 
   3.414409289582151*^9}, {3.414409364039494*^9, 3.414409366500576*^9}, 
   3.414417835626969*^9, {3.41441789078294*^9, 3.414417898807214*^9}, {
   3.420278519546875*^9, 3.420278524796875*^9}, 3.4202796783125*^9, {
   3.420284523921875*^9, 3.42028452559375*^9}, 3.42097614696664*^9, {
   3.42097620216521*^9, 3.420976203133744*^9}, 3.429460546879025*^9, {
   3.429461528905685*^9, 3.429461553793434*^9}, {3.429461660196429*^9, 
   3.429461661953682*^9}, {3.429461713979744*^9, 3.42946171671183*^9}, {
   3.429461808957419*^9, 3.429461884727344*^9}, {3.429461953478956*^9, 
   3.429461954878852*^9}, {3.429524253071853*^9, 3.429524253783337*^9}, {
   3.429524288999288*^9, 3.429524289304518*^9}, {3.429524324480033*^9, 
   3.429524390200929*^9}, 3.429526198612434*^9, {3.433168499347519*^9, 
   3.433168537187229*^9}, {3.433247372969148*^9, 3.433247450698908*^9}, 
   3.433247495964081*^9, {3.433247531940586*^9, 3.433247554574039*^9}, {
   3.433249210940027*^9, 3.433249212914151*^9}, 3.433249247325855*^9, {
   3.433250366623332*^9, 3.433250384867938*^9}, {3.433582823016408*^9, 
   3.433582825920501*^9}, {3.433768238931191*^9, 3.433768239470476*^9}, {
   3.433770014738699*^9, 3.43377002842755*^9}, 3.437727390573244*^9, 
   3.437728278865637*^9, {3.437728319884947*^9, 3.437728320396343*^9}, {
   3.437744063425779*^9, 3.437744306520345*^9}, {3.437744355617779*^9, 
   3.437744502975968*^9}, {3.437744533130372*^9, 3.437744560823158*^9}, {
   3.437744611244762*^9, 3.437744638757771*^9}, 3.437744680958937*^9, {
   3.437745313795701*^9, 3.437745316390152*^9}, {3.437745375653767*^9, 
   3.437745405626921*^9}, {3.437746617952706*^9, 3.437746622308804*^9}, {
   3.437746678033799*^9, 3.437746705533958*^9}, {3.437746848209913*^9, 
   3.437746849728387*^9}, {3.437746885426444*^9, 3.437746885840515*^9}, 
   3.437746925758948*^9, {3.437747071509877*^9, 3.437747110992275*^9}, {
   3.437837296098457*^9, 3.437837314474528*^9}, {3.437837353953153*^9, 
   3.437837372083555*^9}, {3.437837657602802*^9, 3.437837662212979*^9}, {
   3.437837709728962*^9, 3.437837738039642*^9}, {3.437838012858755*^9, 
   3.437838056177829*^9}, {3.437838101010491*^9, 3.437838155338238*^9}, {
   3.437838449426968*^9, 3.43783852188799*^9}, {3.437838592569929*^9, 
   3.437838649268482*^9}, {3.437838691579712*^9, 3.437838720874263*^9}, 
   3.437838768342116*^9, {3.437838809874633*^9, 3.437838875967121*^9}, 
   3.437839268667936*^9, 3.437839566808866*^9, {3.437843503114199*^9, 
   3.437843530709181*^9}, 3.437843568265721*^9, {3.437930133401933*^9, 
   3.437930293842115*^9}, {3.437930669303011*^9, 3.437930704239172*^9}, {
   3.437931511937681*^9, 3.437931527411097*^9}, {3.437931618009623*^9, 
   3.437931715466912*^9}, 3.437931809509788*^9, {3.43793185527239*^9, 
   3.43793185554521*^9}, {3.437931968367351*^9, 3.437932053923442*^9}, {
   3.43793210270584*^9, 3.437932159002728*^9}, {3.437932195162353*^9, 
   3.437932196103469*^9}, {3.437934086352618*^9, 3.437934101726891*^9}, {
   3.437934723836948*^9, 3.43793472411895*^9}, {3.437935304785152*^9, 
   3.437935305171184*^9}, {3.437935916308532*^9, 3.437935919609181*^9}, {
   3.437937120908789*^9, 3.437937165383814*^9}, {3.438522207106747*^9, 
   3.438522246977327*^9}, {3.438522364545165*^9, 3.438522379898746*^9}, 
   3.438522450866887*^9, {3.438525770275395*^9, 3.438525819447152*^9}, {
   3.43852608695143*^9, 3.438526092509683*^9}, {3.438534091693947*^9, 
   3.43853409241791*^9}, {3.438540800983508*^9, 3.438540801722615*^9}, {
   3.438541051563785*^9, 3.438541073502911*^9}, {3.438543478767615*^9, 
   3.43854350541102*^9}, 3.438600153293412*^9, {3.438603349668146*^9, 
   3.438603363162597*^9}, {3.438603429872856*^9, 3.438603465592469*^9}, {
   3.438603507121786*^9, 3.438603514471169*^9}, {3.438603806687449*^9, 
   3.438603834330763*^9}, {3.438604004450891*^9, 3.438604078788561*^9}, {
   3.438604295612654*^9, 3.438604296291064*^9}, 3.438604395213213*^9, {
   3.438609658814028*^9, 3.438609695382083*^9}, {3.438609779621443*^9, 
   3.43860981469578*^9}, {3.43861079489507*^9, 3.438610795262744*^9}, {
   3.438611131917235*^9, 3.438611146135641*^9}, {3.438611550763467*^9, 
   3.438611554196712*^9}, {3.438614487585231*^9, 3.438614541280921*^9}, {
   3.438614593494042*^9, 3.438614594820813*^9}, {3.438616497686982*^9, 
   3.438616524378543*^9}, 3.438618013705549*^9, 3.438618712769448*^9, {
   3.438675382511541*^9, 3.438675397240171*^9}, {3.438676765375702*^9, 
   3.438676774376493*^9}, {3.438676904457776*^9, 3.438676905761353*^9}, {
   3.438677684141241*^9, 3.438677687032965*^9}, {3.43867801642861*^9, 
   3.438678056599939*^9}, {3.438679649670688*^9, 3.438679674237989*^9}, {
   3.438679896209318*^9, 3.438679896405995*^9}, {3.438680540173393*^9, 
   3.438680557903651*^9}, {3.438680846851731*^9, 3.438680871114862*^9}, {
   3.438680938509613*^9, 3.438680945806487*^9}, {3.438681392184896*^9, 
   3.438681455949564*^9}, {3.438681738669803*^9, 3.438681740158346*^9}, {
   3.438682548399693*^9, 3.438682564623316*^9}, {3.438683042784576*^9, 
   3.438683055942519*^9}, 3.43868323223029*^9, {3.438685355083299*^9, 
   3.438685357085385*^9}, {3.43869804784974*^9, 3.438698074016422*^9}, {
   3.438698234344645*^9, 3.438698279138921*^9}, 3.438698323590419*^9, {
   3.438698487500658*^9, 3.43869848795154*^9}, {3.438698538206087*^9, 
   3.438698543377779*^9}, {3.438698617083138*^9, 3.438698617420651*^9}, {
   3.438698710721017*^9, 3.438698710917431*^9}, {3.441023539483135*^9, 
   3.441023598419441*^9}, {3.441374905519705*^9, 3.441374906062353*^9}, {
   3.441377507451935*^9, 3.441377515202934*^9}, {3.441544315549632*^9, 
   3.441544363088965*^9}, {3.441544399159789*^9, 3.441544401079456*^9}, {
   3.44223691047535*^9, 3.442236937933703*^9}, 3.442252953269342*^9, {
   3.443282666020597*^9, 3.443282672202302*^9}, {3.443282716578606*^9, 
   3.443282716747974*^9}, {3.445080575972731*^9, 3.445080630800512*^9}, {
   3.445081135081164*^9, 3.445081199892675*^9}, {3.445689510918456*^9, 
   3.445689532774261*^9}, 3.445689586163452*^9, 3.445694185779966*^9, 
   3.449340073956247*^9, {3.449340553075269*^9, 3.44934060583268*^9}, {
   3.449341133128077*^9, 3.449341139784348*^9}, {3.449341663044118*^9, 
   3.449341671281586*^9}, {3.449341714503485*^9, 3.44934172024762*^9}, {
   3.449341843936967*^9, 3.449341913096676*^9}, {3.449390879307844*^9, 
   3.449390881077681*^9}, {3.449391053101145*^9, 3.449391097258918*^9}, {
   3.44939121248105*^9, 3.449391260372853*^9}, {3.449391532856907*^9, 
   3.449391552411621*^9}, {3.449391590620955*^9, 3.449391602529995*^9}, {
   3.449403958059296*^9, 3.449403962332824*^9}, 3.449404132560015*^9, {
   3.449422853589958*^9, 3.44942290850957*^9}, {3.449474573445513*^9, 
   3.44947459178496*^9}, {3.44947463284913*^9, 3.449474645868973*^9}, {
   3.44947467710653*^9, 3.449474737180041*^9}, {3.449476583015527*^9, 
   3.449476617518086*^9}, {3.449476709661286*^9, 3.449476716968927*^9}, {
   3.449476775217866*^9, 3.449476790945195*^9}, {3.449478123886524*^9, 
   3.449478157739291*^9}, {3.449478191303143*^9, 3.44947824016908*^9}, {
   3.44947827717855*^9, 3.449478288666853*^9}, {3.449480507482924*^9, 
   3.449480515795594*^9}, {3.449480624931092*^9, 3.44948065656393*^9}, {
   3.449480756871183*^9, 3.449480758228156*^9}, {3.449481475577352*^9, 
   3.449481485448946*^9}, {3.449481537847095*^9, 3.449481545031142*^9}, 
   3.449481638828361*^9, {3.449481698796496*^9, 3.449481777552297*^9}, {
   3.449481808608899*^9, 3.449481838693911*^9}, {3.449486254375378*^9, 
   3.449486261460564*^9}, {3.449486341785622*^9, 3.449486342763655*^9}, {
   3.449486375974981*^9, 3.449486455763532*^9}, {3.449486926885873*^9, 
   3.449486932150602*^9}, {3.449486966137239*^9, 3.449487015883251*^9}, {
   3.449487089237157*^9, 3.449487089568623*^9}, {3.44949558235827*^9, 
   3.449495604432623*^9}, {3.44949563546687*^9, 3.449495636123163*^9}, {
   3.449902438834045*^9, 3.449902484350574*^9}, {3.449902527455296*^9, 
   3.449902531134628*^9}, {3.449902610487388*^9, 3.449902652406307*^9}, {
   3.449902703475833*^9, 3.449902761306613*^9}, 3.449914213051775*^9, {
   3.449919933478831*^9, 3.449919962785777*^9}, {3.449920121713061*^9, 
   3.449920165951345*^9}, {3.44992029953274*^9, 3.449920310004641*^9}, {
   3.449920406073612*^9, 3.449920420295107*^9}, {3.449920465483624*^9, 
   3.449920485764104*^9}, {3.449921405886959*^9, 3.449921431124013*^9}, {
   3.449921593606798*^9, 3.449921595529048*^9}, 3.449922419485697*^9, 
   3.45138232902796*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{"i", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], "+", 
     RowBox[{"12", "*", "i"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.44991941158809*^9, 3.449919444217792*^9}, {
  3.454149615591453*^9, 3.45414961838816*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"4", "*", "i"}], "+", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "11"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.449902961516799*^9, 3.449903041735852*^9}, {
   3.449903129794791*^9, 3.449903179688734*^9}, 3.449919365353413*^9}],

Cell[BoxData[
 RowBox[{"ensemkey", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.438609902751006*^9, 3.438609904323926*^9}, 
   3.438609935234123*^9}],

Cell[BoxData[
 RowBox[{"infotable", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.4062854018125*^9, 3.4062854066875*^9}, 
   3.414410304544401*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["4 e. linear broken up plot", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nyears", "=", "250000"}], ";"}]], "Input",
 CellChangeTimes->{{3.449418460046661*^9, 3.449418465536676*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], ",",
      "newdirectory", ",", ",", "collatedoutputfolder"}], "]"}], "~~", 
   "\"\</graphs\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.438533854768155*^9, 3.438533855192011*^9}, {
   3.438681837012005*^9, 3.438681850880044*^9}, {3.438681944025736*^9, 
   3.438681959237815*^9}, 3.438684939301126*^9, 3.438685094735914*^9, 
   3.44708842308526*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newfilenmenos", "=", "filenamenos"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"newfilenmenos", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "+=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"filenames", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "nmodules"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newfilenmenos", "=", 
   RowBox[{"Flatten", "[", "newfilenmenos", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.449391360766912*^9, 3.449391512681769*^9}, 
   3.449391583477477*^9, 3.449902927997006*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"min", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
       RowBox[{
        RowBox[{"minima", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
        RowBox[{"startvalues", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ",", 
       RowBox[{"minima", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "q"}], "]"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"max", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
       RowBox[{
        RowBox[{"maxima", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
        RowBox[{"startvalues", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ",", 
       RowBox[{"maxima", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "q"}], "]"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ymindefault", "=", 
     RowBox[{"min", "-", 
      RowBox[{"0.1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"maxima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
         RowBox[{"minima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ymaxdefault", "=", 
     RowBox[{"max", "+", 
      RowBox[{"0.1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"maxima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
         RowBox[{"minima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"yearmax", "=", 
     RowBox[{"Floor", "[", 
      RowBox[{"Log", "[", 
       RowBox[{"10.", ",", 
        RowBox[{"xmax", "-", "2"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"yearmin", "=", 
     RowBox[{"Floor", "[", 
      RowBox[{"Log", "[", 
       RowBox[{"10.", ",", "xmin"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ngraphs", "=", 
     RowBox[{"yearmax", "-", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"yearmin", "<=", "2"}], ",", "2", ",", "yearmin"}], "]"}], 
      "+", "1"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"size", "=", 
     RowBox[{"300", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", "ngraphs", ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "GoldenRatio"}], ")"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"plotlabel", "=", 
     RowBox[{"StyleForm", "[", 
      RowBox[{
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<Variation of `` with time for ``\\n``\\n`` ``yr run\>\"", ",", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"shortfilenames", ",", "1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "2"}], "]"}], "]"}], ",", "config", ",", "info", 
         ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
           "\"\<relative to preindustrial\>\"", ",", "\"\<\>\""}], "]"}], ",",
          "xmax"}], "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
       RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"graphs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"data4", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "q", ",", "1", ",", "i"}], "]"}], "]"}], 
                "-", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"zerox", "\[Equal]", "True"}], ",", "plotstartyear",
                   ",", "0"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"data4", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "q", ",", 
                   RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                  "]"}], "]"}], "-", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}], ",", "0"}], "]"}], "-", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"correctdrift", "\[Equal]", "True"}], ",", 
                  RowBox[{
                   RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}], ",", "i"}], "]"}], "]"}], "-", 
                   RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                  "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x", "==", "2"}], ",", "0", ",", 
                RowBox[{"10", "^", "x"}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x", "==", "2"}], ",", 
                RowBox[{"10", "^", "3"}], ",", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"x", "+", "1"}], ")"}]}]}], "]"}]}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{"yauto", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{"ymin", ",", "ymax"}], "}"}]}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "size"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{
           RowBox[{"(", "ngraphs", ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "GoldenRatio"}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{"StyleForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                 "\"\<change in\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
               RowBox[{"yaxislabels", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", 
                  RowBox[{"2", "+", "q"}]}], "]"}], "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x", "\[Equal]", "yearmin"}], ",", "Automatic", ",", 
                RowBox[{"FontColor", "\[Rule]", "White"}]}], "]"}]}], "]"}]}],
            "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"x", "\[Equal]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"yearmin", "<=", "2"}], ",", "2", ",", "yearmin"}], 
                "]"}]}], ",", "Automatic", ",", 
              RowBox[{"Directive", "[", "White", "]"}]}], "]"}], ",", 
            "Automatic", ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x", "\[Equal]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"yearmin", "<=", "2"}], ",", "2", ",", "yearmin"}],
                   "]"}]}], ",", "True", ",", "False"}], "]"}], ",", "True", 
              ",", "True"}], "}"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"graphics2", "[", 
             RowBox[{"[", 
              RowBox[{"tab", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}]}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"yearmin", "<=", "2"}], ",", "2", ",", "yearmin"}], "]"}], 
         ",", "yearmax"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"nosinuse", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ensemblenos", "[", 
           RowBox[{"[", "tab", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"varstyles", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "tab", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"nosinuse2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"nos2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nosinuse", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"nosinuse", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"nosinuse3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nosinuse2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", "1"}], ",", 
          RowBox[{
           RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nosinuse4", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "nosinuse3", "]"}], ",", "legdisplaynos"}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newlegendplus", "=", 
     RowBox[{"newlegend", "[", 
      RowBox[{"[", "nosinuse4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"space", "=", 
     RowBox[{"StringLength", "[", 
      RowBox[{"ToString", "[", 
       RowBox[{"maxima", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "q"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"graph", "=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", ",", 
                "plotlabel"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"GraphicsGrid", "[", 
                RowBox[{
                 RowBox[{"{", "graphs", "}"}], ",", 
                 RowBox[{"Spacings", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"spacing", "+", 
                    RowBox[{"1.1", "*", "space"}]}], ")"}]}], "*", 
                    RowBox[{"(", "1", ")"}]}], ",", 
                    RowBox[{"-", "500"}]}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"size", "*", "ngraphs"}]}]}], "]"}], ",", 
               RowBox[{"newlegendplus", "//", "TableForm"}]}], "}"}], ",", 
             RowBox[{"{", "\"\<year\>\"", "}"}]}], "}"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], "}"}], "}"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.44"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"size", "*", "ngraphs", "*", "1.35"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"graph", "=", 
       RowBox[{"GraphicsGrid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Append", "[", 
           RowBox[{"graphs", ",", 
            RowBox[{"GraphicsGrid", "[", 
             RowBox[{"{", 
              RowBox[{"{", "newlegend", "}"}], "}"}], "]"}]}], "]"}], "}"}], 
         ",", 
         RowBox[{"Spacings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"spacing", ",", "spacing"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"250", "*", "yearmax"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"ShowLegend", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GraphicsGrid", "[", 
           RowBox[{
            RowBox[{"{", "graphs", "}"}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "40"}], ",", 
               RowBox[{"-", "40"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"250", "*", "yearmax"}]}]}], "]"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"newlegend", ",", "\[IndentingNewLine]", 
           RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LegendPosition", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0.9", ",", 
              RowBox[{"-", "0.5"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"LegendSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.3", "+", "0.1"}], ",", "1"}], "}"}]}]}], "}"}]}], 
        "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tab2", "=", "tab"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tabcode", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tab2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ">", "9"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"alpha", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tab2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "9"}], "}"}]}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"tab2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "tab2", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"datestring", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{"PaddedForm", "[", 
       RowBox[{
        RowBox[{"Date", "[", "]"}], ",", "5", ",", 
        RowBox[{"NumberPadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<0\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"commas", "=", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"datestring", ",", "\"\<,\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"date", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"datestring", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"commas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "2"}], ",", 
            RowBox[{
             RowBox[{"commas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "commas", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"date2", "=", 
     RowBox[{"date", "~~", 
      RowBox[{"StringTake", "[", 
       RowBox[{"datestring", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "7"}], ",", 
          RowBox[{"-", "6"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"graphtitle", "=", 
     RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
      RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", "\"\<_\>\"", "~~", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", "filenames", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"newfilenmenos", "[", 
           RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"15", ",", 
          RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", "\"\<_\>\"", "~~", 
      RowBox[{"ToString", "[", "xmax", "]"}], "~~", "\"\<yr\>\"", "~~", 
      "\"\<_plot3.\>\"", "~~", "saveformat"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{"graphtitle", ",", "graph"}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "graph", "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"o", ",", "1", ",", "\"\<variable\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Total", "[", "nfilenames", "]"}]}], "}"}]}], "]"}]}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "1", ",", "\"\<units\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"data4", "[", 
           RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"tab", ",", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"xmin", ",", "1001"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"xmax", ",", "nyears"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"ymin", ",", "ymindefault"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"ymax", ",", "ymaxdefault"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"yauto", ",", "True", ",", "\"\<auto y-axis scale\>\""}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"spacing", ",", "25"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zerox", ",", "False", ",", "\"\<relative x-axis scale\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zeroy", ",", "False", ",", "\"\<relative y-axis scale\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "correctdrift", ",", "False", ",", "\"\<correct for drift\>\""}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"title", ",", "False", ",", "\"\<title\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"saveformat", ",", "\"\<pdf\>\""}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"savegraph", ",", "False", ",", "\"\<save graph\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.399802215546875*^9, 3.399802383140625*^9}, {
   3.39980242046875*^9, 3.399802496328125*^9}, {3.399802546453125*^9, 
   3.399802570390625*^9}, {3.399802622046875*^9, 3.399802665625*^9}, {
   3.399802799484375*^9, 3.3998028529375*^9}, {3.399802930859375*^9, 
   3.39980307659375*^9}, {3.39980311275*^9, 3.399803145015625*^9}, {
   3.399803228078125*^9, 3.399803254625*^9}, {3.399803504703125*^9, 
   3.3998035993125*^9}, {3.399803845796875*^9, 3.39980388490625*^9}, {
   3.399803940890625*^9, 3.399803965921875*^9}, {3.399804274375*^9, 
   3.399804298125*^9}, {3.399804331984375*^9, 3.399804332234375*^9}, {
   3.399804367640625*^9, 3.399804375875*^9}, {3.39980465*^9, 
   3.399804699390625*^9}, {3.399804811984375*^9, 3.399804921453125*^9}, {
   3.399805093765625*^9, 3.39980515209375*^9}, {3.399805188421875*^9, 
   3.399805229609375*^9}, {3.399805281671875*^9, 3.3998052821875*^9}, {
   3.399805317390625*^9, 3.39980531784375*^9}, {3.399805361484375*^9, 
   3.399805406625*^9}, {3.399805464109375*^9, 3.39980549253125*^9}, {
   3.39980554003125*^9, 3.399805559671875*^9}, {3.39980573365625*^9, 
   3.3998058186875*^9}, {3.399805872171875*^9, 3.399805900765625*^9}, {
   3.3998059914375*^9, 3.399806032234375*^9}, {3.399806079171875*^9, 
   3.399806088203125*^9}, {3.399806137546875*^9, 3.399806165015625*^9}, 
   3.39980631121875*^9, {3.399806428796875*^9, 3.399806465421875*^9}, {
   3.399806513296875*^9, 3.399806530203125*^9}, {3.39980658909375*^9, 
   3.3998065908125*^9}, 3.3998066975*^9, {3.3998067385625*^9, 
   3.399806741984375*^9}, {3.3998068225625*^9, 3.399806822859375*^9}, {
   3.399806857140625*^9, 3.39980688875*^9}, {3.39980706328125*^9, 
   3.399807112625*^9}, {3.399807257734375*^9, 3.399807315796875*^9}, {
   3.3998078945625*^9, 3.39980789490625*^9}, {3.399807937*^9, 
   3.3998079471875*^9}, {3.39980801978125*^9, 3.399808040296875*^9}, {
   3.399808643046875*^9, 3.399808646140625*^9}, {3.399808687984375*^9, 
   3.39980885309375*^9}, {3.399808903359375*^9, 3.39980892865625*^9}, {
   3.3998089685*^9, 3.399809003234375*^9}, {3.399809437359375*^9, 
   3.3998094624375*^9}, {3.399812059890625*^9, 3.39981207515625*^9}, {
   3.399812131734375*^9, 3.399812138*^9}, 3.3998121695625*^9, {
   3.39981353325*^9, 3.399813571953125*^9}, {3.399813617515625*^9, 
   3.399813626234375*^9}, {3.399813699234375*^9, 3.399813699515625*^9}, {
   3.399813804234375*^9, 3.3998138060625*^9}, {3.39981383925*^9, 
   3.39981387409375*^9}, {3.399813927859375*^9, 3.39981393828125*^9}, 
   3.3998140469375*^9, {3.39981412225*^9, 3.399814122421875*^9}, {
   3.39981418846875*^9, 3.399814290703125*^9}, {3.399814334671875*^9, 
   3.3998143513125*^9}, {3.399814490453125*^9, 3.39981451796875*^9}, {
   3.39981469209375*^9, 3.399814739890625*^9}, {3.399814807578125*^9, 
   3.399814850109375*^9}, {3.399814894140625*^9, 3.3998149041875*^9}, 
   3.399814940359375*^9, {3.39981499978125*^9, 3.399815007609375*^9}, {
   3.39981503803125*^9, 3.399815067671875*^9}, {3.3998152955625*^9, 
   3.399815300875*^9}, {3.3998153395625*^9, 3.39981536596875*^9}, {
   3.3998154519375*^9, 3.399815456421875*^9}, {3.3998167785625*^9, 
   3.399817003328125*^9}, {3.39981748321875*^9, 3.399817488359375*^9}, {
   3.39981752996875*^9, 3.399817544953125*^9}, {3.3998176238125*^9, 
   3.399817689171875*^9}, {3.3998182713125*^9, 3.399818281953125*^9}, {
   3.400065533703125*^9, 3.4000655338125*^9}, 3.400066499078125*^9, 
   3.400066567125*^9, {3.40022856978125*^9, 3.40022860265625*^9}, {
   3.400246474265625*^9, 3.400246477828125*^9}, {3.400313103421875*^9, 
   3.40031310365625*^9}, {3.40031340453125*^9, 3.400313405875*^9}, 
   3.400913551328125*^9, {3.40092106834375*^9, 3.400921072484375*^9}, {
   3.4009211148125*^9, 3.40092113275*^9}, 3.4009400641875*^9, {
   3.402396705421875*^9, 3.40239671475*^9}, {3.404486792578125*^9, 
   3.404486795671875*^9}, 3.404553764515625*^9, 3.404652035265625*^9, {
   3.404742854203125*^9, 3.40474286246875*^9}, {3.4047433488125*^9, 
   3.404743371765625*^9}, {3.4047434075625*^9, 3.404743424234375*^9}, {
   3.40474385228125*^9, 3.40474386396875*^9}, 3.40506599040075*^9, {
   3.40506705815075*^9, 3.405067058291375*^9}, {3.40507001652575*^9, 
   3.405070020853875*^9}, 3.405174842322625*^9, {3.405175980135125*^9, 
   3.4051759802445*^9}, {3.40517605115075*^9, 3.405176053510125*^9}, {
   3.405347353640625*^9, 3.405347362*^9}, 3.4060317349375*^9, {
   3.406034676640625*^9, 3.406034682140625*^9}, {3.4060350235*^9, 
   3.40603506378125*^9}, {3.40603518359375*^9, 3.40603518625*^9}, {
   3.40603521959375*^9, 3.406035311734375*^9}, {3.406035484328125*^9, 
   3.40603548440625*^9}, {3.4060355195*^9, 3.40603552171875*^9}, 
   3.40603558621875*^9, {3.40603562325*^9, 3.406035630171875*^9}, {
   3.4060357995625*^9, 3.4060358579375*^9}, {3.40603600509375*^9, 
   3.406036012296875*^9}, {3.406036104015625*^9, 3.4060361326875*^9}, {
   3.406036809453125*^9, 3.406036833328125*^9}, {3.40603688309375*^9, 
   3.4060369260625*^9}, {3.40603716503125*^9, 3.40603718265625*^9}, {
   3.406037214546875*^9, 3.40603724534375*^9}, {3.4060373131875*^9, 
   3.406037347421875*^9}, {3.406037412609375*^9, 3.406037428515625*^9}, {
   3.4060374625*^9, 3.4060374796875*^9}, {3.40603759159375*^9, 
   3.406037659109375*^9}, {3.406037805203125*^9, 3.406037818140625*^9}, {
   3.40603801615625*^9, 3.406038017734375*^9}, {3.4060381910625*^9, 
   3.406038200734375*^9}, {3.406038327453125*^9, 3.406038343828125*^9}, {
   3.40603846653125*^9, 3.406038472515625*^9}, 3.406038557796875*^9, {
   3.406040687015625*^9, 3.406040710546875*^9}, {3.406280406140625*^9, 
   3.406280456265625*^9}, {3.406280498515625*^9, 3.406280517734375*^9}, {
   3.406280653484375*^9, 3.406280714359375*^9}, {3.4062816714375*^9, 
   3.406281672640625*^9}, 3.414401783513013*^9, {3.414409279644401*^9, 
   3.414409289582151*^9}, {3.414409364039494*^9, 3.414409366500576*^9}, 
   3.414417835626969*^9, {3.41441789078294*^9, 3.414417898807214*^9}, {
   3.420278519546875*^9, 3.420278524796875*^9}, 3.4202796783125*^9, {
   3.420284523921875*^9, 3.42028452559375*^9}, 3.42097614696664*^9, {
   3.42097620216521*^9, 3.420976203133744*^9}, 3.429460546879025*^9, {
   3.429461528905685*^9, 3.429461553793434*^9}, {3.429461660196429*^9, 
   3.429461661953682*^9}, {3.429461713979744*^9, 3.42946171671183*^9}, {
   3.429461808957419*^9, 3.429461884727344*^9}, {3.429461953478956*^9, 
   3.429461954878852*^9}, {3.429524253071853*^9, 3.429524253783337*^9}, {
   3.429524288999288*^9, 3.429524289304518*^9}, {3.429524324480033*^9, 
   3.429524390200929*^9}, 3.429526198612434*^9, {3.433168499347519*^9, 
   3.433168537187229*^9}, {3.433247372969148*^9, 3.433247450698908*^9}, 
   3.433247495964081*^9, {3.433247531940586*^9, 3.433247554574039*^9}, {
   3.433249210940027*^9, 3.433249212914151*^9}, 3.433249247325855*^9, {
   3.433250366623332*^9, 3.433250384867938*^9}, {3.433582823016408*^9, 
   3.433582825920501*^9}, {3.433768238931191*^9, 3.433768239470476*^9}, {
   3.433770014738699*^9, 3.43377002842755*^9}, 3.437727390573244*^9, 
   3.437728278865637*^9, {3.437728319884947*^9, 3.437728320396343*^9}, {
   3.437744063425779*^9, 3.437744306520345*^9}, {3.437744355617779*^9, 
   3.437744502975968*^9}, {3.437744533130372*^9, 3.437744560823158*^9}, {
   3.437744611244762*^9, 3.437744638757771*^9}, 3.437744680958937*^9, {
   3.437745313795701*^9, 3.437745316390152*^9}, {3.437745375653767*^9, 
   3.437745405626921*^9}, {3.437746617952706*^9, 3.437746622308804*^9}, {
   3.437746678033799*^9, 3.437746705533958*^9}, {3.437746848209913*^9, 
   3.437746849728387*^9}, {3.437746885426444*^9, 3.437746885840515*^9}, 
   3.437746925758948*^9, {3.437747071509877*^9, 3.437747110992275*^9}, {
   3.437837296098457*^9, 3.437837314474528*^9}, {3.437837353953153*^9, 
   3.437837372083555*^9}, {3.437837657602802*^9, 3.437837662212979*^9}, {
   3.437837709728962*^9, 3.437837738039642*^9}, {3.437838012858755*^9, 
   3.437838056177829*^9}, {3.437838101010491*^9, 3.437838155338238*^9}, {
   3.437838449426968*^9, 3.43783852188799*^9}, {3.437838592569929*^9, 
   3.437838649268482*^9}, {3.437838691579712*^9, 3.437838720874263*^9}, 
   3.437838768342116*^9, {3.437838809874633*^9, 3.437838875967121*^9}, 
   3.437839268667936*^9, 3.437839566808866*^9, {3.437843503114199*^9, 
   3.437843530709181*^9}, 3.437843568265721*^9, {3.437930133401933*^9, 
   3.437930293842115*^9}, {3.437930669303011*^9, 3.437930704239172*^9}, {
   3.437931511937681*^9, 3.437931527411097*^9}, {3.437931618009623*^9, 
   3.437931715466912*^9}, 3.437931809509788*^9, {3.43793185527239*^9, 
   3.43793185554521*^9}, {3.437931968367351*^9, 3.437932053923442*^9}, {
   3.43793210270584*^9, 3.437932159002728*^9}, {3.437932195162353*^9, 
   3.437932196103469*^9}, {3.437934086352618*^9, 3.437934101726891*^9}, {
   3.437934723836948*^9, 3.43793472411895*^9}, {3.437935304785152*^9, 
   3.437935305171184*^9}, {3.437935916308532*^9, 3.437935919609181*^9}, {
   3.437937120908789*^9, 3.437937165383814*^9}, {3.438522207106747*^9, 
   3.438522246977327*^9}, {3.438522364545165*^9, 3.438522379898746*^9}, 
   3.438522450866887*^9, {3.438525770275395*^9, 3.438525819447152*^9}, {
   3.43852608695143*^9, 3.438526092509683*^9}, {3.438538369210055*^9, 
   3.438538385737676*^9}, {3.438540786857788*^9, 3.438540810767357*^9}, 
   3.438541116415868*^9, 3.438543200156883*^9, {3.438543281129701*^9, 
   3.438543292903156*^9}, {3.438543340933903*^9, 3.4385433756099*^9}, {
   3.438543860968147*^9, 3.438543873286815*^9}, {3.43854393006315*^9, 
   3.438543976956483*^9}, 3.44934007996306*^9, {3.449406108718242*^9, 
   3.449406113222255*^9}, 3.449406165363651*^9, 3.449406292548701*^9, {
   3.449406405442975*^9, 3.449406431346884*^9}, {3.449406502743058*^9, 
   3.449406515387412*^9}, {3.449406588938335*^9, 3.449406692035475*^9}, {
   3.449406767824117*^9, 3.449406810236333*^9}, {3.449407195039862*^9, 
   3.449407215603552*^9}, {3.449407399827731*^9, 3.449407400049147*^9}, {
   3.449408091819972*^9, 3.449408132698667*^9}, {3.449408199557877*^9, 
   3.44940825288622*^9}, {3.449408312051043*^9, 3.449408323395126*^9}, {
   3.449408355171327*^9, 3.449408367703705*^9}, {3.449408632022591*^9, 
   3.449408660270431*^9}, {3.449408707959315*^9, 3.449408845266566*^9}, {
   3.449408977119609*^9, 3.449408982850448*^9}, {3.449409088956658*^9, 
   3.449409090200327*^9}, {3.449409125961866*^9, 3.449409152176235*^9}, {
   3.449409272120035*^9, 3.449409291580672*^9}, 3.449409364942255*^9, {
   3.449409535805527*^9, 3.449409542024767*^9}, {3.449409584358353*^9, 
   3.449409585105952*^9}, {3.449409641594504*^9, 3.449409681293603*^9}, {
   3.449409713899705*^9, 3.449409778308422*^9}, {3.449413090043455*^9, 
   3.449413128204477*^9}, {3.449413337203283*^9, 3.449413367455591*^9}, {
   3.449413442933637*^9, 3.449413445505247*^9}, {3.449413605550889*^9, 
   3.4494136262087*^9}, {3.449416374845854*^9, 3.449416471867031*^9}, {
   3.449416502271357*^9, 3.449416503998143*^9}, {3.449416570003135*^9, 
   3.449416587966253*^9}, {3.449417808983636*^9, 3.449417894653055*^9}, {
   3.449417927478545*^9, 3.449417965736791*^9}, {3.449418032225499*^9, 
   3.449418038650584*^9}, {3.44941817811927*^9, 3.449418187685665*^9}, {
   3.449418246424233*^9, 3.449418253121091*^9}, {3.449418308981003*^9, 
   3.449418315005642*^9}, 3.449418435888842*^9, {3.44941853196611*^9, 
   3.449418585783073*^9}, {3.449418634900827*^9, 3.449418677942186*^9}, {
   3.449418715044069*^9, 3.449418737009744*^9}, {3.449419212032513*^9, 
   3.449419214779831*^9}, {3.449419308796468*^9, 3.449419309381052*^9}, {
   3.449419361346906*^9, 3.449419391104245*^9}, {3.449419429548885*^9, 
   3.449419431735488*^9}, {3.449419482884645*^9, 3.449419623569315*^9}, {
   3.449422833398029*^9, 3.449422839495658*^9}, {3.449496229851363*^9, 
   3.449496237611607*^9}, {3.449498208634231*^9, 3.449498211260307*^9}, {
   3.449498406631709*^9, 3.44949843430832*^9}, {3.449498710019029*^9, 
   3.449498744078971*^9}, 3.449498783480266*^9, {3.449498864178595*^9, 
   3.449498864329735*^9}, {3.449498914513708*^9, 3.449498915519979*^9}, {
   3.449499267909041*^9, 3.449499280993399*^9}, {3.449499360498395*^9, 
   3.449499378629558*^9}, {3.449499411354215*^9, 3.449499422392769*^9}, {
   3.449499458864391*^9, 3.449499461458717*^9}, {3.449499622927874*^9, 
   3.44949964419854*^9}, {3.449499858519809*^9, 3.44949986177595*^9}, {
   3.449500120839612*^9, 3.449500124725863*^9}, {3.449500183451776*^9, 
   3.449500184100131*^9}, {3.449500269217134*^9, 3.449500324913631*^9}, {
   3.449500429240896*^9, 3.449500445515871*^9}, {3.4495005480927*^9, 
   3.449500584676606*^9}, {3.449500621247813*^9, 3.449500629407115*^9}, {
   3.449500703671063*^9, 3.44950071089367*^9}, {3.449500848659923*^9, 
   3.449500852546654*^9}, 3.449500884269213*^9, {3.449922381862364*^9, 
   3.449922405675148*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["4 f. Plot array", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, 3.437928334078296*^9, 3.438600152808993*^9, 
   3.449390207397173*^9, 3.449404815374842*^9, {3.44992115213933*^9, 
   3.449921157897719*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], ",",
      "newdirectory", ",", ",", "collatedoutputfolder"}], "]"}], "~~", 
   "\"\</graphs\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.438533854768155*^9, 3.438533855192011*^9}, {
   3.438681837012005*^9, 3.438681850880044*^9}, {3.438681944025736*^9, 
   3.438681959237815*^9}, 3.438684939301126*^9, 3.438685094735914*^9, 
   3.44708842308526*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newfilenmenos", "=", "filenamenos"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"newfilenmenos", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "+=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"filenames", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "nmodules"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newfilenmenos", "=", 
   RowBox[{"Flatten", "[", "newfilenmenos", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.449391360766912*^9, 3.449391512681769*^9}, 
   3.449391583477477*^9, 3.449902927997006*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"arraydimensions", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrayvariables", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrayunits", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrayplotranges", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0002", ",", "0.001"}], "}"}], ",", "Automatic", ",", 
     "Automatic", ",", "Automatic", ",", "Automatic", ",", "Automatic"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"narrayvariables", "=", 
   RowBox[{"Length", "[", "arrayvariables", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"arraytitles", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"shortfilenames", ",", "1"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"v", ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"v", ",", "narrayvariables"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.44992119799053*^9, 3.449921199200674*^9}, {
   3.449921498417081*^9, 3.449921566212822*^9}, 3.449921603069396*^9, {
   3.44992165024892*^9, 3.449921706862593*^9}, {3.449922656340523*^9, 
   3.449922672607494*^9}, {3.449922705509529*^9, 3.44992272198247*^9}, 
   3.449922852465056*^9, {3.44992377473465*^9, 3.44992377580239*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xmindefault", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zerox", "\[Equal]", "False"}], ",", "plotstartyear", ",", 
       "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"plotlabel", "=", 
     RowBox[{"StyleForm", "[", 
      RowBox[{
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<Variation of `` with time for ``\\n``\\n`` ``yr run\>\"", ",", 
         "arraytitles", ",", "config", ",", "info", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
           "\"\<relative to preindustrial\>\"", ",", "\"\<\>\""}], "]"}], ",",
          "xmax"}], "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
       RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"size", "=", 
     RowBox[{"300", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", "narrayvariables", ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "GoldenRatio"}], ")"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"nosinuse", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ensemblenos", "[", 
           RowBox[{"[", "tab", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"varstyles", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "tab", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"nosinuse2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"nos2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nosinuse", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"nosinuse", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"nosinuse3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nosinuse2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", "1"}], ",", 
          RowBox[{
           RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nosinuse4", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "nosinuse3", "]"}], ",", "legdisplaynos"}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newlegendplus", "=", 
     RowBox[{"newlegend", "[", 
      RowBox[{"[", "nosinuse4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"graphs", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListLogLinearPlot", "[", "##", "]"}], ",", 
            RowBox[{"ListPlot", "[", "##", "]"}]}], "}"}], "[", 
          RowBox[{"[", "l", "]"}], "]"}], "&"}], "@", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", "1", ",", "i"}], 
                    "]"}], "]"}], "-", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zerox", "\[Equal]", "True"}], ",", 
                    "plotstartyear", ",", "0"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], "-", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}], ",", "0"}], "]"}], "-", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"correctdrift", "\[Equal]", "True"}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}]}], "]"}], "]"}], "]"}], ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}], ",", "i"}], "]"}], "]"}], "-", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    "]"}]}], "]"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", ",", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"shortfilenames", ",", "1"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"v", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameTicksStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"v", "\[Equal]", "narrayvariables"}], ",", 
                 "Automatic", ",", 
                 RowBox[{"Directive", "[", "White", "]"}]}], "]"}], ",", 
               "Automatic", ",", "Automatic", ",", "Automatic"}], "}"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StyleForm", "[", 
                RowBox[{"\"\<year\>\"", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"v", "\[Equal]", "narrayvariables"}], ",", 
                   "Automatic", ",", 
                   RowBox[{"FontColor", "\[Rule]", "White"}]}], "]"}]}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                  "\"\<change in\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
                RowBox[{"yaxislabels", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"arrayvariables", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], ",", 
                   RowBox[{"2", "+", 
                    RowBox[{"arrayunits", "[", 
                    RowBox[{"[", "v", "]"}], "]"}]}]}], "]"}], "]"}]}]}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
               RowBox[{"arrayplotranges", "[", 
                RowBox[{"[", "v", "]"}], "]"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"GridLines", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"graphics2", "[", 
                RowBox[{"[", 
                 RowBox[{"tab", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}]}]}], 
           "}"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "narrayvariables"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"graph", "=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", ",", 
               "plotlabel"}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GraphicsGrid", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"graphs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "narrayvariables"}], "}"}]}], "]"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"size", "*", "narrayvariables"}]}]}], "]"}], ",", 
              RowBox[{"newlegendplus", "//", "TableForm"}]}], "}"}], ",", 
            RowBox[{"{", "\"\<year\>\"", "}"}]}], "}"}], "]"}], "}"}], "}"}], 
       ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.44"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"size", "*", "narrayvariables", "*", "1.35"}]}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tab2", "=", "tab"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tabcode", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tab2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ">", "9"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"alpha", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tab2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "9"}], "}"}]}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"tab2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "tab2", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"datestring", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{"PaddedForm", "[", 
       RowBox[{
        RowBox[{"Date", "[", "]"}], ",", "5", ",", 
        RowBox[{"NumberPadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<0\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"commas", "=", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"datestring", ",", "\"\<,\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"date", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"datestring", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"commas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "2"}], ",", 
            RowBox[{
             RowBox[{"commas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "commas", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"date2", "=", 
     RowBox[{"date", "~~", 
      RowBox[{"StringTake", "[", 
       RowBox[{"datestring", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "7"}], ",", 
          RowBox[{"-", "6"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"graphtitle", "=", 
     RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
      RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", "\"\<_\>\"", "~~", 
      "\"\<plotarray\>\"", "~~", "\"\<_\>\"", "~~", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"correctdrift", "\[Equal]", "True"}], ",", 
        "\"\<driftcorr\>\"", ",", "\"\<\>\""}], "]"}], "~~", "\"\<_\>\"", "~~", 
      RowBox[{"ToString", "[", "xmax", "]"}], "~~", "\"\<yr\>\"", "~~", 
      "\"\<_\>\"", "~~", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"l", "\[Equal]", "1"}], ",", "\"\<log\>\"", ",", 
        "\"\<linear\>\""}], "]"}], "~~", "\"\<_\>\"", "~~", "date"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"latex", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\includegraphics[\
scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{figure}\\n\\n\\\
n\>\"", ",", "latexscale", ",", "graphtitle", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], ",", 
         "graphtitle"}], "]"}], ",", "StandardForm"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"\"\<latex/\>\"", "~~", "graphtitle", "~~", "\"\<.txt\>\""}], 
        ",", "latex"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"graphtitle", "~~", "\"\<.\>\"", "~~", 
           RowBox[{"saveformats", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "graph"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"graph", ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", "800", "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"tab", ",", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "\"\<plot type\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"xmin", ",", "xmindefault"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"xmax", ",", "nyears"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zerox", ",", "False", ",", "\"\<relative x-axis scale\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zeroy", ",", "False", ",", "\"\<relative y-axis scale\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "correctdrift", ",", "False", ",", "\"\<correct for drift\>\""}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"title", ",", "False", ",", "\"\<title\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"saveformats", ",", 
     RowBox[{"{", 
      RowBox[{"{", "\"\<pdf\>\"", "}"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"savegraph", ",", "False", ",", "\"\<save graph\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.399802215546875*^9, 3.399802383140625*^9}, {
   3.39980242046875*^9, 3.399802496328125*^9}, {3.399802546453125*^9, 
   3.399802570390625*^9}, {3.399802622046875*^9, 3.399802665625*^9}, {
   3.399802799484375*^9, 3.3998028529375*^9}, {3.399802930859375*^9, 
   3.39980307659375*^9}, {3.39980311275*^9, 3.399803145015625*^9}, {
   3.399803228078125*^9, 3.399803254625*^9}, {3.399803504703125*^9, 
   3.3998035993125*^9}, {3.399803845796875*^9, 3.39980388490625*^9}, {
   3.399803940890625*^9, 3.399803965921875*^9}, {3.399804274375*^9, 
   3.399804298125*^9}, {3.399804331984375*^9, 3.399804332234375*^9}, {
   3.399804367640625*^9, 3.399804375875*^9}, {3.39980465*^9, 
   3.399804699390625*^9}, {3.399804811984375*^9, 3.399804921453125*^9}, {
   3.399805093765625*^9, 3.39980515209375*^9}, {3.399805188421875*^9, 
   3.399805229609375*^9}, {3.399805281671875*^9, 3.3998052821875*^9}, {
   3.399805317390625*^9, 3.39980531784375*^9}, {3.399805361484375*^9, 
   3.399805406625*^9}, {3.399805464109375*^9, 3.39980549253125*^9}, {
   3.39980554003125*^9, 3.399805559671875*^9}, {3.39980573365625*^9, 
   3.3998058186875*^9}, {3.399805872171875*^9, 3.399805900765625*^9}, {
   3.3998059914375*^9, 3.399806032234375*^9}, {3.399806079171875*^9, 
   3.399806088203125*^9}, {3.399806137546875*^9, 3.399806165015625*^9}, 
   3.39980631121875*^9, {3.399806428796875*^9, 3.399806465421875*^9}, {
   3.399806513296875*^9, 3.399806530203125*^9}, {3.39980658909375*^9, 
   3.3998065908125*^9}, 3.3998066975*^9, {3.3998067385625*^9, 
   3.399806741984375*^9}, {3.3998068225625*^9, 3.399806822859375*^9}, {
   3.399806857140625*^9, 3.39980688875*^9}, {3.39980706328125*^9, 
   3.399807112625*^9}, {3.399807257734375*^9, 3.399807315796875*^9}, {
   3.3998078945625*^9, 3.39980789490625*^9}, {3.399807937*^9, 
   3.3998079471875*^9}, {3.39980801978125*^9, 3.399808040296875*^9}, {
   3.399808643046875*^9, 3.399808646140625*^9}, {3.399808687984375*^9, 
   3.39980885309375*^9}, {3.399808903359375*^9, 3.39980892865625*^9}, {
   3.3998089685*^9, 3.399809003234375*^9}, {3.399809437359375*^9, 
   3.3998094624375*^9}, {3.399812059890625*^9, 3.39981207515625*^9}, {
   3.399812131734375*^9, 3.399812138*^9}, 3.3998121695625*^9, {
   3.39981353325*^9, 3.399813571953125*^9}, {3.399813617515625*^9, 
   3.399813626234375*^9}, {3.399813699234375*^9, 3.399813699515625*^9}, {
   3.399813804234375*^9, 3.3998138060625*^9}, {3.39981383925*^9, 
   3.39981387409375*^9}, {3.399813927859375*^9, 3.39981393828125*^9}, 
   3.3998140469375*^9, {3.39981412225*^9, 3.399814122421875*^9}, {
   3.39981418846875*^9, 3.399814290703125*^9}, {3.399814334671875*^9, 
   3.3998143513125*^9}, {3.399814490453125*^9, 3.39981451796875*^9}, {
   3.39981469209375*^9, 3.399814739890625*^9}, {3.399814807578125*^9, 
   3.399814850109375*^9}, {3.399814894140625*^9, 3.3998149041875*^9}, 
   3.399814940359375*^9, {3.39981499978125*^9, 3.399815007609375*^9}, {
   3.39981503803125*^9, 3.399815067671875*^9}, {3.3998152955625*^9, 
   3.399815300875*^9}, {3.3998153395625*^9, 3.39981536596875*^9}, {
   3.3998154519375*^9, 3.399815456421875*^9}, {3.3998167785625*^9, 
   3.399817003328125*^9}, {3.39981748321875*^9, 3.399817488359375*^9}, {
   3.39981752996875*^9, 3.399817544953125*^9}, {3.3998176238125*^9, 
   3.399817689171875*^9}, {3.3998182713125*^9, 3.399818281953125*^9}, {
   3.400065533703125*^9, 3.4000655338125*^9}, 3.400066499078125*^9, 
   3.400066567125*^9, {3.40022856978125*^9, 3.40022860265625*^9}, {
   3.400246474265625*^9, 3.400246477828125*^9}, {3.400313103421875*^9, 
   3.40031310365625*^9}, {3.40031340453125*^9, 3.400313405875*^9}, 
   3.400913551328125*^9, {3.40092106834375*^9, 3.400921072484375*^9}, {
   3.4009211148125*^9, 3.40092113275*^9}, 3.4009400641875*^9, {
   3.402396705421875*^9, 3.40239671475*^9}, {3.404486792578125*^9, 
   3.404486795671875*^9}, 3.404553764515625*^9, 3.404652035265625*^9, {
   3.404742854203125*^9, 3.40474286246875*^9}, {3.4047433488125*^9, 
   3.404743371765625*^9}, {3.4047434075625*^9, 3.404743424234375*^9}, {
   3.40474385228125*^9, 3.40474386396875*^9}, 3.40506599040075*^9, {
   3.40506705815075*^9, 3.405067058291375*^9}, {3.40507001652575*^9, 
   3.405070020853875*^9}, 3.405174842322625*^9, {3.405175980135125*^9, 
   3.4051759802445*^9}, {3.40517605115075*^9, 3.405176053510125*^9}, {
   3.405347353640625*^9, 3.405347362*^9}, 3.4060317349375*^9, {
   3.406034676640625*^9, 3.406034682140625*^9}, {3.4060350235*^9, 
   3.40603506378125*^9}, {3.40603518359375*^9, 3.40603518625*^9}, {
   3.40603521959375*^9, 3.406035311734375*^9}, {3.406035484328125*^9, 
   3.40603548440625*^9}, {3.4060355195*^9, 3.40603552171875*^9}, 
   3.40603558621875*^9, {3.40603562325*^9, 3.406035630171875*^9}, {
   3.4060357995625*^9, 3.4060358579375*^9}, {3.40603600509375*^9, 
   3.406036012296875*^9}, {3.406036104015625*^9, 3.4060361326875*^9}, {
   3.406036809453125*^9, 3.406036833328125*^9}, {3.40603688309375*^9, 
   3.4060369260625*^9}, {3.40603716503125*^9, 3.40603718265625*^9}, {
   3.406037214546875*^9, 3.40603724534375*^9}, {3.4060373131875*^9, 
   3.406037347421875*^9}, {3.406037412609375*^9, 3.406037428515625*^9}, {
   3.4060374625*^9, 3.4060374796875*^9}, {3.40603759159375*^9, 
   3.406037659109375*^9}, {3.406037805203125*^9, 3.406037818140625*^9}, {
   3.40603801615625*^9, 3.406038017734375*^9}, {3.4060381910625*^9, 
   3.406038200734375*^9}, {3.406038327453125*^9, 3.406038343828125*^9}, {
   3.40603846653125*^9, 3.406038472515625*^9}, 3.406038557796875*^9, {
   3.406040687015625*^9, 3.406040710546875*^9}, {3.406280406140625*^9, 
   3.406280456265625*^9}, {3.406280498515625*^9, 3.406280517734375*^9}, {
   3.406280653484375*^9, 3.406280714359375*^9}, {3.4062816714375*^9, 
   3.406281672640625*^9}, 3.414401783513013*^9, {3.414409279644401*^9, 
   3.414409289582151*^9}, {3.414409364039494*^9, 3.414409366500576*^9}, 
   3.414417835626969*^9, {3.41441789078294*^9, 3.414417898807214*^9}, {
   3.420278519546875*^9, 3.420278524796875*^9}, 3.4202796783125*^9, {
   3.420284523921875*^9, 3.42028452559375*^9}, 3.42097614696664*^9, {
   3.42097620216521*^9, 3.420976203133744*^9}, 3.429460546879025*^9, {
   3.429461528905685*^9, 3.429461553793434*^9}, {3.429461660196429*^9, 
   3.429461661953682*^9}, {3.429461713979744*^9, 3.42946171671183*^9}, {
   3.429461808957419*^9, 3.429461884727344*^9}, {3.429461953478956*^9, 
   3.429461954878852*^9}, {3.429524253071853*^9, 3.429524253783337*^9}, {
   3.429524288999288*^9, 3.429524289304518*^9}, {3.429524324480033*^9, 
   3.429524390200929*^9}, 3.429526198612434*^9, {3.433168499347519*^9, 
   3.433168537187229*^9}, {3.433247372969148*^9, 3.433247450698908*^9}, 
   3.433247495964081*^9, {3.433247531940586*^9, 3.433247554574039*^9}, {
   3.433249210940027*^9, 3.433249212914151*^9}, 3.433249247325855*^9, {
   3.433250366623332*^9, 3.433250384867938*^9}, {3.433582823016408*^9, 
   3.433582825920501*^9}, {3.433768238931191*^9, 3.433768239470476*^9}, {
   3.433770014738699*^9, 3.43377002842755*^9}, 3.437727390573244*^9, 
   3.437728278865637*^9, {3.437728319884947*^9, 3.437728320396343*^9}, {
   3.437744063425779*^9, 3.437744306520345*^9}, {3.437744355617779*^9, 
   3.437744502975968*^9}, {3.437744533130372*^9, 3.437744560823158*^9}, {
   3.437744611244762*^9, 3.437744638757771*^9}, 3.437744680958937*^9, {
   3.437745313795701*^9, 3.437745316390152*^9}, {3.437745375653767*^9, 
   3.437745405626921*^9}, {3.437746617952706*^9, 3.437746622308804*^9}, {
   3.437746678033799*^9, 3.437746705533958*^9}, {3.437746848209913*^9, 
   3.437746849728387*^9}, {3.437746885426444*^9, 3.437746885840515*^9}, 
   3.437746925758948*^9, {3.437747071509877*^9, 3.437747110992275*^9}, {
   3.437837296098457*^9, 3.437837314474528*^9}, {3.437837353953153*^9, 
   3.437837372083555*^9}, {3.437837657602802*^9, 3.437837662212979*^9}, {
   3.437837709728962*^9, 3.437837738039642*^9}, {3.437838012858755*^9, 
   3.437838056177829*^9}, {3.437838101010491*^9, 3.437838155338238*^9}, {
   3.437838449426968*^9, 3.43783852188799*^9}, {3.437838592569929*^9, 
   3.437838649268482*^9}, {3.437838691579712*^9, 3.437838720874263*^9}, 
   3.437838768342116*^9, {3.437838809874633*^9, 3.437838875967121*^9}, 
   3.437839268667936*^9, 3.437839566808866*^9, {3.437843503114199*^9, 
   3.437843530709181*^9}, 3.437843568265721*^9, {3.437930133401933*^9, 
   3.437930293842115*^9}, {3.437930669303011*^9, 3.437930704239172*^9}, {
   3.437931511937681*^9, 3.437931527411097*^9}, {3.437931618009623*^9, 
   3.437931715466912*^9}, 3.437931809509788*^9, {3.43793185527239*^9, 
   3.43793185554521*^9}, {3.437931968367351*^9, 3.437932053923442*^9}, {
   3.43793210270584*^9, 3.437932159002728*^9}, {3.437932195162353*^9, 
   3.437932196103469*^9}, {3.437934086352618*^9, 3.437934101726891*^9}, {
   3.437934723836948*^9, 3.43793472411895*^9}, {3.437935304785152*^9, 
   3.437935305171184*^9}, {3.437935916308532*^9, 3.437935919609181*^9}, {
   3.437937120908789*^9, 3.437937165383814*^9}, {3.438522207106747*^9, 
   3.438522246977327*^9}, {3.438522364545165*^9, 3.438522379898746*^9}, 
   3.438522450866887*^9, {3.438525770275395*^9, 3.438525819447152*^9}, {
   3.43852608695143*^9, 3.438526092509683*^9}, {3.438534091693947*^9, 
   3.43853409241791*^9}, {3.438540800983508*^9, 3.438540801722615*^9}, {
   3.438541051563785*^9, 3.438541073502911*^9}, {3.438543478767615*^9, 
   3.43854350541102*^9}, 3.438600153293412*^9, {3.438603349668146*^9, 
   3.438603363162597*^9}, {3.438603429872856*^9, 3.438603465592469*^9}, {
   3.438603507121786*^9, 3.438603514471169*^9}, {3.438603806687449*^9, 
   3.438603834330763*^9}, {3.438604004450891*^9, 3.438604078788561*^9}, {
   3.438604295612654*^9, 3.438604296291064*^9}, 3.438604395213213*^9, {
   3.438609658814028*^9, 3.438609695382083*^9}, {3.438609779621443*^9, 
   3.43860981469578*^9}, {3.43861079489507*^9, 3.438610795262744*^9}, {
   3.438611131917235*^9, 3.438611146135641*^9}, {3.438611550763467*^9, 
   3.438611554196712*^9}, {3.438614487585231*^9, 3.438614541280921*^9}, {
   3.438614593494042*^9, 3.438614594820813*^9}, {3.438616497686982*^9, 
   3.438616524378543*^9}, 3.438618013705549*^9, 3.438618712769448*^9, {
   3.438675382511541*^9, 3.438675397240171*^9}, {3.438676765375702*^9, 
   3.438676774376493*^9}, {3.438676904457776*^9, 3.438676905761353*^9}, {
   3.438677684141241*^9, 3.438677687032965*^9}, {3.43867801642861*^9, 
   3.438678056599939*^9}, {3.438679649670688*^9, 3.438679674237989*^9}, {
   3.438679896209318*^9, 3.438679896405995*^9}, {3.438680540173393*^9, 
   3.438680557903651*^9}, {3.438680846851731*^9, 3.438680871114862*^9}, {
   3.438680938509613*^9, 3.438680945806487*^9}, {3.438681392184896*^9, 
   3.438681455949564*^9}, {3.438681738669803*^9, 3.438681740158346*^9}, {
   3.438682548399693*^9, 3.438682564623316*^9}, {3.438683042784576*^9, 
   3.438683055942519*^9}, 3.43868323223029*^9, {3.438685355083299*^9, 
   3.438685357085385*^9}, {3.43869804784974*^9, 3.438698074016422*^9}, {
   3.438698234344645*^9, 3.438698279138921*^9}, 3.438698323590419*^9, {
   3.438698487500658*^9, 3.43869848795154*^9}, {3.438698538206087*^9, 
   3.438698543377779*^9}, {3.438698617083138*^9, 3.438698617420651*^9}, {
   3.438698710721017*^9, 3.438698710917431*^9}, {3.441023539483135*^9, 
   3.441023598419441*^9}, {3.441374905519705*^9, 3.441374906062353*^9}, {
   3.441377507451935*^9, 3.441377515202934*^9}, {3.441544315549632*^9, 
   3.441544363088965*^9}, {3.441544399159789*^9, 3.441544401079456*^9}, {
   3.44223691047535*^9, 3.442236937933703*^9}, 3.442252953269342*^9, {
   3.443282666020597*^9, 3.443282672202302*^9}, {3.443282716578606*^9, 
   3.443282716747974*^9}, {3.445080575972731*^9, 3.445080630800512*^9}, {
   3.445081135081164*^9, 3.445081199892675*^9}, {3.445689510918456*^9, 
   3.445689532774261*^9}, 3.445689586163452*^9, 3.445694185779966*^9, 
   3.449340073956247*^9, {3.449340553075269*^9, 3.44934060583268*^9}, {
   3.449341133128077*^9, 3.449341139784348*^9}, {3.449341663044118*^9, 
   3.449341671281586*^9}, {3.449341714503485*^9, 3.44934172024762*^9}, {
   3.449341843936967*^9, 3.449341913096676*^9}, {3.449390879307844*^9, 
   3.449390881077681*^9}, {3.449391053101145*^9, 3.449391097258918*^9}, {
   3.44939121248105*^9, 3.449391260372853*^9}, {3.449391532856907*^9, 
   3.449391552411621*^9}, {3.449391590620955*^9, 3.449391602529995*^9}, {
   3.449403958059296*^9, 3.449403962332824*^9}, 3.449404132560015*^9, {
   3.449422853589958*^9, 3.44942290850957*^9}, {3.449474573445513*^9, 
   3.44947459178496*^9}, {3.44947463284913*^9, 3.449474645868973*^9}, {
   3.44947467710653*^9, 3.449474737180041*^9}, {3.449476583015527*^9, 
   3.449476617518086*^9}, {3.449476709661286*^9, 3.449476716968927*^9}, {
   3.449476775217866*^9, 3.449476790945195*^9}, {3.449478123886524*^9, 
   3.449478157739291*^9}, {3.449478191303143*^9, 3.44947824016908*^9}, {
   3.44947827717855*^9, 3.449478288666853*^9}, {3.449480507482924*^9, 
   3.449480515795594*^9}, {3.449480624931092*^9, 3.44948065656393*^9}, {
   3.449480756871183*^9, 3.449480758228156*^9}, {3.449481475577352*^9, 
   3.449481485448946*^9}, {3.449481537847095*^9, 3.449481545031142*^9}, 
   3.449481638828361*^9, {3.449481698796496*^9, 3.449481777552297*^9}, {
   3.449481808608899*^9, 3.449481838693911*^9}, {3.449486254375378*^9, 
   3.449486261460564*^9}, {3.449486341785622*^9, 3.449486342763655*^9}, {
   3.449486375974981*^9, 3.449486455763532*^9}, {3.449486926885873*^9, 
   3.449486932150602*^9}, {3.449486966137239*^9, 3.449487015883251*^9}, {
   3.449487089237157*^9, 3.449487089568623*^9}, {3.44949558235827*^9, 
   3.449495604432623*^9}, {3.44949563546687*^9, 3.449495636123163*^9}, {
   3.449902438834045*^9, 3.449902484350574*^9}, {3.449902527455296*^9, 
   3.449902531134628*^9}, {3.449902610487388*^9, 3.449902652406307*^9}, {
   3.449902703475833*^9, 3.449902761306613*^9}, 3.449914213051775*^9, {
   3.449919933478831*^9, 3.449919962785777*^9}, {3.449920121713061*^9, 
   3.449920165951345*^9}, {3.44992029953274*^9, 3.449920310004641*^9}, {
   3.449920406073612*^9, 3.449920420295107*^9}, {3.449920465483624*^9, 
   3.449920485764104*^9}, {3.449921586714247*^9, 3.449921587239063*^9}, {
   3.449921740684389*^9, 3.449921741199418*^9}, {3.449921787773625*^9, 
   3.449921807452611*^9}, {3.449921865191968*^9, 3.449921911895036*^9}, {
   3.449922015766361*^9, 3.44992202651296*^9}, 3.449922058297066*^9, {
   3.449922095520055*^9, 3.449922156784926*^9}, {3.449922230309174*^9, 
   3.44992226411567*^9}, 3.449922315513887*^9, 3.449922443770781*^9, {
   3.4499224968199*^9, 3.449922502482104*^9}, 3.449922557079875*^9, {
   3.449922591137648*^9, 3.449922591591687*^9}, 3.449922681659978*^9, 
   3.449922744348292*^9, {3.449922789664804*^9, 3.449922814158501*^9}, 
   3.449922902505815*^9, {3.449922936134933*^9, 3.449922940517749*^9}, 
   3.449922971745968*^9, {3.449923063282447*^9, 3.449923093780762*^9}, 
   3.449923250287659*^9, {3.449923337195802*^9, 3.449923340664928*^9}, 
   3.449923483484936*^9, {3.449924826275286*^9, 3.449924826773461*^9}, {
   3.449924903514986*^9, 3.449924916360299*^9}, {3.449924952538771*^9, 
   3.449925019865049*^9}, {3.449925063785349*^9, 3.449925066797539*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{"ccc", ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "]"}], ",", 
   RowBox[{"Spacings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "0", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", 
        RowBox[{"{", "}"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.449926235502938*^9, 3.449926276282346*^9}}],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{"graphs", ",", "2"}], "]"}], ",", 
   RowBox[{"Spacings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "40"}], ",", 
        RowBox[{"-", "40"}]}], "}"}], ",", 
      RowBox[{"-", "20"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"size", "*", "6"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.449924264983175*^9, 3.449924290032155*^9}, {
  3.449924332407689*^9, 3.449924374614096*^9}, {3.449924421933156*^9, 
  3.449924519905355*^9}, {3.449924719804459*^9, 3.449924789839955*^9}, {
  3.449925139154297*^9, 3.449925259079558*^9}, {3.449926161991647*^9, 
  3.449926194131672*^9}, {3.44992630167351*^9, 3.449926310569798*^9}}],

Cell[BoxData["graphs"], "Input",
 CellChangeTimes->{{3.449923439155744*^9, 3.449923447865431*^9}}],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"Grid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", ",", 
          "plotlabel"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GraphicsGrid", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{"graphs", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"newlegendplus", "//", "TableForm"}]}], "}"}], ",", 
       RowBox[{"{", "\"\<year\>\"", "}"}]}], "}"}], "]"}], "}"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.449923623224096*^9, 3.44992364656604*^9}, 
   3.449924122225506*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Mod", "[", 
    RowBox[{"j", ",", "3", ",", "1"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.449923883265509*^9, 3.44992395044674*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Partition", "[", 
   RowBox[{"graphs", ",", "2"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.449924004973085*^9, 3.449924032931194*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{"graphs", "[", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{"i", "+", 
      RowBox[{"Mod", "[", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "narrayvariables"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.44992339594626*^9, 3.449923417448677*^9}, {
  3.449923462300618*^9, 3.449923462902951*^9}, {3.449923871170749*^9, 
  3.44992388050943*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{"i", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "+", 
     RowBox[{"12", "*", "i"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.44991941158809*^9, 3.449919444217792*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"4", "*", "i"}], "+", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "11"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.449902961516799*^9, 3.449903041735852*^9}, {
   3.449903129794791*^9, 3.449903179688734*^9}, 3.449919365353413*^9}],

Cell[BoxData[
 RowBox[{"ensemkey", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.438609902751006*^9, 3.438609904323926*^9}, 
   3.438609935234123*^9}],

Cell[BoxData[
 RowBox[{"infotable", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.4062854018125*^9, 3.4062854066875*^9}, 
   3.414410304544401*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["5. Timescale analysis for pCO2 & temperature", "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066413671875*^9}, 
   3.4000664990625*^9, 3.400066567125*^9, {3.406040935703125*^9, 
   3.40604096303125*^9}, 3.406287839828125*^9, {3.420526479515625*^9, 
   3.420526493203125*^9}, {3.42052699359375*^9, 3.42052699875*^9}, 
   3.42053286221875*^9, 3.438600159033955*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataset3", "=", 
   RowBox[{"{", ",", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset3", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"data4", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2", ",", "1", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"data4", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2", ",", 
          RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "nruns"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"data4", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", 
           RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataset3", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"data4", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1", ",", "1", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"data4", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1", ",", 
          RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "nruns"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"data4", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1", ",", 
           RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.420526829515625*^9, 3.42052686178125*^9}, {
  3.420526948171875*^9, 3.420526991078125*^9}, {3.438619057588084*^9, 
  3.43861906182833*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"max", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"dataset3", "[", 
          RowBox[{"[", 
           RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"dataset3", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], 
                "]"}], "\[Equal]", "Real"}], ",", 
              RowBox[{"dataset3", "[", 
               RowBox[{"[", 
                RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], 
              ",", ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"dataset3", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"downcurve", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"dataset3", "[", 
        RowBox[{"[", 
         RowBox[{"d", ",", "k", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nruns"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"max", "[", 
          RowBox[{"[", 
           RowBox[{"d", ",", "k", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Length", "[", 
          RowBox[{"dataset3", "[", 
           RowBox[{"[", 
            RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"logdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"downcurve", "[", 
          RowBox[{"[", 
           RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", 
                RowBox[{"downcurve", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"downcurve", "[", 
               RowBox[{"[", 
                RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}]}], 
             ")"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", 
                RowBox[{"downcurve", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{"Last", "[", 
                RowBox[{"downcurve", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "]"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nruns"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"downcurve", "[", 
            RowBox[{"[", 
             RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", "1"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"timescaledata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"logdata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{"logdata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", 
               RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}], 
          "/", "2"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"logdata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", 
               RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"logdata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"logdata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"logdata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", 
               RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], ")"}]}]}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nruns"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"logdata", "[", 
            RowBox[{"[", 
             RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", "1"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"timescaledata2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"timescaledata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{"timescaledata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", 
               RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}], 
          "/", "2"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"timescaledata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", 
               RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"timescaledata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"timescaledata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", 
               RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"timescaledata", "[", 
             RowBox[{"[", 
              RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}]}], 
           ")"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nruns"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"timescaledata", "[", 
            RowBox[{"[", 
             RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", "1"}]}], 
        "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.400246792296875*^9, 3.400246793109375*^9}, {
   3.400246847828125*^9, 3.400246900828125*^9}, {3.400246956328125*^9, 
   3.40024698953125*^9}, {3.40024718775*^9, 3.400247190015625*^9}, {
   3.40024740740625*^9, 3.400247442484375*^9}, {3.4002502833125*^9, 
   3.4002503029375*^9}, 3.40025081684375*^9, {3.40025107009375*^9, 
   3.40025111525*^9}, {3.400251145953125*^9, 3.4002511486875*^9}, {
   3.400251183578125*^9, 3.40025118903125*^9}, {3.400251299265625*^9, 
   3.40025156565625*^9}, {3.4002520319375*^9, 3.40025211315625*^9}, {
   3.4002521946875*^9, 3.400252232015625*^9}, 3.400252286828125*^9, {
   3.400256541578125*^9, 3.400256568296875*^9}, 3.40025700940625*^9, {
   3.4002587294375*^9, 3.400258734921875*^9}, 3.4205267253125*^9, {
   3.438619240685478*^9, 3.438619243017281*^9}, {3.438620409482508*^9, 
   3.438620410187224*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"timescaledata", "[", 
      RowBox[{"[", 
       RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"timescaledata", "[", 
          RowBox[{"[", 
           RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], "]"}], "==",
         "Real"}], ",", 
       RowBox[{"timescaledata", "[", 
        RowBox[{"[", 
         RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], ",", ",", 
       "0"}], "]"}]}], ";"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"timescaledata", "[", 
       RowBox[{"[", 
        RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.438620174124749*^9, 3.438620364673844*^9}, {
  3.438620422998542*^9, 3.438620423264586*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"timescaledata2", "[", 
      RowBox[{"[", 
       RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"timescaledata2", "[", 
          RowBox[{"[", 
           RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], "]"}], "==",
         "Real"}], ",", 
       RowBox[{"timescaledata2", "[", 
        RowBox[{"[", 
         RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], ",", ",", 
       "0"}], "]"}]}], ";"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"timescaledata2", "[", 
       RowBox[{"[", 
        RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.438620394412804*^9, 3.438620400093246*^9}}]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xmin", "=", "2000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", "1000000"}], ";"}]}], "Input",
 CellChangeTimes->{{3.400252413984375*^9, 3.40025241403125*^9}, {
  3.400327122421875*^9, 3.40032712334375*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"plotlabel", "=", 
     RowBox[{"StyleForm", "[", 
      RowBox[{
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<e-folding timescale of `` for `` ``; ``yr run\>\"", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", "filenames", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"newfilenmenos", "[", 
                RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"15", ",", 
               RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}], ",", 
         "config", ",", "info", ",", "xmax"}], "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
       RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"nosinuse", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ensemblenos", "[", 
           RowBox[{"[", "tab", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"varstyles", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "tab", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"nosinuse2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"nos2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nosinuse", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"nosinuse", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"nosinuse3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nosinuse2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", "1"}], ",", 
          RowBox[{
           RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nosinuse4", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "nosinuse3", "]"}], ",", "legdisplaynos"}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newlegendplus", "=", 
     RowBox[{"newlegend", "[", 
      RowBox[{"[", "nosinuse4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"graph", "=", 
     RowBox[{"ShowLegend", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"timescaledata", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", 
              RowBox[{"tab", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<year\>\"", ",", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<dln(``-\!\(\*SubscriptBox[\(``\), \(final\)]\))/dt \
(years)\>\"", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]pCO\), \(2\)]\)\>\"",
                  ",", "\"\<\[CapitalDelta]T\>\""}], "}"}], "[", 
               RowBox[{"[", "o", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]pCO\), \(2\)]\)\>\"",
                  ",", "\"\<\[CapitalDelta]T\>\""}], "}"}], "[", 
               RowBox[{"[", "o", "]"}], "]"}]}], "]"}], ",", "None", ",", 
            "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", ",", 
            "plotlabel"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{"yauto", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{"ymin", ",", "ymax"}], "}"}]}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", "900", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "Automatic", ",", "Automatic", ",", "Automatic", ",", 
            "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"graphics2", "[", 
             RowBox[{"[", 
              RowBox[{"tab", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLinesStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Thin", ",", "Thin"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"newlegendplus", ",", "\[IndentingNewLine]", 
         RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LegendPosition", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.9", ",", 
            RowBox[{"-", "0.5"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LegendSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.4", ",", "1"}], "}"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tab2", "=", "tab"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tabcode", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tab2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ">", "9"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"alpha", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tab2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "9"}], "}"}]}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"tab2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "tab2", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"datestring", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{"PaddedForm", "[", 
       RowBox[{
        RowBox[{"Date", "[", "]"}], ",", "5", ",", 
        RowBox[{"NumberPadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<0\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"commas", "=", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"datestring", ",", "\"\<,\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"date", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"datestring", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"commas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "2"}], ",", 
            RowBox[{
             RowBox[{"commas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "commas", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"date2", "=", 
     RowBox[{"date", "~~", 
      RowBox[{"StringTake", "[", 
       RowBox[{"datestring", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "7"}], ",", 
          RowBox[{"-", "6"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"graphtitle", "=", 
     RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
      RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", "\"\<_\>\"", "~~", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", "filenames", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"newfilenmenos", "[", 
           RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"15", ",", 
          RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", "\"\<_e-folding_\>\"", "~~", 
      RowBox[{"ToString", "[", "xmax", "]"}], "~~", "\"\<yr\>\"", "~~", 
      "\"\<_\>\"", "~~", "date"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"latex", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\includegraphics[\
scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{figure}\\n\\n\\\
n\>\"", ",", "latexscale", ",", "graphtitle", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], ",", 
         "graphtitle"}], "]"}], ",", "StandardForm"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"\"\<latex/\>\"", "~~", "graphtitle", "~~", "\"\<.txt\>\""}], 
        ",", "latex"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"graphtitle", "~~", "\"\<.\>\"", "~~", 
           RowBox[{"saveformats", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "graph"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"graph", ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", "800", "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"o", ",", "1", ",", "\"\<variable\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"tab", ",", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"xmin", ",", "1000"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"xmax", ",", "nyears"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"ymin", ",", "100"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"ymax", ",", 
     RowBox[{"10", "^", "6"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"yauto", ",", "False", ",", "\"\<auto y-axis scale\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"title", ",", "False", ",", "\"\<title\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"saveformats", ",", 
     RowBox[{"{", 
      RowBox[{"{", "\"\<pdf\>\"", "}"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"savegraph", ",", "False", ",", "\"\<save graph\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.399802215546875*^9, 3.399802383140625*^9}, {
   3.39980242046875*^9, 3.399802496328125*^9}, {3.399802546453125*^9, 
   3.399802570390625*^9}, {3.399802622046875*^9, 3.399802665625*^9}, {
   3.399802799484375*^9, 3.3998028529375*^9}, {3.399802930859375*^9, 
   3.39980307659375*^9}, {3.39980311275*^9, 3.399803145015625*^9}, {
   3.399803228078125*^9, 3.399803254625*^9}, {3.399803504703125*^9, 
   3.3998035993125*^9}, {3.399803845796875*^9, 3.39980388490625*^9}, {
   3.399803940890625*^9, 3.399803965921875*^9}, {3.399804274375*^9, 
   3.399804298125*^9}, {3.399804331984375*^9, 3.399804332234375*^9}, {
   3.399804367640625*^9, 3.399804375875*^9}, {3.39980465*^9, 
   3.399804699390625*^9}, {3.399804811984375*^9, 3.399804921453125*^9}, {
   3.399805093765625*^9, 3.39980515209375*^9}, {3.399805188421875*^9, 
   3.399805229609375*^9}, {3.399805281671875*^9, 3.3998052821875*^9}, {
   3.399805317390625*^9, 3.39980531784375*^9}, {3.399805361484375*^9, 
   3.399805406625*^9}, {3.399805464109375*^9, 3.39980549253125*^9}, {
   3.39980554003125*^9, 3.399805559671875*^9}, {3.39980573365625*^9, 
   3.3998058186875*^9}, {3.399805872171875*^9, 3.399805900765625*^9}, {
   3.3998059914375*^9, 3.399806032234375*^9}, {3.399806079171875*^9, 
   3.399806088203125*^9}, {3.399806137546875*^9, 3.399806165015625*^9}, 
   3.39980631121875*^9, {3.399806428796875*^9, 3.399806465421875*^9}, {
   3.399806513296875*^9, 3.399806530203125*^9}, {3.39980658909375*^9, 
   3.3998065908125*^9}, 3.3998066975*^9, {3.3998067385625*^9, 
   3.399806741984375*^9}, {3.3998068225625*^9, 3.399806822859375*^9}, {
   3.399806857140625*^9, 3.39980688875*^9}, {3.39980706328125*^9, 
   3.399807112625*^9}, {3.399807257734375*^9, 3.399807315796875*^9}, {
   3.3998078945625*^9, 3.39980789490625*^9}, {3.399807937*^9, 
   3.3998079471875*^9}, {3.39980801978125*^9, 3.399808040296875*^9}, {
   3.399808643046875*^9, 3.399808646140625*^9}, {3.399808687984375*^9, 
   3.39980885309375*^9}, {3.399808903359375*^9, 3.39980892865625*^9}, {
   3.3998089685*^9, 3.399809003234375*^9}, {3.399809437359375*^9, 
   3.3998094624375*^9}, {3.399812059890625*^9, 3.39981207515625*^9}, {
   3.399812131734375*^9, 3.399812138*^9}, 3.3998121695625*^9, {
   3.39981353325*^9, 3.399813571953125*^9}, {3.399813617515625*^9, 
   3.399813626234375*^9}, {3.399813699234375*^9, 3.399813699515625*^9}, {
   3.399813804234375*^9, 3.3998138060625*^9}, {3.39981383925*^9, 
   3.39981387409375*^9}, {3.399813927859375*^9, 3.39981393828125*^9}, 
   3.3998140469375*^9, {3.39981412225*^9, 3.399814122421875*^9}, {
   3.39981418846875*^9, 3.399814290703125*^9}, {3.399814334671875*^9, 
   3.3998143513125*^9}, {3.399814490453125*^9, 3.39981451796875*^9}, {
   3.39981469209375*^9, 3.399814739890625*^9}, {3.399814807578125*^9, 
   3.399814850109375*^9}, {3.399814894140625*^9, 3.3998149041875*^9}, 
   3.399814940359375*^9, {3.39981499978125*^9, 3.399815007609375*^9}, {
   3.39981503803125*^9, 3.399815067671875*^9}, {3.3998152955625*^9, 
   3.399815300875*^9}, {3.3998153395625*^9, 3.39981536596875*^9}, {
   3.3998154519375*^9, 3.399815456421875*^9}, {3.3998167785625*^9, 
   3.399817003328125*^9}, {3.39981748321875*^9, 3.399817488359375*^9}, {
   3.39981752996875*^9, 3.399817544953125*^9}, {3.3998176238125*^9, 
   3.399817689171875*^9}, {3.3998182713125*^9, 3.399818281953125*^9}, {
   3.400065533703125*^9, 3.4000655338125*^9}, 3.400066499078125*^9, 
   3.400066567125*^9, {3.40022856978125*^9, 3.40022860265625*^9}, {
   3.400246474265625*^9, 3.400246477828125*^9}, {3.400313103421875*^9, 
   3.40031310365625*^9}, {3.40031340453125*^9, 3.400313405875*^9}, 
   3.400913551328125*^9, {3.40092106834375*^9, 3.400921072484375*^9}, {
   3.4009211148125*^9, 3.40092113275*^9}, 3.4009400641875*^9, {
   3.402396705421875*^9, 3.40239671475*^9}, {3.404486792578125*^9, 
   3.404486795671875*^9}, 3.404553764515625*^9, 3.404652035265625*^9, {
   3.404742854203125*^9, 3.40474286246875*^9}, {3.4047433488125*^9, 
   3.404743371765625*^9}, {3.4047434075625*^9, 3.404743424234375*^9}, {
   3.40474385228125*^9, 3.40474386396875*^9}, 3.40506599040075*^9, {
   3.40506705815075*^9, 3.405067058291375*^9}, {3.40507001652575*^9, 
   3.405070020853875*^9}, 3.405174842322625*^9, {3.405175980135125*^9, 
   3.4051759802445*^9}, {3.40517605115075*^9, 3.405176053510125*^9}, {
   3.405347353640625*^9, 3.405347362*^9}, 3.4060317349375*^9, {
   3.406034676640625*^9, 3.406034682140625*^9}, {3.4060350235*^9, 
   3.40603506378125*^9}, {3.40603518359375*^9, 3.40603518625*^9}, {
   3.40603521959375*^9, 3.406035311734375*^9}, {3.406035484328125*^9, 
   3.40603548440625*^9}, {3.4060355195*^9, 3.40603552171875*^9}, 
   3.40603558621875*^9, {3.40603562325*^9, 3.406035630171875*^9}, {
   3.4060357995625*^9, 3.4060358579375*^9}, {3.40603600509375*^9, 
   3.406036012296875*^9}, {3.406036104015625*^9, 3.4060361326875*^9}, {
   3.406036809453125*^9, 3.406036833328125*^9}, {3.40603688309375*^9, 
   3.4060369260625*^9}, {3.40603716503125*^9, 3.40603718265625*^9}, {
   3.406037214546875*^9, 3.40603724534375*^9}, {3.4060373131875*^9, 
   3.406037347421875*^9}, {3.406037412609375*^9, 3.406037428515625*^9}, {
   3.4060374625*^9, 3.4060374796875*^9}, {3.40603759159375*^9, 
   3.406037659109375*^9}, {3.406037805203125*^9, 3.406037818140625*^9}, {
   3.40603801615625*^9, 3.406038017734375*^9}, {3.4060381910625*^9, 
   3.406038200734375*^9}, {3.406038327453125*^9, 3.406038343828125*^9}, {
   3.40603846653125*^9, 3.406038472515625*^9}, 3.406038557796875*^9, {
   3.406040687015625*^9, 3.406040710546875*^9}, {3.406280406140625*^9, 
   3.406280456265625*^9}, {3.406280498515625*^9, 3.406280517734375*^9}, {
   3.406280653484375*^9, 3.406280714359375*^9}, {3.4062816714375*^9, 
   3.406281672640625*^9}, 3.414401783513013*^9, {3.414409279644401*^9, 
   3.414409289582151*^9}, {3.414409364039494*^9, 3.414409366500576*^9}, 
   3.414417835626969*^9, {3.41441789078294*^9, 3.414417898807214*^9}, {
   3.420278519546875*^9, 3.420278524796875*^9}, 3.4202796783125*^9, {
   3.420284523921875*^9, 3.42028452559375*^9}, 3.420286223546875*^9, {
   3.420529808453125*^9, 3.42052981190625*^9}, 3.42052986440625*^9, {
   3.4205298948125*^9, 3.420529950328125*^9}, {3.420529989015625*^9, 
   3.420529996171875*^9}, {3.420530028015625*^9, 3.4205300735*^9}, {
   3.4205301146875*^9, 3.42053019921875*^9}, {3.42053023296875*^9, 
   3.42053024925*^9}, 3.42053028765625*^9, {3.420530375140625*^9, 
   3.420530379953125*^9}, {3.420530505921875*^9, 3.42053052959375*^9}, {
   3.420530602359375*^9, 3.420530612140625*^9}, 3.42053064584375*^9, {
   3.42053095425*^9, 3.42053098296875*^9}, {3.420531037421875*^9, 
   3.42053104859375*^9}, {3.4205312676875*^9, 3.420531318703125*^9}, 
   3.420531358765625*^9, {3.4205314729375*^9, 3.420531609140625*^9}, 
   3.420976137246406*^9, 3.429460546905575*^9, 3.437727390600199*^9, 
   3.437728278903869*^9, {3.437728321245571*^9, 3.437728321751776*^9}, {
   3.438619010366414*^9, 3.438619022489741*^9}, {3.438619066191964*^9, 
   3.438619068160867*^9}, {3.438619100011569*^9, 3.438619133855864*^9}, 
   3.438619170376259*^9, {3.43862053184544*^9, 3.438620551966106*^9}, 
   3.438620639067306*^9, {3.438620670579897*^9, 3.438620713099102*^9}, {
   3.438620871479916*^9, 3.438620914848819*^9}, {3.438620979828219*^9, 
   3.43862099253202*^9}, {3.438621212477171*^9, 3.438621240507935*^9}, {
   3.438621465659021*^9, 3.438621506049844*^9}, {3.438621564980311*^9, 
   3.438621567035344*^9}, {3.438621622037555*^9, 3.438621623007558*^9}, {
   3.438621718317544*^9, 3.438621736096957*^9}, {3.43862189823144*^9, 
   3.438621901361105*^9}, 3.438621937069757*^9, {3.43867829536051*^9, 
   3.438678310929396*^9}, {3.438678425297288*^9, 3.438678454298687*^9}, {
   3.438683101738461*^9, 3.438683165112142*^9}, {3.43868319738669*^9, 
   3.438683202009415*^9}, {3.438690599068225*^9, 3.438690606326596*^9}, {
   3.44923427867877*^9, 3.449234298430051*^9}, {3.449234416045777*^9, 
   3.449234421962764*^9}, {3.449307258838765*^9, 3.449307264607618*^9}, {
   3.451382143851587*^9, 3.451382166862642*^9}, {3.451382259654386*^9, 
   3.451382276686637*^9}, 3.451382343273336*^9, 3.451382500740885*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "6. ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]]],
 " code"
}], "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066413671875*^9}, 
   3.4000664990625*^9, 3.400066567125*^9, {3.406040935703125*^9, 
   3.40604096303125*^9}, 3.406287839828125*^9, {3.420526479515625*^9, 
   3.420526493203125*^9}, {3.42052699359375*^9, 3.42052699875*^9}, 
   3.42053286221875*^9, 3.438600159033955*^9, {3.438682790074391*^9, 
   3.438682799433134*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], ",",
      "newdirectory", ",", ",", "collatedoutputfolder"}], "]"}], "~~", 
   "\"\</graphs/latex\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.438681606524779*^9, 3.438681614390643*^9}, {
   3.438682069290729*^9, 3.438682082921585*^9}, {3.438684803413881*^9, 
   3.438684806213771*^9}, {3.438684942562996*^9, 3.438684943522619*^9}, 
   3.438685096416317*^9, 3.447088424547656*^9}],

Cell[BoxData[
 RowBox[{"header", "=", 
  "\"\<\\documentclass[10pt,a4paper,onecolumn]{article}\\n\\n\\usepackage[\
latin1]{inputenc}\\n\\usepackage{amsmath}\\n\\usepackage{amsfonts}\\n\\\
usepackage{amssymb}\\n\\usepackage{graphicx}\\n\\n\\\\title{Weathering in an \
Earth System Model}\\n\\author{Greg Colbourn\\\\School of Environmental \
Sciences\\\\University of East Anglia\\\\Norwich NR4 7TJ \
UK\\\\g.colbourn@uea.ac.uk}\\n\\n\\begin{document}\\n\\maketitle\\n\\n\\\
section{Introduction}\>\""}]], "Input",
 CellChangeTimes->{{3.441377240542797*^9, 3.441377262413746*^9}, {
  3.441377315702558*^9, 3.441377441187942*^9}}],

Cell[BoxData[
 RowBox[{"footer", "=", "\"\<\\end{document}\>\""}]], "Input",
 CellChangeTimes->{{3.441377322461751*^9, 3.441377329294058*^9}}],

Cell[BoxData[
 RowBox[{"latexfile", "=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNames", "[", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"FileNames", "[", "]"}], "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.438681046505616*^9, 3.438681092473386*^9}, {
   3.438681627883557*^9, 3.438681677056248*^9}, 3.438681715361052*^9, 
   3.438682026057903*^9, {3.438682117333443*^9, 3.438682122923039*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], ",",
      "newdirectory", ",", ",", "collatedoutputfolder"}], "]"}], "~~", 
   "\"\</graphs\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.438681606524779*^9, 3.438681614390643*^9}, {
   3.438682069290729*^9, 3.438682105727062*^9}, 3.438684944054945*^9, 
   3.43868509683548*^9, 3.447088425417867*^9}],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<latex.txt\>\"", ",", "latexfile"}], "]"}]], "Input",
 CellChangeTimes->{{3.43867949001709*^9, 3.438679501869942*^9}, {
  3.43868213689296*^9, 3.438682137241054*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["7. Net CDF", "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066413671875*^9}, 
   3.4000664990625*^9, 3.400066567125*^9, {3.406040935703125*^9, 
   3.40604096303125*^9}, 3.406287839828125*^9, {3.420526479515625*^9, 
   3.420526493203125*^9}, {3.42052699359375*^9, 3.42052699875*^9}, 
   3.42053286221875*^9, 3.438600159033955*^9, {3.450608951926087*^9, 
   3.450608966036371*^9}}],

Cell[CellGroupData[{

Cell["7 a. Set-up", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.451643580850363*^9, 3.451643593138852*^9}, {3.452437407931332*^9, 
   3.452437410942711*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nnetcdfmodules", "=", 
   RowBox[{"Length", "[", "netcdfmodules", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"thiswillnevershowup", "=", "\"\<hello\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.451911790003061*^9, 3.451911793715416*^9}, {
  3.45191199017491*^9, 3.45191199036001*^9}, {3.452521469748793*^9, 
  3.452521477227274*^9}, {3.452867374136533*^9, 3.452867381522505*^9}, {
  3.452867468433494*^9, 3.452867470129644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"years1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
        RowBox[{"runids", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
        RowBox[{"ToString", "[", 
         RowBox[{"dimensions", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "1"}], "]"}], "]"}], "]"}], "~~", 
        "\"\<d.nc\>\""}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Datasets\>\"", ",", "\"\<year\>\""}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.45061238311918*^9, 3.450612398496465*^9}, {
   3.451906372765405*^9, 3.45190638954891*^9}, 3.451906421087658*^9, {
   3.451906677416549*^9, 3.451906682308933*^9}, 3.452868269536173*^9}],

Cell[BoxData[
 RowBox[{"years1", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.452868254430968*^9, 3.452868270608297*^9}}],

Cell[BoxData[
 RowBox[{"nnetcdfyears", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"years1", "[", 
      RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.451643517287721*^9, 3.451643525943838*^9}, {
   3.451906450446109*^9, 3.451906466204161*^9}, {3.451906688773889*^9, 
   3.451906689917162*^9}, 3.452874787062476*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allnames", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
        RowBox[{"runids", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
        RowBox[{"ToString", "[", 
         RowBox[{"dimensions", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
        "\"\<d.nc\>\""}], ",", 
       RowBox[{"{", "\"\<Datasets\>\"", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.450609687173103*^9, 3.450609688452399*^9}, {
  3.45060977710259*^9, 3.450609784506606*^9}, {3.451904917352296*^9, 
  3.451904937250269*^9}, {3.451905209430801*^9, 3.451905295961208*^9}, {
  3.451905352913275*^9, 3.451905432126768*^9}, {3.451905484546081*^9, 
  3.451905503810923*^9}, {3.451905576619705*^9, 3.451905652281757*^9}, {
  3.451905947538187*^9, 3.451905960103901*^9}, {3.451905998775102*^9, 
  3.451906001074161*^9}, {3.451906072446205*^9, 3.451906113751392*^9}, {
  3.451906162529861*^9, 3.451906163954954*^9}, {3.451906290277773*^9, 
  3.451906306114839*^9}, {3.451906693189874*^9, 3.451906703127801*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"datanames", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"allnames", "[", 
      RowBox[{"[", 
       RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"nhousekeepingdata", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", 
       RowBox[{"Length", "[", 
        RowBox[{"allnames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.450609271454848*^9, 3.45060932142587*^9}, {
  3.450609518992931*^9, 3.450609565184529*^9}, {3.450609609990619*^9, 
  3.450609672405849*^9}, {3.450609732648812*^9, 3.450609788929991*^9}, {
  3.451905511561232*^9, 3.451905535063192*^9}, {3.451906144383356*^9, 
  3.451906174131562*^9}, {3.451906256128182*^9, 3.451906287479412*^9}, {
  3.451906708171061*^9, 3.451906716190158*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"datanames", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Delete", "[", 
    RowBox[{
     RowBox[{"datanames", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.451917128167035*^9, 3.451917149151814*^9}, 
   3.45197852931464*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"datanames", "//", "TableForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.451906262718437*^9, 3.451906285375511*^9}, 
   3.451906562798219*^9, 3.451978532860027*^9}],

Cell[BoxData[
 RowBox[{"nrealdata", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"datanames", "[", 
      RowBox[{"[", 
       RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"dimensions", "[", 
        RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.451906490115274*^9, 3.451906519329993*^9}, {
  3.451906724391095*^9, 3.451906728498411*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"annotations", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
        RowBox[{"runids", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
        RowBox[{"ToString", "[", 
         RowBox[{"dimensions", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
        "\"\<d.nc\>\""}], ",", 
       RowBox[{"{", "\"\<Annotations\>\"", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.453050617174865*^9, 3.453050627037096*^9}, 
   3.453050678424414*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"annotations", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"annotations", "[", 
      RowBox[{"[", 
       RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{
        RowBox[{"nhousekeepingdata", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", 
       RowBox[{"Length", "[", 
        RowBox[{"allnames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.451973740617146*^9, 3.451973764766153*^9}, {
   3.451974045920856*^9, 3.451974058082563*^9}, {3.451975117737536*^9, 
   3.451975119632106*^9}, 3.451975981191085*^9, 3.451976360098986*^9, {
   3.453050683237134*^9, 3.453050688413021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"headings", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"annotations", "[", 
      RowBox[{"[", 
       RowBox[{"m", ",", "d", ",", "l", ",", "i", ",", "1"}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"annotations", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.451973959394905*^9, 3.451973973691128*^9}, 
   3.451974359055698*^9, {3.451974981735924*^9, 3.45197509446195*^9}, {
   3.451975156816257*^9, 3.451975185860822*^9}, {3.451975219280219*^9, 
   3.451975260903906*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unitposition", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"headings", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
          "\"\<units\>\""}], "]"}], "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"headings", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
          "\"\<units\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.451975265093526*^9, 3.451975333811611*^9}, {
   3.45197539025721*^9, 3.451975393551617*^9}, {3.451975475075455*^9, 
   3.451975520498953*^9}, 3.451976291613607*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"units", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"unitposition", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "\[Equal]", "0"}], 
       ",", "\"\<\>\"", ",", 
       RowBox[{"annotations", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d", ",", "l", ",", 
          RowBox[{"unitposition", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", "2"}], 
         "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.451972512231297*^9, 3.451972595352103*^9}, {
   3.451972775947423*^9, 3.451972777848812*^9}, {3.451972819292053*^9, 
   3.451972987506377*^9}, {3.451973034251501*^9, 3.451973063942791*^9}, {
   3.451973097538456*^9, 3.451973147898103*^9}, {3.45197320633322*^9, 
   3.451973222757998*^9}, {3.451973326672154*^9, 3.45197334438119*^9}, {
   3.451973422216857*^9, 3.451973436465728*^9}, {3.451975351502028*^9, 
   3.451975383207503*^9}, {3.451975534804364*^9, 3.451975575300214*^9}, {
   3.451975948139146*^9, 3.451975954150257*^9}, 3.451976542909299*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"longnameposition", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"headings", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
          "\"\<long_name\>\""}], "]"}], "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"headings", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
          "\"\<long_name\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.451975265093526*^9, 3.451975333811611*^9}, {
   3.45197539025721*^9, 3.451975393551617*^9}, {3.451975475075455*^9, 
   3.451975520498953*^9}, 3.451976291613607*^9, {3.451976433983277*^9, 
   3.451976439573032*^9}, {3.451976482128964*^9, 3.451976495456341*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"longnames", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"longnameposition", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "\[Equal]", "0"}], 
       ",", "\"\<\>\"", ",", 
       RowBox[{"annotations", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d", ",", "l", ",", 
          RowBox[{"longnameposition", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", "2"}], 
         "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dimensions", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.451972512231297*^9, 3.451972595352103*^9}, {
   3.451972775947423*^9, 3.451972777848812*^9}, {3.451972819292053*^9, 
   3.451972987506377*^9}, {3.451973034251501*^9, 3.451973063942791*^9}, {
   3.451973097538456*^9, 3.451973147898103*^9}, {3.45197320633322*^9, 
   3.451973222757998*^9}, {3.451973326672154*^9, 3.45197334438119*^9}, {
   3.451973422216857*^9, 3.451973436465728*^9}, {3.451975351502028*^9, 
   3.451975383207503*^9}, {3.451975534804364*^9, 3.451975575300214*^9}, {
   3.451975948139146*^9, 3.451975954150257*^9}, {3.451976503444538*^9, 
   3.451976512065434*^9}, 3.451976545077854*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varmultipliers", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"nvars", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "nvar", ",", 
            RowBox[{"nvar", "-", "m"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "0", ",", 
          RowBox[{"nvar", "-", "2"}]}], "}"}]}], "]"}], "]"}], ",", "1"}], 
    "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"netcdfstartyearnos", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.451316704815254*^9, 3.451316712691234*^9}, {
  3.451917995289757*^9, 3.451918001513525*^9}, {3.453043498714891*^9, 
  3.45304350194831*^9}, {3.453046693603625*^9, 3.453046696684246*^9}, {
  3.453047416439684*^9, 3.453047417052301*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genielatsused", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"180", "*", 
       RowBox[{
        RowBox[{"ArcSin", "[", 
         RowBox[{"k", "/", 
          RowBox[{"(", 
           RowBox[{"genielat", "/", "2"}], ")"}]}], "]"}], "/", "\[Pi]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"genielat", "/", "2"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"genielatsused", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Reverse", "[", "genielatsused", "]"}]}], ",", "0", ",", 
      "genielatsused"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"latdiffs", "=", 
   RowBox[{"Abs", "[", 
    RowBox[{"Differences", "[", "genielatsused", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"genielatsused", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"genielatsused", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], "+", 
   RowBox[{"latdiffs", "/", "2."}]}]}]}], "Input",
 CellChangeTimes->{{3.38849093259375*^9, 3.388490948*^9}, {
   3.388491115046875*^9, 3.388491118484375*^9}, {3.388491207421875*^9, 
   3.388491236328125*^9}, {3.388491266796875*^9, 3.388491314203125*^9}, {
   3.38849135178125*^9, 3.388491365828125*^9}, {3.388491446515625*^9, 
   3.3884915390625*^9}, 3.388491762640625*^9, 3.3884924160625*^9, 
   3.388492529984375*^9, {3.388492565*^9, 3.38849262503125*^9}, 
   3.388493015203125*^9, 3.3884959595625*^9, 3.38849643625*^9, 
   3.451392948945696*^9, 3.451392983063698*^9, {3.451393156203387*^9, 
   3.45139318480653*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"landmask1", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"landmaskfile", ",", "\"\<CSV\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"landmask2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"StringDrop", "[", 
          RowBox[{
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"landmask1", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"\"\<  \>\"", "\[Rule]", "\"\< 0\>\""}]}], "]"}], ",", 
           "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ",", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"genielon", "+", "2"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"genielat", "+", "2"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"landmask3", "=", 
   RowBox[{"ToExpression", "[", "landmask2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"landmask4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"landmask3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", 
        RowBox[{"j", "+", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "genielat"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.452525520299539*^9, 3.452525571453077*^9}, {
   3.452525606080696*^9, 3.452525629854139*^9}, {3.452525681395646*^9, 
   3.452525710820174*^9}, 3.452527061682217*^9, 3.452865742207551*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "SetDirectory", "[", 
    "\"\</esdata/env/pvp06gzu/work/PhD/Data/weathering/fig\>\"", "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"landmask", "=", 
    RowBox[{"Import", "[", "\"\<landmask.dat\>\"", "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.452527014485751*^9, 3.452527017107267*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"landmask", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"landmask4", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], ">", "90"}], ",", "1", ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "genielat"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"landmask", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"landmask", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{"8", "*", 
              RowBox[{"genielon", "/", "36"}]}]}], ",", "genielon", ",", 
            "1"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "genielat"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"landmask", "=", 
   RowBox[{"Reverse", "[", "landmask", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayPlot", "[", "landmask", "]"}]}], "Input",
 CellChangeTimes->{{3.451395601745984*^9, 3.451395619915119*^9}, {
   3.451395736027926*^9, 3.45139578513578*^9}, 3.451396073649955*^9, {
   3.451396160934503*^9, 3.451396182078479*^9}, {3.452519825222014*^9, 
   3.452519828012539*^9}, {3.452520666490158*^9, 3.452520675425616*^9}, {
   3.452522645637096*^9, 3.45252265558288*^9}, {3.452526998355095*^9, 
   3.452527019526857*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"seamask", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"landmask", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}], ",", "1", 
       ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "genielat"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayPlot", "[", "seamask", "]"}]}], "Input",
 CellChangeTimes->{{3.451395846679725*^9, 3.451395933272345*^9}, {
  3.451396084194172*^9, 3.451396110953538*^9}, {3.452522661300798*^9, 
  3.452522674806638*^9}, {3.452522741846755*^9, 3.452522742162204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"masknames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<land and sea\>\"", ",", "\"\<land only\>\"", ",", 
     "\"\<sea only\>\""}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.451395945990579*^9, 3.451395961941272*^9}, {
  3.451396274684213*^9, 3.451396308268407*^9}, {3.452507939765367*^9, 
  3.452507943947111*^9}, {3.452507979067706*^9, 3.452507986826318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"readinalldata", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"netcdfdataall", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
           "\"\<d.nc\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", 
            RowBox[{"datanames", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "nruns"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1"}], 
         RowBox[{"(*", 
          RowBox[{"Length", "[", 
           RowBox[{"dimensions", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", 
          RowBox[{"nrealdata", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"yearsall", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
           "\"\<d.nc\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", "\"\<year\>\""}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "nruns"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1"}], 
         RowBox[{"(*", 
          RowBox[{"Length", "[", 
           RowBox[{"dimensions", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", 
          RowBox[{"nrealdata", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nnetcdfyears2all", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"netcdfdataall", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "m", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "nruns"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"netcdfdataall", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"netcdfdataall", "[", 
           RowBox[{"[", 
            RowBox[{
            "k", ",", "m", ",", "d", ",", "l", ",", "y", ",", "i", ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"j", "+", 
                RowBox[{"8", "*", 
                 RowBox[{"genielon", "/", "36"}]}]}], ",", "genielon", ",", 
               "1"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "nruns"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "1"}], 
           RowBox[{"(*", 
            RowBox[{"Length", "[", 
             RowBox[{"dimensions", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", 
            RowBox[{"nrealdata", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"nnetcdfyears2all", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "m"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "genielat"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\n", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"netcdfdataall", "[", 
            RowBox[{"[", 
             RowBox[{
             "k", ",", "m", ",", "d", ",", "l", ",", "y", ",", "i", ",", 
              "j"}], "]"}], "]"}], ">", "bignumber"}], ",", 
          RowBox[{
           RowBox[{"netcdfdataall", "[", 
            RowBox[{"[", 
             RowBox[{
             "k", ",", "m", ",", "d", ",", "l", ",", "y", ",", "i", ",", 
              "j"}], "]"}], "]"}], "=", "0"}]}], "]"}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nruns"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "1"}], 
        RowBox[{"(*", 
         RowBox[{"Length", "[", 
          RowBox[{"dimensions", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"nnetcdfyears2all", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "m"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "genielat"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"maxima", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"netcdfdataall", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "m", ",", "d", ",", "l", ",", "All"}], "]"}], 
          "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1"}], 
         RowBox[{"(*", 
          RowBox[{"Length", "[", 
           RowBox[{"dimensions", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", 
          RowBox[{"nrealdata", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"minima", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"netcdfdataall", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "m", ",", "d", ",", "l", ",", "All"}], "]"}], 
          "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "1"}], 
         RowBox[{"(*", 
          RowBox[{"Length", "[", 
           RowBox[{"dimensions", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", 
          RowBox[{"nrealdata", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
     ";"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.450609809774429*^9, 3.450609878278884*^9}, {
   3.450611091563655*^9, 3.450611102664148*^9}, 3.450611528780221*^9, 
   3.45061156699474*^9, 3.450778299891981*^9, 3.451912350126882*^9, {
   3.45191238917174*^9, 3.451912433353397*^9}, {3.451914193724967*^9, 
   3.451914195389262*^9}, {3.451915195192596*^9, 3.451915205179932*^9}, {
   3.451915475439996*^9, 3.451915483394053*^9}, 3.452430862202887*^9, {
   3.453718355474523*^9, 3.453718359787196*^9}, 3.453718657258718*^9, {
   3.453718980497409*^9, 3.453718981099053*^9}, {3.454240226709825*^9, 
   3.454240270555446*^9}, 3.454240377168421*^9, {3.454241230200508*^9, 
   3.454241233700007*^9}, {3.454241619325298*^9, 3.454241620554987*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TwoAxisPlotLats", "[", 
   RowBox[{"f_List", ",", "g_List", ",", 
    RowBox[{
     RowBox[{"(", "opts___", ")"}], "?", "OptionQ"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "old", ",", "new", ",", "scale", ",", "gmax", ",", "gmin", ",", "fmax", 
      ",", "fmin", ",", "newg", ",", "var"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"gmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "f", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"fmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "f", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"scale", "[", "var_", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"var", "-", "gmin"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"fmax", "-", "fmin"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gmax", "-", "gmin"}], "\[Equal]", "0."}], ",", 
          RowBox[{"fmax", "-", "fmin"}], ",", 
          RowBox[{"gmax", "-", "gmin"}]}], "]"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"old", "=", 
      RowBox[{
       RowBox[{"FullOptions", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"g", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"gmin", ",", "gmax"}], "}"}], ",", "Automatic"}], 
             "}"}]}], ",", 
           RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}], ",", 
         "FrameTicks"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Rest", "[", "#1", "]"}], ",", 
           RowBox[{"fmin", "+", 
            RowBox[{"scale", "[", 
             RowBox[{"First", "[", "#1", "]"}], "]"}]}]}], "]"}], "&"}], 
        ")"}], "/@", "old"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newg", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "g", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"fmin", "+", 
          RowBox[{"Map", "[", 
           RowBox[{"scale", ",", 
            RowBox[{
             RowBox[{"Transpose", "[", "g", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], "}"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "newg"}], "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], "]"}], 
          ",", "new", ",", "None"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Blue", "}"}], ",", 
          RowBox[{"{", "Orange", "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Blue", "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "Orange", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ",", "opts"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.451989927298582*^9, 3.451989928809999*^9}, {
   3.451989958928624*^9, 3.45198997913608*^9}, {3.451990022799751*^9, 
   3.451990051437392*^9}, {3.451990285247006*^9, 3.451990302756122*^9}, {
   3.45199075028666*^9, 3.45199075614516*^9}, 3.45199119943117*^9, {
   3.451991272658506*^9, 3.451991307742119*^9}, {3.45199137279675*^9, 
   3.451991382703586*^9}, {3.451991454645873*^9, 3.45199148042833*^9}, {
   3.451991609065679*^9, 3.451991626698045*^9}, {3.451993930857343*^9, 
   3.451993935364797*^9}, {3.451994608027352*^9, 3.451994617767793*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"module", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"v", "[", "n_Integer", "]"}], "]"}], ":=", 
   RowBox[{"\"\<v\>\"", "<>", 
    RowBox[{"ToString", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"v", ",", "nvar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Evaluate", "[", "list", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], "]"}], "-", "1"}], 
          ")"}], "*", "varmultipliers"}], "]"}], "+", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", "##"}], "]"}], "&"}], "@", 
  RowBox[{"(", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", 
              RowBox[{"vartitles", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"j", "\[Rule]", 
               RowBox[{"varvalues", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"nvars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "\"\<variable\>\""}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "->", 
             RowBox[{"datanames", "[", 
              RowBox[{"[", 
               RowBox[{"module", ",", "1", ",", "i"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nrealdata", "[", 
               RowBox[{"[", 
                RowBox[{"module", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"y", ",", "1", ",", "\"\<year\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"years1", "[", 
            RowBox[{"[", 
             RowBox[{"module", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nnetcdfyears", "[", 
             RowBox[{"[", "module", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}]}], "]"}]}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.450617805311666*^9, 3.450617831693424*^9}, {
   3.450617862512347*^9, 3.45061797478856*^9}, {3.450618289131166*^9, 
   3.450618290406129*^9}, {3.450619804129897*^9, 3.450619893762245*^9}, {
   3.450620857342329*^9, 3.450620904942704*^9}, {3.450620966006999*^9, 
   3.450620987541548*^9}, {3.450621143485906*^9, 3.450621201438056*^9}, {
   3.450621238574245*^9, 3.450621292222734*^9}, {3.450621331711951*^9, 
   3.450621398908891*^9}, {3.450621749885786*^9, 3.45062180205707*^9}, {
   3.450621853269466*^9, 3.450621875362082*^9}, {3.450622003424978*^9, 
   3.450622028572551*^9}, {3.450776516835569*^9, 3.450776519064637*^9}, {
   3.45077657356817*^9, 3.45077657726025*^9}, 3.450777895409333*^9, {
   3.45077874369911*^9, 3.450778789904501*^9}, {3.451312224185126*^9, 
   3.451312225204768*^9}, {3.451911119921753*^9, 3.451911160924822*^9}, {
   3.452866111384938*^9, 3.452866190058579*^9}, 3.452875385994555*^9, {
   3.454756722306907*^9, 3.454756726152277*^9}, {3.454756756238483*^9, 
   3.454756756803073*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["7 b. Individual graphs", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.451643580850363*^9, 3.451643593138852*^9}, {3.45243740052789*^9, 
   3.452437420207904*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{
      RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ensemblenos", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}], 
           ",", "v1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ensemblenos", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}], 
           ",", "v2"}], "]"}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ensemblenos", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}],
             ",", "v3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ensemblenos", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}],
             ",", "v4"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ensemblenos", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}],
             ",", "v5"}], "]"}], "]"}]}], "*)"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"netcdfdata1", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
         RowBox[{"runids", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
         RowBox[{"netcdfmodules", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
         RowBox[{"netcdfmodules", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
         RowBox[{"ToString", "[", 
          RowBox[{"dimensions", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
         "\"\<d.nc\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Datasets\>\"", ",", 
          RowBox[{"datanames", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], "]"}],
       "[", 
      RowBox[{"[", "y", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"d", "\[Equal]", "2"}], ",", 
      RowBox[{"netcdfdata2", "=", 
       RowBox[{"netcdfdata1", "[", 
        RowBox[{"[", "b", "]"}], "]"}]}], ",", 
      RowBox[{"netcdfdata2", "=", "netcdfdata1"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"netcdfdata3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"netcdfdata2", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"j", "+", 
             RowBox[{"8", "*", 
              RowBox[{"genielon", "/", "36"}]}]}], ",", "genielon", ",", 
            "1"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "genielat"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"netcdfdata4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata3", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "<", "bignumber"}], ",", 
         RowBox[{"netcdfdata3", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "0", ",", "0"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "genielat"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"chart", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{"netcdfdata4", ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", "800", "}"}]}], ",", 
       RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"StyleForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "v1"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "v2"}], "]"}], "]"}], 
           RowBox[{"(*", 
            RowBox[{"~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
           "\"\<: \>\"", "~~", 
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
           "\"\<: \>\"", "~~", "\"\<year: \>\"", "~~", 
           RowBox[{"ToString", "[", 
            RowBox[{"years1", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "y"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"legend", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", "800", "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{
         RowBox[{"longnames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
         "\"\< (\>\"", "~~", 
         RowBox[{"units", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
         "\"\<)\>\""}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"Min", "[", "netcdfdata4", "]"}], "+", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "netcdfdata4", "]"}], "-", 
                    RowBox[{"Min", "[", "netcdfdata4", "]"}]}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "100", ",", "10"}], "}"}]}], "]"}],
             ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "chart", "}"}], ",", 
       RowBox[{"{", "legend", "}"}]}], "}"}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "\"\<level\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nlevels"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "\"\<variable\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "->", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", "\"\<year\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"years1", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nnetcdfyears", "[", 
          RowBox[{"[", "m", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451904690667954*^9, 3.451904724436689*^9}, {
   3.451905748413416*^9, 3.451905761538444*^9}, {3.451905793054459*^9, 
   3.451905797664951*^9}, {3.451906615353841*^9, 3.451906641967217*^9}, {
   3.451906763708827*^9, 3.451906811731213*^9}, {3.451906862112333*^9, 
   3.451906975256681*^9}, 3.451907041712464*^9, {3.451907074188759*^9, 
   3.451907085035711*^9}, {3.451907144646903*^9, 3.451907148077466*^9}, 
   3.451907215918141*^9, {3.451907247193251*^9, 3.451907260573808*^9}, {
   3.451907298866304*^9, 3.451907301852639*^9}, {3.451907446751144*^9, 
   3.451907464901824*^9}, {3.451907585700777*^9, 3.451907587947188*^9}, 
   3.451911322287589*^9, {3.451911596042922*^9, 3.45191176792967*^9}, {
   3.451911825606143*^9, 3.451911859003392*^9}, 3.451912082621644*^9, {
   3.451912203356753*^9, 3.451912206403135*^9}, {3.451912543488776*^9, 
   3.45191256238585*^9}, {3.451915311113074*^9, 3.45191538179642*^9}, {
   3.451976583938813*^9, 3.451976600758172*^9}, {3.451976686076702*^9, 
   3.451976705036442*^9}, {3.451976761815172*^9, 3.451976774162069*^9}, {
   3.452868205412048*^9, 3.452868247566696*^9}, {3.452868292971577*^9, 
   3.45286829536006*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["7 c. Animations", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, 3.452437491924206*^9, 
   3.45371310913145*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], 
           RowBox[{"(*", 
            RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], "-", "1"}], ")"}], 
        "*", 
        RowBox[{"varmultipliers", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], 
           RowBox[{"(*", 
            RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
       "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"readinalldata", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", "netcdfdata"}], "}"}], "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
           "\"\<d.nc\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<year\>\"", ",", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nnetcdfyears2", "=", 
        RowBox[{"Length", "[", "years", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], ">", 
            "bignumber"}], ",", 
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "nnetcdfyears2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"netcdfdata", "=", 
        RowBox[{"netcdfdataall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m", ",", "d", ",", "l"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"years", "=", 
        RowBox[{"yearsall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m", ",", "d", ",", "l"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nnetcdfyears2", "=", 
        RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"maxima", "=", 
     RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minima", "=", 
     RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"charttable1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ArrayPlot", "[", 
        RowBox[{
         RowBox[{"netcdfdata", "[", 
          RowBox[{"[", "y", "]"}], "]"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", "800", "}"}]}], ",", 
         RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"minima", ",", "maxima"}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"StyleForm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"runids", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "v1"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "v2"}], "]"}], "]"}], 
             RowBox[{"(*", 
              RowBox[{"~~", "\"\<; \>\"", "~~", 
               RowBox[{"varvalues", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
               RowBox[{"varvalues", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
               RowBox[{"varvalues", "[", 
                RowBox[{"[", 
                 RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
             "\"\<: \>\"", "~~", 
             RowBox[{"datanames", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
             "\"\<: \>\"", "~~", "\"\<year: \>\"", "~~", 
             RowBox[{"ToString", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"legend", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", "800", "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{
         RowBox[{"longnames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
         "\"\< (\>\"", "~~", 
         RowBox[{"units", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
         "\"\<)\>\""}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"minima", "+", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"maxima", "-", "minima"}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "100", ",", "10"}], "}"}]}], "]"}],
             ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ListAnimate", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"charttable1", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "}"}], ",", 
           RowBox[{"{", "legend", "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nnetcdfyears2", "-", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}]}],
        "]"}], ",", 
      RowBox[{"DefaultDuration", "\[Rule]", 
       RowBox[{"1", "*", 
        RowBox[{"(", 
         RowBox[{"nnetcdfyears2", "-", 
          RowBox[{"netcdfstartyearnos", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", 
      RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
      RowBox[{"AnimatorElements", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ProgressSlider\>\"", ",", "\"\<PlayPauseButton\>\"", ",", 
         "\"\<StepLeftButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
         "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "\"\<output variable\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "->", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.454157091704364*^9, 
   3.454157092161808*^9}, {3.454157144732461*^9, 3.454157146774254*^9}, {
   3.454157179400602*^9, 3.454157196661886*^9}, {3.454157430964616*^9, 
   3.454157431680975*^9}, {3.454157592718028*^9, 3.454157593352722*^9}, {
   3.454160356504047*^9, 3.454160400111668*^9}, {3.454241509908916*^9, 
   3.454241539131968*^9}, {3.454241607771176*^9, 3.454241610621522*^9}, 
   3.454242532181829*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["7 d. Lat-time graphs", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, 3.452437491924206*^9, {
   3.45287998691112*^9, 3.452879989810667*^9}, 3.452881268505181*^9, {
   3.453713111050006*^9, 3.453713111113981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xlabdisp", "=", "10"}], ";", 
   RowBox[{"ylabdisp", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], 
           RowBox[{"(*", 
            RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], "-", "1"}], ")"}], 
        "*", 
        RowBox[{"varmultipliers", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], 
           RowBox[{"(*", 
            RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
       "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"readinalldata", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", "netcdfdata"}], "}"}], "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
           "\"\<d.nc\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<year\>\"", ",", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nnetcdfyears2", "=", 
        RowBox[{"Length", "[", "years", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], ">", 
            "bignumber"}], ",", 
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "nnetcdfyears2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"netcdfdata", "=", 
        RowBox[{"netcdfdataall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m", ",", "d", ",", "l"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"years", "=", 
        RowBox[{"yearsall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m", ",", "d", ",", "l"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nnetcdfyears2", "=", 
        RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"a", "\[NotEqual]", "1"}], ",", 
      RowBox[{"netcdfdatamask", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", "y", "]"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], "]"}],
           "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}]}], 
        "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"latdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "==", "1"}], ",", 
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"netcdfdatamask", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", "0"}], "]"}], 
               "\[Equal]", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"netcdfdatamask", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
             "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"genielatsused", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "genielat", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"netcdflattime", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"years", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"c", "==", "1"}], ",", "i", ",", 
             RowBox[{"genielatsused", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "nnetcdfyears2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"maxlattime", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"netcdflattime", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "netcdflattime", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minlattime", "=", 
     RowBox[{"Min", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"netcdflattime", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "netcdflattime", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"chart", "=", 
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"netcdflattime", ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", "800", "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"minlattime", ",", "maxlattime"}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"StyleForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "v1"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "v2"}], "]"}], "]"}], 
           RowBox[{"(*", 
            RowBox[{"~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
           "\"\<: \>\"", "~~", 
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<year\>\"", ",", "\"\<latitude\>\"", ",", "None", ",", "None"}], 
         "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"years", "[", 
                RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"y", ",", "xlabdisp", ",", "1"}], "]"}], "\[Equal]",
                  "1"}], ",", 
                RowBox[{"years", "[", 
                 RowBox[{"[", "y", "]"}], "]"}], ",", "\"\<\>\""}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "nnetcdfyears2"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"c", "==", "1"}], ",", "i", ",", 
                RowBox[{"genielatsused", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"i", ",", "ylabdisp", ",", "1"}], "]"}], "\[Equal]",
                  "1"}], ",", 
                RowBox[{"genielatsused", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<\>\""}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], ",", "Automatic",
           ",", "Automatic"}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"legend", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", "750", "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{
         RowBox[{"longnames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
         "\"\< (\>\"", "~~", 
         RowBox[{"units", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
         "\"\<)\>\""}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"None", ",", "\"\<   \>\"", ",", "None", ",", "None"}], 
         "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"minlattime", "+", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"maxlattime", "-", "minlattime"}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "100", ",", "10"}], "}"}]}], "]"}],
             ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "chart", "}"}], ",", 
       RowBox[{"{", "legend", "}"}]}], "}"}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "\"\<output variable\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "->", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "\"\<averaging mask\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<land and sea\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<land only\>\""}], ",", 
       RowBox[{"3", "\[Rule]", "\"\<sea only\>\""}]}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "\"\<latitude scale\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<equal area\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<equal angle\>\""}]}], "}"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.45288000237187*^9, 
   3.45288001211122*^9}, {3.452880044745977*^9, 3.452880088254287*^9}, {
   3.45288013316674*^9, 3.452880214379224*^9}, {3.452880258525025*^9, 
   3.452880266652339*^9}, {3.452880311953928*^9, 3.452880338740556*^9}, {
   3.452880482355288*^9, 3.452880500663345*^9}, {3.452880536721537*^9, 
   3.452880539226734*^9}, {3.452880571448163*^9, 3.452880631317861*^9}, {
   3.45288066187985*^9, 3.4528806710296*^9}, {3.452880925859753*^9, 
   3.452880986891219*^9}, {3.452881061469638*^9, 3.452881073212583*^9}, {
   3.452881118553436*^9, 3.452881128662809*^9}, 3.454160407436851*^9, 
   3.45416051900704*^9, {3.454242461028328*^9, 3.454242474385527*^9}, {
   3.454761425932701*^9, 3.454761427875343*^9}, {3.454761486074094*^9, 
   3.454761488328691*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["7 e. Animations with averaging", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, 3.452437491924206*^9, {
   3.45251710990585*^9, 3.45251711467841*^9}, {3.452872207285814*^9, 
   3.452872208405346*^9}, 3.452881276472808*^9, {3.45371311299243*^9, 
   3.453713113050017*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], 
           RowBox[{"(*", 
            RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], "-", "1"}], ")"}], 
        "*", 
        RowBox[{"varmultipliers", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], 
           RowBox[{"(*", 
            RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
       "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"readinalldata", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", "netcdfdata"}], "}"}], "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
           "\"\<d.nc\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<year\>\"", ",", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nnetcdfyears2", "=", 
        RowBox[{"Length", "[", "years", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], ">", 
            "bignumber"}], ",", 
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "nnetcdfyears2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"netcdfdata", "=", 
        RowBox[{"netcdfdataall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m", ",", "d", ",", "l"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"years", "=", 
        RowBox[{"yearsall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m", ",", "d", ",", "l"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nnetcdfyears2", "=", 
        RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"maxima", "=", 
     RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minima", "=", 
     RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"a", "\[NotEqual]", "1"}], ",", 
      RowBox[{"netcdfdatamask", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", "y", "]"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], "]"}],
           "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}]}], 
        "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"latdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "==", "1"}], ",", 
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"netcdfdatamask", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", "0"}], "]"}], 
               "\[Equal]", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"netcdfdatamask", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
             "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"genielatsused", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "genielat", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"latdatamax", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"latdata", "[", 
          RowBox[{"[", 
           RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"latdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"latdatamin", "=", 
     RowBox[{"Min", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"latdata", "[", 
          RowBox[{"[", 
           RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"latdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"charttable1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ArrayPlot", "[", 
          RowBox[{
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", "400", "}"}]}], ",", 
           RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
           RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"minima", ",", "maxima"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.1", "*", 
               RowBox[{"{", 
                RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", "400", "}"}]}], ",", " ", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", 
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], "]"}],
               ",", "None", ",", "None"}], "}"}]}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"legend", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", "420", "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"minima", "+", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"maxima", "-", "minima"}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "100", ",", "20"}], "}"}]}], "]"}],
             ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ListAnimate", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"varvalues", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "v1"}], "]"}], "]"}], "~~", "\"\<; \>\"",
                  "~~", 
                 RowBox[{"varvalues", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "v2"}], "]"}], "]"}], 
                 RowBox[{"(*", 
                  RowBox[{"~~", "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", 
                   "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", 
                   "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
                 "\"\<\\n\>\"", "~~", 
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                 "\"\<\\nyear \>\"", "~~", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"years", "[", 
                   RowBox[{"[", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                  "]"}], "~~", "\"\<\>\""}], ",", "Black", ",", "Bold", ",", 
                "25"}], "]"}], "]"}], ",", 
             RowBox[{"ListLogLinearPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"years", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], ",", 
                   RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", "0"}], "]"}],
                     "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", "0"}], 
                    "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"yy", ",", 
                   RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", "0.4"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"Axes", "\[Rule]", "False"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", "400", "}"}]}], ",", 
               RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                 "}"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                   "}"}], ",", "None"}], "}"}]}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<averages (\>\"", "~~", 
                 RowBox[{"masknames", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], "~~", 
                 "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"charttable1", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"legend", ",", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"longnames", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
               "\"\< (\>\"", "~~", 
               RowBox[{"units", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
               "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nnetcdfyears2", "-", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}]}],
        "]"}], ",", 
      RowBox[{"DefaultDuration", "\[Rule]", 
       RowBox[{"1", "*", 
        RowBox[{"(", 
         RowBox[{"nnetcdfyears2", "-", 
          RowBox[{"netcdfstartyearnos", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", 
      RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
      RowBox[{"Deployed", "->", "True"}], ",", 
      RowBox[{"AnimatorElements", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ProgressSlider\>\"", ",", "\"\<PlayPauseButton\>\"", ",", 
         "\"\<StepLeftButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
         "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "\"\<output variable\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "->", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "\"\<averaging mask\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<land and sea\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<land only\>\""}], ",", 
       RowBox[{"3", "\[Rule]", "\"\<sea only\>\""}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452517143854737*^9, 3.452517151285299*^9}, {3.452517326910662*^9, 
   3.452517343043067*^9}, {3.452517435845748*^9, 3.452517618704145*^9}, {
   3.452517670431836*^9, 3.452517672348421*^9}, {3.45251770235963*^9, 
   3.452517830471971*^9}, {3.452517863016951*^9, 3.452517887988689*^9}, {
   3.452517975496944*^9, 3.452518004019736*^9}, {3.452518081420271*^9, 
   3.452518083468248*^9}, {3.452518118422448*^9, 3.452518182854463*^9}, {
   3.452518224525839*^9, 3.452518250363717*^9}, {3.452518289084836*^9, 
   3.452518297103226*^9}, {3.452518343984723*^9, 3.45251835179313*^9}, {
   3.452518518203085*^9, 3.452518571785431*^9}, 3.452518658281728*^9, {
   3.452518708712104*^9, 3.452518710082306*^9}, {3.452518996034881*^9, 
   3.452518997806417*^9}, {3.452519090519996*^9, 3.452519096333159*^9}, {
   3.452519321096858*^9, 3.452519321751175*^9}, 3.452519376809717*^9, {
   3.452519669245811*^9, 3.452519671104056*^9}, {3.452520081885473*^9, 
   3.452520101981842*^9}, 3.452520152754518*^9, {3.452520279393203*^9, 
   3.45252028357465*^9}, {3.452520980548202*^9, 3.452520994557842*^9}, {
   3.452521123079144*^9, 3.4525211510415*^9}, {3.452521184236368*^9, 
   3.452521191972094*^9}, {3.45252128730401*^9, 3.452521303737177*^9}, {
   3.452521412228856*^9, 3.452521432801163*^9}, {3.452521821680554*^9, 
   3.452521834239233*^9}, 3.452522027256269*^9, {3.45252232193451*^9, 
   3.452522386321362*^9}, {3.452522448874468*^9, 3.452522475883618*^9}, {
   3.452522589387208*^9, 3.452522611531426*^9}, {3.452522788258136*^9, 
   3.452523022695191*^9}, 3.452523374323133*^9, {3.452866702242705*^9, 
   3.452866702966833*^9}, {3.452867128042157*^9, 3.45286720665029*^9}, 
   3.45286724124894*^9, {3.452867273894454*^9, 3.452867282336009*^9}, {
   3.452867814640477*^9, 3.452867831795984*^9}, 3.452867981521931*^9, {
   3.454159417265866*^9, 3.45415943290526*^9}, {3.454160443064289*^9, 
   3.454160446424553*^9}, 3.454160511461758*^9, {3.454242301301871*^9, 
   3.454242354047115*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["7 f. Animations with averaging and lat-time diagram", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, 3.452437491924206*^9, {
   3.45251710990585*^9, 3.45251711467841*^9}, {3.452872207285814*^9, 
   3.452872208405346*^9}, {3.452872459497185*^9, 3.452872467691351*^9}, 
   3.452881279641718*^9, 3.453713117202117*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xlabdisp", "=", "10"}], ";", 
   RowBox[{"ylabdisp", "=", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], 
           RowBox[{"(*", 
            RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], "-", "1"}], ")"}], 
        "*", 
        RowBox[{"varmultipliers", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], 
           RowBox[{"(*", 
            RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
       "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"readinalldata", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", "netcdfdata"}], "}"}], "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
           "\"\<d.nc\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<year\>\"", ",", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nnetcdfyears2", "=", 
        RowBox[{"Length", "[", "years", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], ">", 
            "bignumber"}], ",", 
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "nnetcdfyears2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"netcdfdata", "=", 
        RowBox[{"netcdfdataall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m", ",", "d", ",", "l"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"years", "=", 
        RowBox[{"yearsall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m", ",", "d", ",", "l"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nnetcdfyears2", "=", 
        RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"maxima", "=", 
     RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minima", "=", 
     RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"a", "\[NotEqual]", "1"}], ",", 
      RowBox[{"netcdfdatamask", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", "y", "]"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], "]"}],
           "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}]}], 
        "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"latdata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "==", "1"}], ",", 
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"netcdfdatamask", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", "0"}], "]"}], 
               "\[Equal]", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"netcdfdatamask", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
             "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"genielatsused", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "genielat", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"latdatamax", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"latdata", "[", 
          RowBox[{"[", 
           RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"latdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"latdatamin", "=", 
     RowBox[{"Min", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"latdata", "[", 
          RowBox[{"[", 
           RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"latdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"netcdflattime", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"years", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", "i", ",", 
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"netcdflattime", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", "maxima"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"netcdflattime", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], "=", "minima"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"charttable1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ArrayPlot", "[", 
          RowBox[{
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", "400", "}"}]}], ",", 
           RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
           RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}], 
           ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"minima", ",", "maxima"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.1", "*", 
               RowBox[{"{", 
                RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", "400", "}"}]}], ",", " ", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", 
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], "]"}],
               ",", "None", ",", "None"}], "}"}]}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"legend", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", "420", "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"minima", "+", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"maxima", "-", "minima"}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "100", ",", "20"}], "}"}]}], "]"}],
             ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ListAnimate", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"varvalues", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "v1"}], "]"}], "]"}], "~~", "\"\<; \>\"",
                  "~~", 
                 RowBox[{"varvalues", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "v2"}], "]"}], "]"}], 
                 RowBox[{"(*", 
                  RowBox[{"~~", "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", 
                   "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", 
                   "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
                 "\"\<     \>\"", "~~", 
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                 "\"\<     year \>\"", "~~", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"years", "[", 
                   RowBox[{"[", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                  "]"}], "~~", "\"\<\>\""}], ",", "Black", ",", "Bold", ",", 
                "25"}], "]"}], "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"charttable1", "[", 
              RowBox[{"[", 
               RowBox[{"y", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"ListLogLinearPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"years", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], ",", 
                   RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", "0"}], "]"}],
                     "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", "0"}], 
                    "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"yy", ",", 
                   RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", "0.45"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"Axes", "\[Rule]", "False"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", "400", "}"}]}], ",", 
               RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                 "}"}]}], ",", 
               RowBox[{"GridLines", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                   "}"}], ",", "None"}], "}"}]}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<averages (\>\"", "~~", 
                 RowBox[{"masknames", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], "~~", 
                 "\"\<):  latitudinal (top left), global (top right) and \
lat-time (bottom right)\>\""}], ",", "Black", ",", "Bold", ",", "15"}], "]"}],
               "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"charttable1", "[", 
              RowBox[{"[", 
               RowBox[{"y", ",", "1"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ListDensityPlot", "[", 
              RowBox[{"netcdflattime", ",", 
               RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", "400", "}"}]}], ",", 
               RowBox[{
               "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
               RowBox[{"Mesh", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Log", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                    "]"}], "}"}], ",", 
                  RowBox[{"{", "18", "}"}]}], "}"}]}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"minima", ",", "maxima"}], "}"}]}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"None", ",", "None", ",", "None", ",", "None"}], 
                 "}"}]}], ",", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"None", ",", "None"}], "}"}]}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<year\>\"", ",", "\"\<latitude\>\"", ",", "None", ",", 
                   "None"}], "}"}]}], ",", 
                RowBox[{"FrameTicks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"y", ",", "xlabdisp", ",", "1"}], "]"}], 
                    "\[Equal]", "1"}], ",", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", "\"\<\>\""}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", "nnetcdfyears2"}], "}"}]}], "]"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "ylabdisp", ",", "1"}], "]"}], 
                    "\[Equal]", "1"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<\>\""}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], ",", 
                   "Automatic", ",", "Automatic"}], "}"}]}]}], "*)"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"legend", ",", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"longnames", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
               "\"\< (\>\"", "~~", 
               RowBox[{"units", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
               "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nnetcdfyears2", "-", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}]}],
        "]"}], ",", 
      RowBox[{"DefaultDuration", "\[Rule]", 
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"nnetcdfyears2", "-", 
          RowBox[{"netcdfstartyearnos", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", 
      RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
      RowBox[{"Deployed", "->", "True"}], ",", 
      RowBox[{"AnimatorElements", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ProgressSlider\>\"", ",", "\"\<PlayPauseButton\>\"", ",", 
         "\"\<StepLeftButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
         "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", "1", ",", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "\"\<output variable\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "->", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "\"\<averaging mask\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<land and sea\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<land only\>\""}], ",", 
       RowBox[{"3", "\[Rule]", "\"\<sea only\>\""}]}], "}"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452517143854737*^9, 3.452517151285299*^9}, {3.452517326910662*^9, 
   3.452517343043067*^9}, {3.452517435845748*^9, 3.452517618704145*^9}, {
   3.452517670431836*^9, 3.452517672348421*^9}, {3.45251770235963*^9, 
   3.452517830471971*^9}, {3.452517863016951*^9, 3.452517887988689*^9}, {
   3.452517975496944*^9, 3.452518004019736*^9}, {3.452518081420271*^9, 
   3.452518083468248*^9}, {3.452518118422448*^9, 3.452518182854463*^9}, {
   3.452518224525839*^9, 3.452518250363717*^9}, {3.452518289084836*^9, 
   3.452518297103226*^9}, {3.452518343984723*^9, 3.45251835179313*^9}, {
   3.452518518203085*^9, 3.452518571785431*^9}, 3.452518658281728*^9, {
   3.452518708712104*^9, 3.452518710082306*^9}, {3.452518996034881*^9, 
   3.452518997806417*^9}, {3.452519090519996*^9, 3.452519096333159*^9}, {
   3.452519321096858*^9, 3.452519321751175*^9}, 3.452519376809717*^9, {
   3.452519669245811*^9, 3.452519671104056*^9}, {3.452520081885473*^9, 
   3.452520101981842*^9}, 3.452520152754518*^9, {3.452520279393203*^9, 
   3.45252028357465*^9}, {3.452520980548202*^9, 3.452520994557842*^9}, {
   3.452521123079144*^9, 3.4525211510415*^9}, {3.452521184236368*^9, 
   3.452521191972094*^9}, {3.45252128730401*^9, 3.452521303737177*^9}, {
   3.452521412228856*^9, 3.452521432801163*^9}, {3.452521821680554*^9, 
   3.452521834239233*^9}, 3.452522027256269*^9, {3.45252232193451*^9, 
   3.452522386321362*^9}, {3.452522448874468*^9, 3.452522475883618*^9}, {
   3.452522589387208*^9, 3.452522611531426*^9}, {3.452522788258136*^9, 
   3.452523022695191*^9}, 3.452523374323133*^9, {3.452866702242705*^9, 
   3.452866702966833*^9}, {3.452867128042157*^9, 3.45286720665029*^9}, 
   3.45286724124894*^9, {3.452867273894454*^9, 3.452867282336009*^9}, {
   3.452867814640477*^9, 3.452867831795984*^9}, 3.452867981521931*^9, {
   3.452875567135647*^9, 3.452875646582428*^9}, {3.452875696085545*^9, 
   3.452875725658606*^9}, {3.452875770486485*^9, 3.452875788441097*^9}, {
   3.452875849212131*^9, 3.452875883482761*^9}, 3.452875915765095*^9, {
   3.452876432434741*^9, 3.452876434078327*^9}, {3.452876773464574*^9, 
   3.452876845523275*^9}, 3.45287692970975*^9, 3.452877163190587*^9, {
   3.452879420439368*^9, 3.452879460715637*^9}, {3.454159529718518*^9, 
   3.454159545186762*^9}, 3.454160457753366*^9, 3.454160504601693*^9, {
   3.454241676691394*^9, 3.454241678970742*^9}, {3.454241930883652*^9, 
   3.454242070950815*^9}, {3.454242154475921*^9, 3.454242198216564*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["7 g. Comparisons - single axis lat. plot", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, {3.452437493594726*^9, 
   3.452437501081405*^9}, 3.452517119361092*^9, 3.452872469640272*^9, 
   3.452881281314605*^9, {3.453028621937058*^9, 3.453028635211006*^9}, 
   3.45371311946796*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vs", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ks", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"o", ",", "v1"}], 
                RowBox[{"(*", 
                 RowBox[{",", "v2", ",", "v3"}], "*)"}], "}"}], "-", "1"}], 
              ")"}], "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", 
                 RowBox[{"vs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"varmultipliers", "[", 
                 RowBox[{"[", 
                  RowBox[{"vs", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"varmultipliers", "[", 
                 RowBox[{"[", 
                  RowBox[{"vs", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "*)"}], 
              "}"}]}], "]"}], "+", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", "netcdfdata"}], "}"}], "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
           "\"\<d.nc\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<year\>\"", ",", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"readinalldata", "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", 
                  RowBox[{"ks", "[", 
                   RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                "\"\</\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"ToString", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                "\"\<d.nc\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", 
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"years", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", 
                  RowBox[{"ks", "[", 
                   RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                "\"\</\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"ToString", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                "\"\<d.nc\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", "\"\<year\>\""}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nnetcdfyears2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"netcdfdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
                "<", "bignumber"}], ",", 
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
               ",", "0", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"nnetcdfyears2", "[", 
                RowBox[{"[", "o", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "genielat"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"netcdfdataall", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
                "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"years", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"yearsall", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
                "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nnetcdfyears2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"minyear", "=", 
        RowBox[{"Min", "[", "nnetcdfyears2", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"maxima", "=", 
        RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"minima", "=", 
        RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"netcdfdatadiff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "y"}], "]"}], "]"}], "-", 
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "y"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"netcdfdatamask", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
               "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}], 
            "]"}]}], ";", 
          RowBox[{"netcdfdatadiffmask", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdatadiff", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
               "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}]}], "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"latdata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "==", "1"}], ",", 
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    "0"}], "]"}], "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "0.", "}"}], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                   "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"genielatsused", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "genielat", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"latdatamax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdata", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"latdatamin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdata", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"charttable", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                   RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o"}], 
                    "]"}], "]"}]}], "}"}], "[", 
                 RowBox[{"[", "x", "]"}], "]"}], ",", 
                RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "300", "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}], ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}]}], 
                   "}"}], "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}], ",", 
                RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
                   "}"}], "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "2"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"latdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.1", "*", 
                  RowBox[{"{", 
                   RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", "250", "}"}]}], ",", " ", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                  "]"}], ",", "None", ",", "None"}], "}"}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", "Blue", "}"}], "}"}]}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "Blue", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"legend", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ArrayPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], 
            ",", 
            RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", "320", "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"None", ",", "None"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "+", 
                    RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"maxima", ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}]}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", "100", ",", "50"}], "}"}]}], 
                  "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"ColorFunction", "\[Rule]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
               "}"}], "[", 
              RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Animate", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "v1"}], "]"}], "]"}], 
                    RowBox[{"(*", 
                    RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "v2"}], "]"}], "]"}],
                     "~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "v3"}], "]"}], 
                    "]"}]}], "*)"}], "~~", "\"\<\\n\>\""}], ",", "Black", ",",
                     "Bold", ",", "20"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\< (\>\"", "~~", 
                    RowBox[{"units", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\<)\>\"", "~~", "\"\<\\n\>\""}], ",", "Green", ",", 
                    "Bold", ",", "20"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                   "\"\<year \>\"", ",", "Black", ",", "Bold", ",", "20"}], 
                   "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "]"}], "~~", "\"\<\\n \>\""}], ",", "Red", ",", 
                    "Bold", ",", "20"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
              "SpanFromLeft", ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                  "]"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
                RowBox[{"AspectRatio", "\[Rule]", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"2.5", "*", "GoldenRatio"}], ")"}]}]}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "580", "}"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorFunction\>\""}], "]"}], "[", 
                    "o", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
               "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"vartitles", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", "Black", ",", "Bold", 
                 ",", "15"}], "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<data\>\"", ",", "Blue", ",", "Bold", ",", "15"}],
                 "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<difference from baseline\>\"", ",", "Orange", ",", 
                 "Bold", ",", "15"}], "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<averages (\>\"", "~~", 
                  RowBox[{"masknames", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "~~", 
                  "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                 "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorFunction\>\""}], "]"}], "[", 
                    "o", "]"}], ",", "Bold", ",", "15"}], "]"}], "]"}], ",", 
                 RowBox[{"charttable", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "o", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"charttable", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "o", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"charttable", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "o", ",", "3"}], "]"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"o", ",", 
                 RowBox[{"nvars", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", 
              RowBox[{"legend", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"legend", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"longnames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                "\"\< (\>\"", "~~", 
                RowBox[{"units", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"1", "+", "minyear", "-", 
                RowBox[{"netcdfstartyearnos", "[", 
                 RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
         RowBox[{"DefaultDuration", "\[Rule]", 
          RowBox[{"3", "*", 
           RowBox[{"(", 
            RowBox[{"minyear", "-", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{"Deployed", "->", "True"}], ",", 
         RowBox[{"AnimatorElements", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ProgressSlider\>\"", ",", "\"\<PlayPauseButton\>\"", ",", 
            "\"\<StepLeftButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
            "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "1", ",", 
          RowBox[{"vartitles", "[", 
           RowBox[{"[", 
            RowBox[{"vs", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"vs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v2", ",", "1", ",", 
            RowBox[{"vartitles", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"vs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v3", ",", "1", ",", 
            RowBox[{"vartitles", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"vs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "\"\<ouput variable\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "->", 
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nrealdata", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "\"\<averaging mask\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<land and sea\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<land only\>\""}], ",", 
          RowBox[{"3", "\[Rule]", "\"\<sea only\>\""}]}], "}"}]}], "}"}]}], 
     "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "\"\<input variable to compare\>\""}], 
      "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"vartitles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.451309414063614*^9, 3.451309510953402*^9}, {
   3.451309598429776*^9, 3.451309617982269*^9}, {3.451309653586308*^9, 
   3.451309711282247*^9}, {3.451309749128101*^9, 3.451309793567101*^9}, {
   3.451309836455378*^9, 3.451309910414605*^9}, {3.451309995122858*^9, 
   3.451309995634495*^9}, {3.451310107240489*^9, 3.451310118200808*^9}, {
   3.451310263595197*^9, 3.451310298589516*^9}, {3.451310352746823*^9, 
   3.451310363895307*^9}, {3.451310667931386*^9, 3.451310671739929*^9}, {
   3.451310707382622*^9, 3.451310714106381*^9}, {3.451310759527926*^9, 
   3.451310833851115*^9}, {3.451310982642042*^9, 3.451310990694074*^9}, {
   3.451311024067461*^9, 3.451311081329015*^9}, {3.4513111189078*^9, 
   3.45131113642092*^9}, {3.451311224759491*^9, 3.451311279775746*^9}, {
   3.451311318294668*^9, 3.451311348478362*^9}, {3.451311398117511*^9, 
   3.451311454531801*^9}, {3.451311496114145*^9, 3.451311498176133*^9}, {
   3.451311640257272*^9, 3.451311660215968*^9}, {3.451311694177867*^9, 
   3.451311711164252*^9}, {3.45131175116227*^9, 3.451311752485016*^9}, {
   3.451313579962296*^9, 3.451313636277235*^9}, {3.451313679020449*^9, 
   3.451313691487033*^9}, {3.451313871574938*^9, 3.451313897551419*^9}, {
   3.451314206172668*^9, 3.451314316531118*^9}, {3.451314357981735*^9, 
   3.451314365131501*^9}, {3.451314902903805*^9, 3.451314905268507*^9}, {
   3.451314967152302*^9, 3.451314995104364*^9}, {3.451315039281391*^9, 
   3.451315048581954*^9}, 3.451315197868634*^9, {3.45131538633679*^9, 
   3.45131542980099*^9}, {3.451315464795057*^9, 3.45131550981672*^9}, 
   3.451316538607953*^9, {3.451316638193289*^9, 3.451316642188428*^9}, {
   3.451316795427204*^9, 3.451316847434473*^9}, {3.451316879051845*^9, 
   3.451316886580526*^9}, {3.451317309566329*^9, 3.451317312431387*^9}, 
   3.451317554757759*^9, 3.451317592538065*^9, {3.451317766416519*^9, 
   3.451317820963029*^9}, {3.451318242914377*^9, 3.451318302140006*^9}, {
   3.451318401680405*^9, 3.451318403092815*^9}, {3.451318441142556*^9, 
   3.451318448573037*^9}, {3.451318556738251*^9, 3.451318561137216*^9}, {
   3.451318599102434*^9, 3.451318601739819*^9}, {3.451318648875968*^9, 
   3.451318649405384*^9}, {3.451318705395783*^9, 3.451318711549563*^9}, {
   3.451318770977006*^9, 3.451318793524523*^9}, 3.451318864492731*^9, {
   3.451319244390798*^9, 3.451319264365819*^9}, {3.451319318521038*^9, 
   3.451319337644956*^9}, {3.451319616129108*^9, 3.45131964005324*^9}, {
   3.451319750454747*^9, 3.451319799920457*^9}, 3.451319966581215*^9, {
   3.451320034520368*^9, 3.451320105005765*^9}, {3.451320148547304*^9, 
   3.451320182723257*^9}, {3.451320322596859*^9, 3.451320324136073*^9}, {
   3.451320355000828*^9, 3.451320367290092*^9}, {3.451320462584922*^9, 
   3.451320607768713*^9}, {3.451320644145333*^9, 3.451320645057535*^9}, 
   3.451320709097728*^9, {3.451320853572097*^9, 3.451320880953523*^9}, {
   3.451320920612531*^9, 3.451320929035824*^9}, {3.451321106362252*^9, 
   3.451321114203757*^9}, {3.451321224949722*^9, 3.451321257649179*^9}, {
   3.451321289906261*^9, 3.451321315943128*^9}, {3.451321358474275*^9, 
   3.451321417904009*^9}, {3.451321476196101*^9, 3.45132147824559*^9}, {
   3.451321516120502*^9, 3.451321573243551*^9}, {3.451321606695263*^9, 
   3.451321632575289*^9}, {3.451321741300334*^9, 3.451321770392265*^9}, {
   3.451321827183165*^9, 3.451321922843863*^9}, {3.451322652668481*^9, 
   3.451322656754155*^9}, 3.451322833574135*^9, {3.451322994084517*^9, 
   3.451323012545414*^9}, {3.45132312114273*^9, 3.451323146105642*^9}, {
   3.451323288539846*^9, 3.45132328992975*^9}, {3.45132448325616*^9, 
   3.45132448635961*^9}, {3.451325089425001*^9, 3.451325092521304*^9}, {
   3.451325146162206*^9, 3.45132514972307*^9}, {3.45132519594461*^9, 
   3.451325202186891*^9}, {3.45132526511031*^9, 3.451325293677654*^9}, 
   3.451325343690432*^9, {3.451325392316297*^9, 3.451325395164651*^9}, {
   3.451325513829516*^9, 3.451325515266582*^9}, {3.451393442241178*^9, 
   3.451393506447486*^9}, {3.451393557764741*^9, 3.451393565046171*^9}, {
   3.451393609055195*^9, 3.451393609976013*^9}, {3.451393694866458*^9, 
   3.451393783613338*^9}, {3.451394455023012*^9, 3.451394505395391*^9}, {
   3.451394538615529*^9, 3.451394575390954*^9}, {3.451394731067636*^9, 
   3.451394732057475*^9}, {3.45139496975802*^9, 3.451394971425963*^9}, {
   3.451395150115611*^9, 3.451395151672244*^9}, {3.451396364038903*^9, 
   3.451396373438163*^9}, {3.451396411511585*^9, 3.451396419664153*^9}, {
   3.451396476411971*^9, 3.451396509040744*^9}, 3.451396591783289*^9, {
   3.451396710766448*^9, 3.451396727269069*^9}, {3.451396774084481*^9, 
   3.451396781147268*^9}, {3.451396879289884*^9, 3.451396909709573*^9}, 
   3.451397017291325*^9, 3.451397096516548*^9, {3.451397283700373*^9, 
   3.451397295391855*^9}, {3.451647565188702*^9, 3.451647576756286*^9}, {
   3.451647765201499*^9, 3.451647772286258*^9}, {3.451914552198961*^9, 
   3.451914553827636*^9}, {3.451977035415851*^9, 3.451977064648639*^9}, {
   3.451977218605545*^9, 3.451977309760787*^9}, {3.451977341425075*^9, 
   3.451977349656208*^9}, {3.451977415194409*^9, 3.451977438602567*^9}, {
   3.451977482234568*^9, 3.451977570335019*^9}, {3.451977685801143*^9, 
   3.451977730398402*^9}, {3.451977801010382*^9, 3.4519778131909*^9}, {
   3.451977927635835*^9, 3.451977946193233*^9}, {3.451977981580003*^9, 
   3.451978074914122*^9}, {3.451978573909292*^9, 3.451978613295869*^9}, 
   3.451979137567778*^9, {3.451979475608387*^9, 3.451979484427895*^9}, 
   3.451980802501036*^9, 3.451980841444482*^9, 3.451982944421107*^9, {
   3.451983049108007*^9, 3.451983050808983*^9}, 3.451986546188676*^9, 
   3.451991829776616*^9, 3.451991874165471*^9, 3.451993157779084*^9, 
   3.451994167702954*^9, {3.451994664709835*^9, 3.451994670751077*^9}, 
   3.451994779744119*^9, {3.452348282351801*^9, 3.452348305948626*^9}, {
   3.452348863877905*^9, 3.452348871593252*^9}, {3.452348929645624*^9, 
   3.452349093005576*^9}, 3.452349163354316*^9, {3.452349358879036*^9, 
   3.452349368717949*^9}, {3.452359212814083*^9, 3.452359244996783*^9}, 
   3.452359287480445*^9, {3.452359641842327*^9, 3.452359645761994*^9}, {
   3.452429188587701*^9, 3.452429253893454*^9}, {3.452429423136294*^9, 
   3.452429431757532*^9}, {3.452429844069095*^9, 3.45242989490154*^9}, {
   3.452430820875636*^9, 3.452430826647256*^9}, {3.45243194133154*^9, 
   3.45243199971685*^9}, {3.452432043776312*^9, 3.452432127756735*^9}, {
   3.45243359203066*^9, 3.452433593100255*^9}, {3.452435358833192*^9, 
   3.452435442003799*^9}, {3.452435605467979*^9, 3.452435611527364*^9}, {
   3.452436748418093*^9, 3.452436792321338*^9}, {3.452436848805842*^9, 
   3.452436874257032*^9}, {3.452436961431523*^9, 3.452436978283443*^9}, {
   3.452503093412571*^9, 3.452503110464109*^9}, {3.452503146109683*^9, 
   3.452503157461646*^9}, {3.452503284626043*^9, 3.452503319379188*^9}, {
   3.452503352427569*^9, 3.452503368013224*^9}, {3.452503404948382*^9, 
   3.452503453564687*^9}, {3.452503486553225*^9, 3.452503531854947*^9}, 
   3.452503593452378*^9, {3.452503631002014*^9, 3.452503670452252*^9}, {
   3.452503782998762*^9, 3.452503784981463*^9}, {3.452503879248304*^9, 
   3.452503957728077*^9}, {3.452504506990491*^9, 3.452504507636656*^9}, 
   3.452504792261655*^9, {3.452506674608892*^9, 3.452506720642256*^9}, {
   3.45250675276557*^9, 3.452506767789893*^9}, {3.452506829889426*^9, 
   3.452506873011254*^9}, 3.45250691472205*^9, {3.45250777098386*^9, 
   3.452507842638114*^9}, {3.452507916052414*^9, 3.452507917064661*^9}, {
   3.452508015620077*^9, 3.452508030439877*^9}, {3.45250807995802*^9, 
   3.452508296606786*^9}, 3.452508423384269*^9, {3.452514915342416*^9, 
   3.452514938156737*^9}, 3.452514979606844*^9, {3.452515039060203*^9, 
   3.452515069780996*^9}, {3.452515145261898*^9, 3.452515148942493*^9}, {
   3.452515376042645*^9, 3.452515387199572*^9}, {3.452515469981488*^9, 
   3.452515514019583*^9}, {3.452515597592275*^9, 3.4525155997104*^9}, 
   3.452515643257802*^9, {3.452515684269518*^9, 3.45251569746131*^9}, {
   3.452516337832653*^9, 3.4525163492042*^9}, 3.452516386477176*^9, {
   3.452516417636282*^9, 3.452516424228562*^9}, 3.45251648528596*^9, {
   3.452519113447012*^9, 3.452519115411517*^9}, {3.452523118552426*^9, 
   3.45252319631394*^9}, {3.452523273539466*^9, 3.452523364761584*^9}, {
   3.452523474002623*^9, 3.452523552913832*^9}, {3.452523670432908*^9, 
   3.45252373309401*^9}, {3.452524093638799*^9, 3.452524095723497*^9}, {
   3.452524499403295*^9, 3.452524509725414*^9}, {3.452524651780485*^9, 
   3.452524677538398*^9}, {3.452524806900699*^9, 3.452524835424355*^9}, 
   3.452524915726926*^9, {3.452525073385259*^9, 3.452525074583793*^9}, {
   3.452868342677113*^9, 3.452868424347162*^9}, {3.452868473643052*^9, 
   3.452868509373667*^9}, 3.453026354854609*^9, {3.453028646063574*^9, 
   3.453028704708974*^9}, 3.453029469704161*^9, {3.453049977288517*^9, 
   3.453050003003448*^9}, {3.453050055734805*^9, 3.453050058306759*^9}, {
   3.454160173640182*^9, 3.45416019350575*^9}, {3.454160543122427*^9, 
   3.454160544532884*^9}, 3.454241200950289*^9, {3.454242017600466*^9, 
   3.454242021654102*^9}, {3.454761292322582*^9, 3.454761293003883*^9}, 
   3.454761557470408*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", "3"}], ";", 
  RowBox[{"d", "=", 
   RowBox[{"l", "=", 
    RowBox[{"o", "=", 
     RowBox[{"n", "=", "1"}]}]}]}], ";", 
  RowBox[{"y", "=", "10"}], ";", 
  RowBox[{"v1", "=", 
   RowBox[{"v2", "=", 
    RowBox[{"v3", "=", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.452516694185126*^9, 3.452516704312651*^9}, {
  3.452516752555135*^9, 3.452516756985015*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["7 h. Comparisons", "Subsubtitle",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, {3.452437493594726*^9, 
   3.452437501081405*^9}, 3.452517119361092*^9, 3.452872469640272*^9, 
   3.452881281314605*^9, 3.45305012616205*^9, 3.453713121361555*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vs", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ks", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"o", ",", "v1"}], 
                RowBox[{"(*", 
                 RowBox[{",", "v2", ",", "v3"}], "*)"}], "}"}], "-", "1"}], 
              ")"}], "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", 
                 RowBox[{"vs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"varmultipliers", "[", 
                 RowBox[{"[", 
                  RowBox[{"vs", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"varmultipliers", "[", 
                 RowBox[{"[", 
                  RowBox[{"vs", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "*)"}], 
              "}"}]}], "]"}], "+", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"readinalldata", "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", 
                  RowBox[{"ks", "[", 
                   RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                "\"\</\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"ToString", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                "\"\<d.nc\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", 
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"years", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", 
                  RowBox[{"ks", "[", 
                   RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                "\"\</\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"ToString", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                "\"\<d.nc\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", "\"\<year\>\""}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nnetcdfyears2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"netcdfdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
                "<", "bignumber"}], ",", 
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
               ",", "0", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"nnetcdfyears2", "[", 
                RowBox[{"[", "o", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "genielat"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"netcdfdataall", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
                "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"years", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"yearsall", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
                "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nnetcdfyears2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"minyear", "=", 
        RowBox[{"Min", "[", "nnetcdfyears2", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"maxima", "=", 
        RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"minima", "=", 
        RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"netcdfdatadiff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "y"}], "]"}], "]"}], "-", 
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "y"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"netcdfdatamask", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
               "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}], 
            "]"}]}], ";", 
          RowBox[{"netcdfdatadiffmask", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdatadiff", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
               "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}]}], "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"latdata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "==", "1"}], ",", 
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    "0"}], "]"}], "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "0.", "}"}], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                   "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"genielatsused", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "genielat", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"latdatadiff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "==", "1"}], ",", 
               RowBox[{"netcdfdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"y", "-", 
                   RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",",
                   "i"}], "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",",
                     "i"}], "]"}], "]"}], ",", "0"}], "]"}], "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "0.", "}"}], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",",
                     "i"}], "]"}], "]"}], ",", "0"}], "]"}]}], "]"}]}], "]"}],
              "]"}], ",", 
            RowBox[{"genielatsused", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "genielat", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"latdatamax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdata", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"latdatamin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdata", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"latdatadiffmax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdatadiff", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"latdatadiffmin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdatadiff", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"old", "=", 
        RowBox[{
         RowBox[{"FullOptions", "[", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"latdatamin", ",", "latdatamax"}], "}"}], ",", 
                "Automatic"}], "}"}]}], ",", 
             RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}], ",",
            "FrameTicks"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"new", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Rest", "[", "#1", "]"}], ",", 
             RowBox[{"latdatamin", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "-", "latdatadiffmin"}],
                   ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"latdatamax", "-", "latdatamin"}], ")"}]}], ")"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                   "\[Equal]", "0."}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "==", "0."}], 
                    ",", "1", ",", 
                    RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], ",", 
                  RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], "]"}], 
                ")"}]}]}]}], "]"}], "&"}], ")"}], "/@", "old"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newlatdatadiff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"latdatamin", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "-", "latdatadiffmin"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"latdatamax", "-", "latdatamin"}], ")"}]}], ")"}],
                  "/", 
                 RowBox[{"(", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                    "\[Equal]", "0."}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "==", "0."}], 
                    ",", "1", ",", 
                    RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], ",", 
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], 
                   "]"}], ")"}]}]}], "&"}], "/@", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"latdatadiff", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"latdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"charttable", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                   RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o"}], 
                    "]"}], "]"}]}], "}"}], "[", 
                 RowBox[{"[", "x", "]"}], "]"}], ",", 
                RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "300", "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}], ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}]}], 
                   "}"}], "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}], ",", 
                RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
                   "}"}], "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "2"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"latdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "o"}], "]"}], "]"}], ",", 
                RowBox[{"newlatdatadiff", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "o"}], "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.1", "*", 
                  RowBox[{"{", 
                   RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", "250", "}"}]}], ",", " ", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                  "]"}], ",", "new", ",", "None"}], "}"}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "Blue", "}"}], ",", 
                 RowBox[{"{", "Orange", "}"}]}], "}"}]}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "Blue", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "Orange", "}"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"legend", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ArrayPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], 
            ",", 
            RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", "320", "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"None", ",", "None"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "+", 
                    RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"maxima", ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}]}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", "100", ",", "50"}], "}"}]}], 
                  "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"ColorFunction", "\[Rule]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
               "}"}], "[", 
              RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ListAnimate", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Grid", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "v1"}], "]"}], "]"}], 
                    RowBox[{"(*", 
                    RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "v2"}], "]"}], "]"}],
                     "~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "v3"}], "]"}], 
                    "]"}]}], "*)"}], "~~", "\"\<\\n\>\""}], ",", "Black", ",",
                     "Bold", ",", "20"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\< (\>\"", "~~", 
                    RowBox[{"units", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\<)\>\"", "~~", "\"\<\\n\>\""}], ",", "Green", ",", 
                    "Bold", ",", "20"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<year \>\"", ",", "Black", ",", "Bold", ",", "20"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "]"}], "~~", "\"\<\\n \>\""}], ",", "Red", ",", 
                    "Bold", ",", "20"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                "SpanFromLeft", ",", 
                RowBox[{"ListLogLinearPlot", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                    "]"}], ",", 
                  RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                  RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
                  RowBox[{"AspectRatio", "\[Rule]", 
                   RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2.5", "*", "GoldenRatio"}], ")"}]}]}], ",", 
                  RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", "580", "}"}]}], ",", 
                  RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                  RowBox[{"FrameLabel", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                    "}"}]}], ",", 
                  RowBox[{"GridLines", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorFunction\>\""}], "]"}], "[", 
                    "o", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "Black", ",", "Bold",
                    ",", "15"}], "]"}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<data\>\"", ",", "Blue", ",", "Bold", ",", "15"}], 
                  "]"}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<difference from baseline\>\"", ",", "Orange", ",", 
                   "Bold", ",", "15"}], "]"}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"\"\<averages (\>\"", "~~", 
                    RowBox[{"masknames", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "~~", 
                    "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                   "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"3", ",", "\"\<ColorFunction\>\""}], "]"}], "[", 
                    "o", "]"}], ",", "Bold", ",", "15"}], "]"}], "]"}], ",", 
                   RowBox[{"charttable", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"charttable", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"charttable", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o", ",", "3"}], "]"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"o", ",", 
                   RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<\>\"", ",", 
                RowBox[{"legend", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"legend", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"longnames", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                  "\"\< (\>\"", "~~", 
                  RowBox[{"units", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                  "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"1", "+", "minyear", "-", 
                  RowBox[{"netcdfstartyearnos", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
         RowBox[{"DefaultDuration", "\[Rule]", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"minyear", "-", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{"Deployed", "->", "True"}], ",", 
         RowBox[{"AnimatorElements", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ProgressSlider\>\"", ",", "\"\<PlayPauseButton\>\"", ",", 
            "\"\<StepLeftButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
            "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "1", ",", 
          RowBox[{"vartitles", "[", 
           RowBox[{"[", 
            RowBox[{"vs", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"vs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v2", ",", "1", ",", 
            RowBox[{"vartitles", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"vs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v3", ",", "1", ",", 
            RowBox[{"vartitles", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"vs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "\"\<ouput variable\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "->", 
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nrealdata", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "\"\<averaging mask\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<land and sea\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<land only\>\""}], ",", 
          RowBox[{"3", "\[Rule]", "\"\<sea only\>\""}]}], "}"}]}], "}"}]}], 
     "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "\"\<input variable to compare\>\""}], 
      "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"vartitles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.451309414063614*^9, 3.451309510953402*^9}, {
   3.451309598429776*^9, 3.451309617982269*^9}, {3.451309653586308*^9, 
   3.451309711282247*^9}, {3.451309749128101*^9, 3.451309793567101*^9}, {
   3.451309836455378*^9, 3.451309910414605*^9}, {3.451309995122858*^9, 
   3.451309995634495*^9}, {3.451310107240489*^9, 3.451310118200808*^9}, {
   3.451310263595197*^9, 3.451310298589516*^9}, {3.451310352746823*^9, 
   3.451310363895307*^9}, {3.451310667931386*^9, 3.451310671739929*^9}, {
   3.451310707382622*^9, 3.451310714106381*^9}, {3.451310759527926*^9, 
   3.451310833851115*^9}, {3.451310982642042*^9, 3.451310990694074*^9}, {
   3.451311024067461*^9, 3.451311081329015*^9}, {3.4513111189078*^9, 
   3.45131113642092*^9}, {3.451311224759491*^9, 3.451311279775746*^9}, {
   3.451311318294668*^9, 3.451311348478362*^9}, {3.451311398117511*^9, 
   3.451311454531801*^9}, {3.451311496114145*^9, 3.451311498176133*^9}, {
   3.451311640257272*^9, 3.451311660215968*^9}, {3.451311694177867*^9, 
   3.451311711164252*^9}, {3.45131175116227*^9, 3.451311752485016*^9}, {
   3.451313579962296*^9, 3.451313636277235*^9}, {3.451313679020449*^9, 
   3.451313691487033*^9}, {3.451313871574938*^9, 3.451313897551419*^9}, {
   3.451314206172668*^9, 3.451314316531118*^9}, {3.451314357981735*^9, 
   3.451314365131501*^9}, {3.451314902903805*^9, 3.451314905268507*^9}, {
   3.451314967152302*^9, 3.451314995104364*^9}, {3.451315039281391*^9, 
   3.451315048581954*^9}, 3.451315197868634*^9, {3.45131538633679*^9, 
   3.45131542980099*^9}, {3.451315464795057*^9, 3.45131550981672*^9}, 
   3.451316538607953*^9, {3.451316638193289*^9, 3.451316642188428*^9}, {
   3.451316795427204*^9, 3.451316847434473*^9}, {3.451316879051845*^9, 
   3.451316886580526*^9}, {3.451317309566329*^9, 3.451317312431387*^9}, 
   3.451317554757759*^9, 3.451317592538065*^9, {3.451317766416519*^9, 
   3.451317820963029*^9}, {3.451318242914377*^9, 3.451318302140006*^9}, {
   3.451318401680405*^9, 3.451318403092815*^9}, {3.451318441142556*^9, 
   3.451318448573037*^9}, {3.451318556738251*^9, 3.451318561137216*^9}, {
   3.451318599102434*^9, 3.451318601739819*^9}, {3.451318648875968*^9, 
   3.451318649405384*^9}, {3.451318705395783*^9, 3.451318711549563*^9}, {
   3.451318770977006*^9, 3.451318793524523*^9}, 3.451318864492731*^9, {
   3.451319244390798*^9, 3.451319264365819*^9}, {3.451319318521038*^9, 
   3.451319337644956*^9}, {3.451319616129108*^9, 3.45131964005324*^9}, {
   3.451319750454747*^9, 3.451319799920457*^9}, 3.451319966581215*^9, {
   3.451320034520368*^9, 3.451320105005765*^9}, {3.451320148547304*^9, 
   3.451320182723257*^9}, {3.451320322596859*^9, 3.451320324136073*^9}, {
   3.451320355000828*^9, 3.451320367290092*^9}, {3.451320462584922*^9, 
   3.451320607768713*^9}, {3.451320644145333*^9, 3.451320645057535*^9}, 
   3.451320709097728*^9, {3.451320853572097*^9, 3.451320880953523*^9}, {
   3.451320920612531*^9, 3.451320929035824*^9}, {3.451321106362252*^9, 
   3.451321114203757*^9}, {3.451321224949722*^9, 3.451321257649179*^9}, {
   3.451321289906261*^9, 3.451321315943128*^9}, {3.451321358474275*^9, 
   3.451321417904009*^9}, {3.451321476196101*^9, 3.45132147824559*^9}, {
   3.451321516120502*^9, 3.451321573243551*^9}, {3.451321606695263*^9, 
   3.451321632575289*^9}, {3.451321741300334*^9, 3.451321770392265*^9}, {
   3.451321827183165*^9, 3.451321922843863*^9}, {3.451322652668481*^9, 
   3.451322656754155*^9}, 3.451322833574135*^9, {3.451322994084517*^9, 
   3.451323012545414*^9}, {3.45132312114273*^9, 3.451323146105642*^9}, {
   3.451323288539846*^9, 3.45132328992975*^9}, {3.45132448325616*^9, 
   3.45132448635961*^9}, {3.451325089425001*^9, 3.451325092521304*^9}, {
   3.451325146162206*^9, 3.45132514972307*^9}, {3.45132519594461*^9, 
   3.451325202186891*^9}, {3.45132526511031*^9, 3.451325293677654*^9}, 
   3.451325343690432*^9, {3.451325392316297*^9, 3.451325395164651*^9}, {
   3.451325513829516*^9, 3.451325515266582*^9}, {3.451393442241178*^9, 
   3.451393506447486*^9}, {3.451393557764741*^9, 3.451393565046171*^9}, {
   3.451393609055195*^9, 3.451393609976013*^9}, {3.451393694866458*^9, 
   3.451393783613338*^9}, {3.451394455023012*^9, 3.451394505395391*^9}, {
   3.451394538615529*^9, 3.451394575390954*^9}, {3.451394731067636*^9, 
   3.451394732057475*^9}, {3.45139496975802*^9, 3.451394971425963*^9}, {
   3.451395150115611*^9, 3.451395151672244*^9}, {3.451396364038903*^9, 
   3.451396373438163*^9}, {3.451396411511585*^9, 3.451396419664153*^9}, {
   3.451396476411971*^9, 3.451396509040744*^9}, 3.451396591783289*^9, {
   3.451396710766448*^9, 3.451396727269069*^9}, {3.451396774084481*^9, 
   3.451396781147268*^9}, {3.451396879289884*^9, 3.451396909709573*^9}, 
   3.451397017291325*^9, 3.451397096516548*^9, {3.451397283700373*^9, 
   3.451397295391855*^9}, {3.451647565188702*^9, 3.451647576756286*^9}, {
   3.451647765201499*^9, 3.451647772286258*^9}, {3.451914552198961*^9, 
   3.451914553827636*^9}, {3.451977035415851*^9, 3.451977064648639*^9}, {
   3.451977218605545*^9, 3.451977309760787*^9}, {3.451977341425075*^9, 
   3.451977349656208*^9}, {3.451977415194409*^9, 3.451977438602567*^9}, {
   3.451977482234568*^9, 3.451977570335019*^9}, {3.451977685801143*^9, 
   3.451977730398402*^9}, {3.451977801010382*^9, 3.4519778131909*^9}, {
   3.451977927635835*^9, 3.451977946193233*^9}, {3.451977981580003*^9, 
   3.451978074914122*^9}, {3.451978573909292*^9, 3.451978613295869*^9}, 
   3.451979137567778*^9, {3.451979475608387*^9, 3.451979484427895*^9}, 
   3.451980802501036*^9, 3.451980841444482*^9, 3.451982944421107*^9, {
   3.451983049108007*^9, 3.451983050808983*^9}, 3.451986546188676*^9, 
   3.451991829776616*^9, 3.451991874165471*^9, 3.451993157779084*^9, 
   3.451994167702954*^9, {3.451994664709835*^9, 3.451994670751077*^9}, 
   3.451994779744119*^9, {3.452348282351801*^9, 3.452348305948626*^9}, {
   3.452348863877905*^9, 3.452348871593252*^9}, {3.452348929645624*^9, 
   3.452349093005576*^9}, 3.452349163354316*^9, {3.452349358879036*^9, 
   3.452349368717949*^9}, {3.452359212814083*^9, 3.452359244996783*^9}, 
   3.452359287480445*^9, {3.452359641842327*^9, 3.452359645761994*^9}, {
   3.452429188587701*^9, 3.452429253893454*^9}, {3.452429423136294*^9, 
   3.452429431757532*^9}, {3.452429844069095*^9, 3.45242989490154*^9}, {
   3.452430820875636*^9, 3.452430826647256*^9}, {3.45243194133154*^9, 
   3.45243199971685*^9}, {3.452432043776312*^9, 3.452432127756735*^9}, {
   3.45243359203066*^9, 3.452433593100255*^9}, {3.452435358833192*^9, 
   3.452435442003799*^9}, {3.452435605467979*^9, 3.452435611527364*^9}, {
   3.452436748418093*^9, 3.452436792321338*^9}, {3.452436848805842*^9, 
   3.452436874257032*^9}, {3.452436961431523*^9, 3.452436978283443*^9}, {
   3.452503093412571*^9, 3.452503110464109*^9}, {3.452503146109683*^9, 
   3.452503157461646*^9}, {3.452503284626043*^9, 3.452503319379188*^9}, {
   3.452503352427569*^9, 3.452503368013224*^9}, {3.452503404948382*^9, 
   3.452503453564687*^9}, {3.452503486553225*^9, 3.452503531854947*^9}, 
   3.452503593452378*^9, {3.452503631002014*^9, 3.452503670452252*^9}, {
   3.452503782998762*^9, 3.452503784981463*^9}, {3.452503879248304*^9, 
   3.452503957728077*^9}, {3.452504506990491*^9, 3.452504507636656*^9}, 
   3.452504792261655*^9, {3.452506674608892*^9, 3.452506720642256*^9}, {
   3.45250675276557*^9, 3.452506767789893*^9}, {3.452506829889426*^9, 
   3.452506873011254*^9}, 3.45250691472205*^9, {3.45250777098386*^9, 
   3.452507842638114*^9}, {3.452507916052414*^9, 3.452507917064661*^9}, {
   3.452508015620077*^9, 3.452508030439877*^9}, {3.45250807995802*^9, 
   3.452508296606786*^9}, 3.452508423384269*^9, {3.452514915342416*^9, 
   3.452514938156737*^9}, 3.452514979606844*^9, {3.452515039060203*^9, 
   3.452515069780996*^9}, {3.452515145261898*^9, 3.452515148942493*^9}, {
   3.452515376042645*^9, 3.452515387199572*^9}, {3.452515469981488*^9, 
   3.452515514019583*^9}, {3.452515597592275*^9, 3.4525155997104*^9}, 
   3.452515643257802*^9, {3.452515684269518*^9, 3.45251569746131*^9}, {
   3.452516337832653*^9, 3.4525163492042*^9}, 3.452516386477176*^9, {
   3.452516417636282*^9, 3.452516424228562*^9}, 3.45251648528596*^9, {
   3.452519113447012*^9, 3.452519115411517*^9}, {3.452523118552426*^9, 
   3.45252319631394*^9}, {3.452523273539466*^9, 3.452523364761584*^9}, {
   3.452523474002623*^9, 3.452523552913832*^9}, {3.452523670432908*^9, 
   3.45252373309401*^9}, {3.452524093638799*^9, 3.452524095723497*^9}, {
   3.452524499403295*^9, 3.452524509725414*^9}, {3.452524651780485*^9, 
   3.452524677538398*^9}, {3.452524806900699*^9, 3.452524835424355*^9}, 
   3.452524915726926*^9, {3.452525073385259*^9, 3.452525074583793*^9}, {
   3.452868342677113*^9, 3.452868424347162*^9}, {3.452868473643052*^9, 
   3.452868509373667*^9}, 3.453026354854609*^9, {3.453047170290616*^9, 
   3.453047222902038*^9}, {3.453047345001338*^9, 3.453047345555835*^9}, {
   3.453047400803503*^9, 3.453047405764336*^9}, {3.45304792741428*^9, 
   3.453047928752829*^9}, {3.453047986896889*^9, 3.453047988294438*^9}, {
   3.453048046413538*^9, 3.453048130366547*^9}, {3.453048949546727*^9, 
   3.453048972050119*^9}, {3.453049032174745*^9, 3.453049038629628*^9}, {
   3.45304912056631*^9, 3.453049126737641*^9}, 3.453049176846592*^9, 
   3.453049373631403*^9, {3.453049681351129*^9, 3.453049688115321*^9}, {
   3.453050865366989*^9, 3.453050866468097*^9}, 3.45305100304926*^9, 
   3.453658467844346*^9, {3.45415762364404*^9, 3.454157639976216*^9}, {
   3.454160032717737*^9, 3.454160036827556*^9}, {3.454160071141939*^9, 
   3.454160098032607*^9}, {3.454160282815613*^9, 3.454160291459497*^9}, {
   3.454240964022716*^9, 3.454240991011646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", "3"}], ";", 
  RowBox[{"d", "=", 
   RowBox[{"l", "=", 
    RowBox[{"o", "=", 
     RowBox[{"n", "=", "1"}]}]}]}], ";", 
  RowBox[{"y", "=", "10"}], ";", 
  RowBox[{"v1", "=", 
   RowBox[{"v2", "=", 
    RowBox[{"v3", "=", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.452516694185126*^9, 3.452516704312651*^9}, {
  3.452516752555135*^9, 3.452516756985015*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["8. Miscellaneous and old code", "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066413671875*^9}, 
   3.4000664990625*^9, 3.400066567125*^9, {3.406040935703125*^9, 
   3.40604096303125*^9}, {3.406045936578125*^9, 3.406045942875*^9}, {
   3.40628982965625*^9, 3.406289829671875*^9}, 3.438600162121797*^9, 
   3.438685170668969*^9, {3.449390037445386*^9, 3.449390048420546*^9}, {
   3.450608956068069*^9, 3.450608956132477*^9}, 3.45243917368751*^9}],

Cell[CellGroupData[{

Cell["\<\
3 a. i. Extract and import data from zip files; delete archives with no data \
in [not updated for multiple modules]\
\>", "Subsection",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066498234375*^9}, 
   3.40006656671875*^9, {3.400072210765625*^9, 3.400072236359375*^9}, 
   3.438600140410165*^9, {3.447090987428429*^9, 3.447091015395765*^9}, 
   3.447091181861055*^9, {3.449334377802939*^9, 3.449334391067467*^9}, {
   3.449390003157655*^9, 3.449390011541292*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"years", "=", 
   RowBox[{"nblocks", "=", 
    RowBox[{"Table", "[", 
     RowBox[{",", 
      RowBox[{"{", "nruns", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"todelete", "=", 
   RowBox[{"deleteyears", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "nruns", "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.393236135*^9, 3.393236144109375*^9}, {
   3.393236773140625*^9, 3.393236773375*^9}, {3.393236818859375*^9, 
   3.39323682684375*^9}, {3.393236954125*^9, 3.393236955046875*^9}, {
   3.397290740109375*^9, 3.39729077890625*^9}, {3.397290825078125*^9, 
   3.397290826859375*^9}, {3.399821462125*^9, 3.399821462328125*^9}, {
   3.399821608453125*^9, 3.399821611703125*^9}, {3.40006843278125*^9, 
   3.400068432921875*^9}, {3.400071710375*^9, 3.400071733140625*^9}, 
   3.400071764375*^9, {3.400244780046875*^9, 3.40024480321875*^9}, {
   3.400244839046875*^9, 3.4002448408125*^9}, {3.401621690125*^9, 
   3.40162170371875*^9}, 3.405683497859375*^9, {3.40568356365625*^9, 
   3.4056835736875*^9}, 3.40595000234375*^9, 3.40595007690625*^9, {
   3.41251536052982*^9, 3.412515364323556*^9}, {3.413889861140296*^9, 
   3.413889863842694*^9}, {3.413891163240211*^9, 3.41389116407477*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetDirectory", "[", 
      RowBox[{"outputfolder", "~~", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\</../genie/genie-biogem/data/input\>\"", ",", 
         RowBox[{"\"\</\>\"", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
            "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}]}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"savefile", "=", 
      RowBox[{"Import", "[", "savesigfilename", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"savesig", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"savefile", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "saveblock"}], "]"}], "*", 
           "saveblock"}], "+", "saveblock"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{
            RowBox[{"Length", "[", "savefile", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"savesigtodelete", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"savesig", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", 
           RowBox[{"savesig", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "||", 
          RowBox[{
           RowBox[{"savesig", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ">", 
           RowBox[{"nyears", "+", "saveblock"}]}]}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"savesigtodelete", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "savesig", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"savesig2", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"savesig", ",", "savesigtodelete"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"years", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "=", "savesig2"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nblocks", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "=", 
      RowBox[{"Length", "[", 
       RowBox[{"years", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.39600986903125*^9, 3.396009954171875*^9}, {
   3.396010144765625*^9, 3.3960102019375*^9}, {3.396010235828125*^9, 
   3.396010242015625*^9}, {3.39601100690625*^9, 3.396011074859375*^9}, {
   3.396012015015625*^9, 3.396012019359375*^9}, {3.3960120796875*^9, 
   3.396012101328125*^9}, {3.397305620171875*^9, 3.39730562021875*^9}, {
   3.399821091421875*^9, 3.399821098234375*^9}, 3.399821166765625*^9, {
   3.39982130703125*^9, 3.39982135490625*^9}, {3.39982147078125*^9, 
   3.39982148121875*^9}, {3.399821585734375*^9, 3.3998215883125*^9}, {
   3.400071401296875*^9, 3.400071403296875*^9}, {3.40007159659375*^9, 
   3.400071600953125*^9}, 3.40447616825*^9, {3.40447657165625*^9, 
   3.404476574234375*^9}, {3.4048191293073654`*^9, 3.4048191308229904`*^9}, 
   3.4053375045625*^9, {3.412506904667581*^9, 3.412506917046374*^9}, {
   3.416915196269997*^9, 3.41691521284072*^9}, {3.416915245238794*^9, 
   3.416915264661013*^9}, {3.416915322785714*^9, 3.416915335837788*^9}, {
   3.416915401503983*^9, 3.416915401899879*^9}, {3.416915528298505*^9, 
   3.416915550325418*^9}, {3.416915979970669*^9, 3.416916001659164*^9}, {
   3.416916119994576*^9, 3.416916133285571*^9}, {3.41857058778125*^9, 
   3.41857059009375*^9}, 3.418654247890625*^9, {3.418730066251495*^9, 
   3.418730068253287*^9}, {3.419150472045317*^9, 3.419150472779159*^9}, {
   3.419150506486862*^9, 3.419150506962133*^9}, 3.420292200625*^9, {
   3.420974838896678*^9, 3.42097491998519*^9}, {3.433582602414237*^9, 
   3.433582605722178*^9}, 3.447089910037263*^9}],

Cell[BoxData["years"], "Input",
 CellChangeTimes->{{3.445688217574882*^9, 3.445688217981997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allyears", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", "nruns", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "saveblock", ",", 
       RowBox[{"nyears", "+", "saveblock"}], ",", "saveblock"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.400075140265625*^9, 3.400075152453125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"years", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i"}], "]"}], "]"}], "==", 
           RowBox[{"allyears", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"todelete", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"{", "j", "}"}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", 
              RowBox[{"Length", "[", 
               RowBox[{"years", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"i", "++"}]}], "]"}]}]}], "]"}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"allyears", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"deleteyears", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "=", 
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{"allyears", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", 
        RowBox[{"todelete", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.400069363484375*^9, 3.400069364171875*^9}, {
   3.400069395140625*^9, 3.400069549625*^9}, {3.400069654328125*^9, 
   3.4000696884375*^9}, {3.40006994121875*^9, 3.400069967125*^9}, {
   3.400070100578125*^9, 3.40007010134375*^9}, {3.4000701641875*^9, 
   3.40007018359375*^9}, {3.400070232953125*^9, 3.40007028*^9}, {
   3.40007033584375*^9, 3.40007038978125*^9}, {3.400070457984375*^9, 
   3.400070502421875*^9}, {3.400070568671875*^9, 3.400070604984375*^9}, {
   3.40007065175*^9, 3.40007065596875*^9}, {3.40007071453125*^9, 
   3.40007076278125*^9}, {3.40007093715625*^9, 3.400070943265625*^9}, {
   3.400071007046875*^9, 3.400071044703125*^9}, {3.400071161421875*^9, 
   3.400071228*^9}, {3.40007126271875*^9, 3.400071305984375*^9}, {
   3.40007135328125*^9, 3.4000714503125*^9}, {3.400071495640625*^9, 
   3.40007149578125*^9}, {3.40007153109375*^9, 3.400071546109375*^9}, 
   3.40007183146875*^9, {3.412515294402402*^9, 3.412515299003261*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timing", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Date", "[", "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"percent", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.441549465613629*^9, 3.441549499798084*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"years", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.418654633171875*^9, 3.418654638703125*^9}, {
   3.419227024017371*^9, 3.419227024588996*^9}, 3.420292317*^9, {
   3.4202929761875*^9, 3.420292977859375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"datafilenames", "=", 
    RowBox[{"data2", "=", 
     RowBox[{"deletefiles", "=", 
      RowBox[{"columntitles", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "}"}], ",", 
           RowBox[{"{", "nruns", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", 
       RowBox[{",", 
        RowBox[{"{", 
         RowBox[{"nblocks", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenames", "[", 
       RowBox[{"[", 
        RowBox[{"filenamenos", "[", 
         RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timing", "[", 
       RowBox[{"[", 
        RowBox[{"Mod", "[", 
         RowBox[{"k", ",", "2", ",", "1"}], "]"}], "]"}], "]"}], "=", 
      RowBox[{"Date", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"percent", "[", 
       RowBox[{"[", 
        RowBox[{"Mod", "[", 
         RowBox[{"k", ",", "2", ",", "1"}], "]"}], "]"}], "]"}], "=", 
      RowBox[{"100.", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"o", "-", "1"}], ")"}], "/", "nfilenames"}], ")"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "nfilenames"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k", "-", "1"}], ")"}], "/", "nruns"}], ")"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<\\n\\nETA: `` hr\>\"", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"DateDifference", "[", 
              RowBox[{
               RowBox[{"timing", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"timing", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Second\>\""}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
           RowBox[{"100", "/", 
            RowBox[{"(", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"percent", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"percent", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ")"}]}]}], ")"}], 
         "/", "3600"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\\n-- \>\"", "~~", "filename", "~~", "\"\< --\\n\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\\n\>\"", "~~", 
       RowBox[{"runids", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<:\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", 
      RowBox[{"archivefolder", "~~", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
         "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
       RowBox[{"runidslong", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"filecontents", "=", 
      RowBox[{"FileNames", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<checking for previously aggregated data\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"datafilenames", "[", 
       RowBox[{"[", 
        RowBox[{"o", ",", "k"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"StringExpression", "[", 
       RowBox[{
        RowBox[{"runids", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", " ", "\"\<_\>\"", ",", " ", 
        RowBox[{"StringTake", "[", 
         RowBox[{"filename", ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", 
            RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", " ", "\"\<.dat\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xx", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"filecontents", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "==", 
          RowBox[{"datafilenames", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "k"}], "]"}], "]"}]}], ",", 
         RowBox[{"xx", "=", "i"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "filecontents", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xx", "-=", 
      RowBox[{"1000", "*", "overwritedata"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"xx", ">", "0"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<previously aggregated data file exists\>\"", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data2", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "k"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Import", "[", 
          RowBox[{"datafilenames", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "k"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "k"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d", "\[Equal]", "0"}], ",", 
          RowBox[{
          "Print", "[", 
           "\"\<there is no data in file - reading in data...\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"data2", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "k", ",", "d"}], "]"}], "]"}], "\[Equal]", 
           RowBox[{"{", "\"\<$Failed\>\"", "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{
             RowBox[{"nblocks", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "+", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"data2", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "k", ",", "d"}], "]"}], "]"}], "\[Equal]", 
              "\"\<$Failed\>\""}], ",", 
             RowBox[{"d", "--"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<model crashed at year \>\"", ",", 
             RowBox[{"data2", "[", 
              RowBox[{"[", 
               RowBox[{"o", ",", "k", ",", 
                RowBox[{"d", "-", "1"}], ",", "1"}], "]"}], "]"}]}], "]"}], 
           ";"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"data2", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "k", ",", "d"}], "]"}], "]"}], ",", 
                "\"\<$Failed\>\""}], "]"}], "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{
               RowBox[{"nblocks", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "+", "1"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "k", ",", "d"}], "]"}], "]"}], ",", 
                   "\"\<$Failed\>\""}], "]"}], "]"}], ">", "0"}], ",", 
               RowBox[{"d", "--"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<data corrupted at year \>\"", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"d", "\[Equal]", "0"}], ",", "0", ",", 
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "k", ",", "d", ",", "1"}], "]"}], 
                  "]"}]}], "]"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"years", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "&&", 
                RowBox[{
                 RowBox[{"years", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "j"}], "]"}], "]"}], "<", 
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "k", ",", "d", ",", "1"}], "]"}], 
                  "]"}]}]}], ",", 
               RowBox[{"j", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<data already aggregated up to year \>\"", ",", 
               RowBox[{"years", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "j"}], "]"}], "]"}], ",", 
               "\"\<; reading in the rest...\>\""}], "]"}]}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d", ">", "0"}], ",", 
          RowBox[{"j", "++"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<no previously aggregated data exists - reading in data...\>\"", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"j", "<=", 
        RowBox[{"nblocks", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tarball", "=", 
           RowBox[{"ToString", "[", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<``.``.tar.gz\>\"", ",", 
              RowBox[{"runids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"years", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "l"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"filecontents", "[", 
                RowBox[{"[", "p", "]"}], "]"}], "\[Equal]", "tarball"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"StringForm", "[", 
                 RowBox[{
                 "\"\<reading in data to year ``...``% complete\>\"", ",", 
                  RowBox[{"years", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "l"}], "]"}], "]"}], ",", 
                  RowBox[{"100.", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"o", "-", "1"}], ")"}], "/", "nfilenames"}], 
                    ")"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "nfilenames"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}], "/", "nruns"}], ")"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "nfilenames"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "nruns"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"l", "-", "1"}], ")"}], "/", 
                    RowBox[{"nblocks", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
                 "]"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "=", 
                RowBox[{"Import", "[", 
                 RowBox[{"tarball", ",", "\[IndentingNewLine]", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<``/biogem/``\>\"", ",", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "filename"}], "]"}], 
                   "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "=", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", "l", "]"}], "]"}], "//", "TableForm"}], 
                  "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "=", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], ",", 
                  RowBox[{"\"\<,\>\"", "->", "\"\</\>\""}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "=", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], ",", 
                  RowBox[{"\"\<            \>\"", "->", "\"\</\>\""}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "=", 
                RowBox[{"StringInsert", "[", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], ",", "\"\<\\n\>\"", ",", 
                  RowBox[{"1", "+", 
                   RowBox[{"StringLength", "[", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", "l", "]"}], "]"}], "]"}]}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "=", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], ",", 
                  RowBox[{"\"\<\\n\\n\>\"", "\[Rule]", "\"\<\\n\>\""}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"x", "=", 
                RowBox[{"StringPosition", "[", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], ",", "\"\<\\n\>\""}], 
                 "]"}]}], ";", 
               RowBox[{"nx", "=", 
                RowBox[{"Length", "[", "x", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"y", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "nx"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"spaces", "=", 
                RowBox[{"StringPosition", "[", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], ",", 
                  RowBox[{"\"\< \>\"", ".."}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"i", "=", "0"}], ";", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "++"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"spaces", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"spaces", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"spaces", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"spaces", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}]}], ";", 
                    RowBox[{"i", "--"}]}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Length", "[", "spaces", "]"}], "-", "1"}], 
                  "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"i", "=", "1"}], ";", 
               RowBox[{"While", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"spaces", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"i", "++"}], ";"}]}], "]"}], ";", 
               RowBox[{"i", "--"}], ";", "\[IndentingNewLine]", 
               RowBox[{"spaces2", "=", 
                RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"jj", "=", "1"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"jj", "+", "1"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", "y", "]"}]}], "&&", 
                    RowBox[{"i", "\[LessEqual]", 
                    RowBox[{"Length", "[", "spaces", "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"spaces", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ">", 
                    RowBox[{"y", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"spaces", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", 
                    RowBox[{"y", "[", 
                    RowBox[{"[", 
                    RowBox[{"jj", "+", "1"}], "]"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"spaces2", ",", 
                    RowBox[{
                    RowBox[{"spaces", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"y", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"jj", "++"}], ";", 
                    RowBox[{"i", "--"}]}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Length", "[", "spaces", "]"}], "-", "1"}], 
                  "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"i", "=", 
                  RowBox[{
                   RowBox[{"Length", "[", "spaces2", "]"}], "-", "1"}]}], ";", 
                 RowBox[{"While", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"spaces2", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", 
                    RowBox[{"spaces2", "[", 
                    RowBox[{"[", 
                    RowBox[{"Length", "[", "spaces2", "]"}], "]"}], "]"}]}], 
                   ",", 
                   RowBox[{"i", "--"}]}], "]"}], ";", 
                 RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"spaces3", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"spaces2", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "i", ",", 
                    RowBox[{"Length", "[", "spaces2", "]"}]}], "}"}]}], 
                   "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"spaces3", "=", 
                RowBox[{"Union", "[", "spaces2", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"spaces3", ",", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"spaces3", "=", 
                RowBox[{"Sort", "[", "spaces3", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Do", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"i", "=", 
                    RowBox[{"Length", "[", "spaces3", "]"}]}], ";", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"spaces3", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", 
                    RowBox[{
                    RowBox[{"spaces3", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"i", "--"}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", ">", "1"}], ",", 
                    RowBox[{"spaces3", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"spaces3", ",", "i"}], "]"}]}], ",", 
                    RowBox[{"spaces3", "=", "spaces3"}]}], "]"}], ";"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Length", "[", "spaces3", "]"}], "}"}]}], "]"}], 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", "l", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"y", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", 
                    RowBox[{"spaces3", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"y", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", 
                    RowBox[{"spaces3", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "spaces3", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", 
                    RowBox[{"nx", "-", "1"}]}], "}"}]}], "]"}], ";"}]}]}]}], 
             "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{"Length", "[", "filecontents", "]"}]}], "}"}]}], "]"}], 
          ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"l", ",", "j", ",", 
           RowBox[{"nblocks", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<There is no more data left to read in in the seleced time \
interval\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"zz", "=", "0"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"filecontents", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "==", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"datafilenames", "[", 
             RowBox[{"[", 
              RowBox[{"o", ",", "k"}], "]"}], "]"}], ",", 
            RowBox[{"\"\<.dat\>\"", "->", "\"\<.csv\>\""}]}], "]"}]}], ",", 
         RowBox[{"zz", "=", "i"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "filecontents", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zz", "-=", 
      RowBox[{"1000", "*", "overwritedata"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"zz", ">", "0"}], "&&", 
        RowBox[{"d", ">", "0"}]}], ",", 
       RowBox[{
        RowBox[{"columntitles", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "k"}], "]"}], "]"}], "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Import", "[", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"datafilenames", "[", 
             RowBox[{"[", 
              RowBox[{"o", ",", "k"}], "]"}], "]"}], ",", 
            RowBox[{"\"\<.dat\>\"", "->", "\"\<.csv\>\""}]}], "]"}], "]"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"yy", "=", 
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\\n\>\""}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"slashes", "=", 
         RowBox[{"StringPosition", "[", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\</ \>\""}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"slashes2", "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"slashes", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "slashes", "]"}]}], "}"}]}], "]"}], 
             ",", "2"}], "]"}], ",", "yy"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"slashes3", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"slashes2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{
              RowBox[{"slashes2", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"Length", "[", "slashes2", "]"}], "-", "1"}]}], "}"}]}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"columntitles", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "k"}], "]"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"slashes3", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "slashes3", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
           RowBox[{"StringTake", "[", 
            RowBox[{"filename", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", "\"\<.csv\>\""}], 
          ",", 
          RowBox[{"columntitles", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "k"}], "]"}], "]"}]}], "]"}], ";"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"data2", "[", 
         RowBox[{"[", 
          RowBox[{"o", ",", "k", ",", "l", ",", "m"}], "]"}], "]"}], "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "k", ",", "l", ",", "m"}], "]"}], "]"}], ",", 
          RowBox[{"\"\<E\>\"", "\[Rule]", "\"\< 10^\>\""}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"d", "+", "1"}], ",", 
         RowBox[{"Length", "[", 
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"m", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "k", ",", "l"}], "]"}], "]"}], "]"}]}], "}"}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data2", "[", 
       RowBox[{"[", 
        RowBox[{"o", ",", "k"}], "]"}], "]"}], "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"data2", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "k"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"runids", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
        RowBox[{"StringTake", "[", 
         RowBox[{"filename", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", "\"\<.dat\>\""}], ",", 
       RowBox[{"data2", "[", 
        RowBox[{"[", 
         RowBox[{"o", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"deleteexcessfiles", "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<deleting archived files with no saved data in...\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"filecount", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deletefiles", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "k"}], "]"}], "]"}], "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"file", "=", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<``.``.tar.gz\>\"", ",", 
               RowBox[{"runids", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"deleteyears", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "d"}], "]"}], "]"}]}], "]"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"filecontents", "[", 
                  RowBox[{"[", "f", "]"}], "]"}], "\[Equal]", "file"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<deleting: \>\"", ",", "file"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{
                   RowBox[{"deletefiles", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "k"}], "]"}], "]"}], ",", "file"}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"filecount", "++"}]}]}], "]"}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Length", "[", "filecontents", "]"}]}], "}"}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"d", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"deleteyears", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"DeleteFile", "[", 
         RowBox[{"deletefiles", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "k"}], "]"}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"filecount", "\[Equal]", "0"}], ",", 
          RowBox[{"Print", "[", "\"\<no files needed deleting\>\"", "]"}]}], 
         "]"}]}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"o", ",", "nfilenames"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.393168059515625*^9, 3.393168070921875*^9}, {
   3.393168165078125*^9, 3.393168165140625*^9}, {3.393168219875*^9, 
   3.393168220359375*^9}, {3.393168335375*^9, 3.393168386375*^9}, {
   3.393168417609375*^9, 3.393168637484375*^9}, {3.3931686843125*^9, 
   3.393168725890625*^9}, {3.393168817859375*^9, 3.39316882509375*^9}, {
   3.393168912140625*^9, 3.39316898*^9}, {3.393169104640625*^9, 
   3.393169123125*^9}, {3.393169214640625*^9, 3.393169220421875*^9}, {
   3.393172260453125*^9, 3.3931723210625*^9}, {3.39323596896875*^9, 
   3.39323598571875*^9}, {3.393236068875*^9, 3.3932360703125*^9}, {
   3.39323613353125*^9, 3.393236186765625*^9}, {3.39323679084375*^9, 
   3.393236807375*^9}, 3.393236904859375*^9, 3.393238583*^9, {
   3.393243376546875*^9, 3.39324338340625*^9}, 3.393244562421875*^9, {
   3.39324461021875*^9, 3.393244620640625*^9}, 3.393244668921875*^9, {
   3.397288954296875*^9, 3.3972890071875*^9}, {3.397290521171875*^9, 
   3.39729054434375*^9}, {3.397291031046875*^9, 3.39729103559375*^9}, {
   3.39730429675*^9, 3.397304316234375*^9}, {3.397304365953125*^9, 
   3.39730441671875*^9}, {3.397305426453125*^9, 3.397305448953125*^9}, 
   3.39730547984375*^9, {3.397306916515625*^9, 3.39730696840625*^9}, {
   3.3973070079375*^9, 3.397307017921875*^9}, 3.39730738321875*^9, {
   3.399705860765625*^9, 3.3997059146875*^9}, 3.3997059453125*^9, {
   3.39970626259375*^9, 3.399706317953125*^9}, {3.399706457859375*^9, 
   3.399706483859375*^9}, {3.399707096390625*^9, 3.399707111484375*^9}, {
   3.399707970765625*^9, 3.39970797759375*^9}, {3.399708091296875*^9, 
   3.39970809553125*^9}, 3.399731810484375*^9, {3.399732979140625*^9, 
   3.399733002671875*^9}, {3.3997335063125*^9, 3.399733510140625*^9}, {
   3.399801532171875*^9, 3.399801537609375*^9}, 3.399820382703125*^9, 
   3.400066498234375*^9, 3.40006656671875*^9, {3.4000667328125*^9, 
   3.400066750203125*^9}, {3.400068664859375*^9, 3.400068699453125*^9}, {
   3.400071975890625*^9, 3.40007204665625*^9}, {3.40007207971875*^9, 
   3.400072180171875*^9}, {3.40007436496875*^9, 3.400074365125*^9}, {
   3.400074550265625*^9, 3.40007455465625*^9}, {3.400074680546875*^9, 
   3.400074773484375*^9}, {3.400074819078125*^9, 3.40007489834375*^9}, {
   3.400074972109375*^9, 3.400075028828125*^9}, {3.40007521809375*^9, 
   3.40007526975*^9}, {3.400075384015625*^9, 3.400075384171875*^9}, {
   3.400243733796875*^9, 3.4002437364375*^9}, {3.400243814890625*^9, 
   3.40024382103125*^9}, {3.40024405228125*^9, 3.400244057796875*^9}, {
   3.4002448079375*^9, 3.400244856734375*^9}, 3.40024498665625*^9, {
   3.40024522084375*^9, 3.400245259078125*^9}, {3.400245563609375*^9, 
   3.40024556865625*^9}, {3.40031477265625*^9, 3.4003148995*^9}, {
   3.400314948234375*^9, 3.40031495284375*^9}, {3.400841088046875*^9, 
   3.400841090703125*^9}, {3.4015611525*^9, 3.40156118053125*^9}, {
   3.401561459140625*^9, 3.40156146584375*^9}, {3.40156198634375*^9, 
   3.401561991109375*^9}, {3.401562175265625*^9, 3.401562221609375*^9}, {
   3.401562297453125*^9, 3.401562297671875*^9}, {3.401562352046875*^9, 
   3.401562354078125*^9}, 3.401629018609375*^9, {3.402154171453125*^9, 
   3.402154191359375*^9}, {3.40215425753125*^9, 3.402154295328125*^9}, 
   3.402154429125*^9, {3.402155625921875*^9, 3.402155654078125*^9}, {
   3.402155734*^9, 3.402155769171875*^9}, {3.402155802046875*^9, 
   3.402155854953125*^9}, {3.40215604415625*^9, 3.402156050390625*^9}, {
   3.402156094609375*^9, 3.402156098890625*^9}, {3.40215615934375*^9, 
   3.402156159625*^9}, {3.402322050109375*^9, 3.402322085578125*^9}, {
   3.402396881078125*^9, 3.402396905328125*^9}, {3.4023969460625*^9, 
   3.40239694890625*^9}, {3.403532703046875*^9, 3.403532755921875*^9}, {
   3.40447511434375*^9, 3.404475134703125*^9}, {3.40456512290625*^9, 
   3.4045651315*^9}, {3.40465664021875*^9, 3.404656665734375*^9}, {
   3.404656751375*^9, 3.404656761359375*^9}, 3.4047436966875*^9, {
   3.40507847740075*^9, 3.4050784794945*^9}, {3.405683221609375*^9, 
   3.405683225640625*^9}, {3.405683271203125*^9, 3.40568328721875*^9}, {
   3.405683709984375*^9, 3.40568374125*^9}, {3.40568449196875*^9, 
   3.405684507265625*^9}, {3.4058685051951714`*^9, 3.405868505257675*^9}, {
   3.405869569441123*^9, 3.405869592739191*^9}, {3.4058696395384617`*^9, 
   3.4058696511796827`*^9}, {3.405869701729146*^9, 3.4058697071200466`*^9}, {
   3.4058697493097067`*^9, 3.4058697610446825`*^9}, {3.4058701419235573`*^9, 
   3.4058702319896045`*^9}, {3.405870535360628*^9, 3.40587054568915*^9}, {
   3.405870664787473*^9, 3.4058706854757676`*^9}, 3.4058707571660204`*^9, {
   3.4058708690296907`*^9, 3.40587087773315*^9}, {3.405871233918311*^9, 
   3.4058712535595646`*^9}, 3.4058713194366727`*^9, {3.4058713718758507`*^9, 
   3.4058714686445723`*^9}, {3.4058718250309763`*^9, 3.405871856625737*^9}, {
   3.405871912205641*^9, 3.405871967144899*^9}, {3.405872014146403*^9, 
   3.40587203610023*^9}, {3.405872084242396*^9, 3.405872084304898*^9}, {
   3.405872125493716*^9, 3.4058721259468555`*^9}, 3.405872161885505*^9, {
   3.4058722293874574`*^9, 3.405872233403185*^9}, {3.4059485545625*^9, 
   3.405948565140625*^9}, {3.405948732*^9, 3.405948745890625*^9}, {
   3.405948955515625*^9, 3.40594895571875*^9}, {3.405950009*^9, 
   3.405950042109375*^9}, {3.405950084359375*^9, 3.405950121328125*^9}, {
   3.405950229359375*^9, 3.405950261375*^9}, {3.40595031246875*^9, 
   3.4059503239375*^9}, 3.405954374171875*^9, {3.405955212796875*^9, 
   3.40595521534375*^9}, {3.405955637703125*^9, 3.405955637953125*^9}, {
   3.405957082921875*^9, 3.40595708325*^9}, {3.405957122890625*^9, 
   3.405957123046875*^9}, 3.405957247515625*^9, {3.4059573431875*^9, 
   3.4059573496875*^9}, {3.40595738353125*^9, 3.4059574249375*^9}, {
   3.4059575890625*^9, 3.405957589921875*^9}, {3.405957723125*^9, 
   3.405957724078125*^9}, {3.405957757859375*^9, 3.40595776721875*^9}, {
   3.40595801853125*^9, 3.405958033765625*^9}, {3.405958335953125*^9, 
   3.4059583699375*^9}, {3.40595856978125*^9, 3.405958579625*^9}, {
   3.4060221638125*^9, 3.406022204640625*^9}, {3.406022296359375*^9, 
   3.40602237115625*^9}, {3.406022472171875*^9, 3.40602247428125*^9}, {
   3.406022528515625*^9, 3.40602260215625*^9}, {3.40602274371875*^9, 
   3.406022790734375*^9}, {3.406022997359375*^9, 3.40602299740625*^9}, {
   3.406024549703125*^9, 3.40602458190625*^9}, {3.40602568928125*^9, 
   3.406025691296875*^9}, 3.40602572609375*^9, {3.406025862953125*^9, 
   3.406025998796875*^9}, 3.40602613115625*^9, {3.40602649565625*^9, 
   3.406026512390625*^9}, {3.406026580671875*^9, 3.406026588578125*^9}, {
   3.406026660046875*^9, 3.406026668*^9}, 3.4060268990625*^9, {
   3.406027359125*^9, 3.4060273643125*^9}, {3.4060305224375*^9, 
   3.406030526609375*^9}, {3.4060310441875*^9, 3.4060311133125*^9}, {
   3.406041002328125*^9, 3.406041062828125*^9}, {3.40604410953125*^9, 
   3.40604412471875*^9}, {3.406044581765625*^9, 3.406044598953125*^9}, 
   3.406044748984375*^9, {3.406044815734375*^9, 3.40604482846875*^9}, {
   3.40604488284375*^9, 3.406044894234375*^9}, 3.40604495559375*^9, {
   3.4064629744375*^9, 3.406462996765625*^9}, {3.406463056859375*^9, 
   3.4064630918125*^9}, {3.406463131828125*^9, 3.406463162171875*^9}, {
   3.406463193078125*^9, 3.406463203203125*^9}, {3.40646324303125*^9, 
   3.40646324334375*^9}, {3.406463414171875*^9, 3.40646343609375*^9}, {
   3.406464269046875*^9, 3.406464272140625*^9}, 3.406464519390625*^9, {
   3.41250696867668*^9, 3.412506969981107*^9}, {3.412515451297644*^9, 
   3.412515455940378*^9}, {3.413634158393107*^9, 3.413634171059394*^9}, {
   3.41363420175211*^9, 3.413634217576201*^9}, {3.413634460209304*^9, 
   3.413634489414297*^9}, 3.413892572321435*^9, {3.413895858152377*^9, 
   3.413895883374346*^9}, {3.416916636355256*^9, 3.416916690413566*^9}, {
   3.41691679300595*^9, 3.416916816741282*^9}, {3.416916881788431*^9, 
   3.416916887298361*^9}, 3.416916920772346*^9, 3.416917293267924*^9, 
   3.417868716419975*^9, {3.418044598179136*^9, 3.41804461236311*^9}, 
   3.418044802601937*^9, 3.418046006268001*^9, {3.418046285291141*^9, 
   3.418046298312849*^9}, 3.418046483328477*^9, 3.418046621157935*^9, {
   3.418046678068443*^9, 3.418046683552949*^9}, {3.418048112556002*^9, 
   3.418048118039447*^9}, {3.418109577829317*^9, 3.418109580025524*^9}, {
   3.418109641704753*^9, 3.418109689702844*^9}, {3.418119743098278*^9, 
   3.418119802132221*^9}, {3.418121084466984*^9, 3.418121123437967*^9}, {
   3.418121192583084*^9, 3.418121198607802*^9}, {3.418122727521076*^9, 
   3.418122738778528*^9}, {3.418123947799554*^9, 3.418123949772466*^9}, {
   3.418124013067667*^9, 3.418124041442184*^9}, {3.418125098612294*^9, 
   3.418125099476614*^9}, 3.418570598265625*^9, {3.418653983265625*^9, 
   3.418653983296875*^9}, {3.418654067515625*^9, 3.418654081171875*^9}, {
   3.418654459421875*^9, 3.418654459859375*^9}, {3.4186545235*^9, 
   3.41865452409375*^9}, 3.418730073191356*^9, 3.419150564761088*^9, 
   3.419156076913094*^9, {3.419159422334043*^9, 3.419159426054774*^9}, 
   3.419165784239354*^9, {3.419169221541729*^9, 3.419169221739672*^9}, {
   3.4191702820934*^9, 3.419170323065481*^9}, {3.419170979415355*^9, 
   3.419171012877018*^9}, {3.419171465029341*^9, 3.419171500516444*^9}, {
   3.41917158898637*^9, 3.419171618590726*^9}, {3.419172175606787*^9, 
   3.419172194708784*^9}, 3.419172228294176*^9, {3.419175294346199*^9, 
   3.419175295575308*^9}, {3.419175863714959*^9, 3.419175864560538*^9}, 
   3.420274780503625*^9, 3.420292231875*^9, {3.420293039609375*^9, 
   3.42029303978125*^9}, 3.42097510496211*^9, {3.422105859435932*^9, 
   3.422105859625642*^9}, {3.433517713151147*^9, 3.433517715841598*^9}, {
   3.435936793349687*^9, 3.435936838355194*^9}, {3.435938543892234*^9, 
   3.435938592480985*^9}, 3.435938693437757*^9, {3.435939408466456*^9, 
   3.435939415039258*^9}, {3.441540967135255*^9, 3.441540974431493*^9}, 
   3.441541006982598*^9, {3.441541594497758*^9, 3.441541633522885*^9}, {
   3.441541670538473*^9, 3.441541802916789*^9}, {3.441543880543319*^9, 
   3.441543909435476*^9}, {3.441549167732005*^9, 3.441549178230439*^9}, {
   3.441549515567268*^9, 3.441549531411049*^9}, {3.441549582582287*^9, 
   3.441549809800036*^9}, {3.441550697332758*^9, 3.441550706317899*^9}, {
   3.441622477344086*^9, 3.441622544233326*^9}, 3.441622582380471*^9, {
   3.441622614592152*^9, 3.441622643731552*^9}, {3.441622734059558*^9, 
   3.441622742445795*^9}, 3.441622936425574*^9, {3.44205278783404*^9, 
   3.442052832096492*^9}, {3.442052883946646*^9, 3.442052884328267*^9}, 
   3.445679368556148*^9, 3.445686257865232*^9, 3.445691432761334*^9, 
   3.44708986268822*^9, {3.447090660604055*^9, 3.447090660951356*^9}, {
   3.449334489758133*^9, 3.449334490588608*^9}}]
}, Closed]],

Cell[BoxData[
 RowBox[{"ColorData", "[", "\"\<Gradients\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.399806631875*^9, 3.399806638609375*^9}, 
   3.3998068100625*^9, 3.400066499078125*^9, 3.400066567125*^9}],

Cell[CellGroupData[{

Cell["8. Comparative (Two-y-axis) Plots", "Subsection",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066413671875*^9}, 
   3.4000664990625*^9, 3.400066567125*^9, {3.406040935703125*^9, 
   3.40604096303125*^9}, 3.406287839828125*^9, 3.420975337611601*^9, 
   3.438600160569848*^9, 3.438685167693428*^9, {3.450608954579923*^9, 
   3.450608954643957*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "collatedoutputfolder", "=", "\"\<weath49-50-Fri_7_Dec_2007_181227\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.406034776875*^9, 3.406034822125*^9}, 3.406034893*^9, {
   3.406040574765625*^9, 3.406040577078125*^9}, 3.438685099468426*^9, 
   3.447088428178371*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "newdirectory", "]"}], "\[Equal]", "String"}], 
      ",", "newdirectory", ",", ",", "collatedoutputfolder"}], "]"}]}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.39980179275*^9, 3.399801829625*^9}, {3.3998019566875*^9,
    3.399801983640625*^9}, {3.39980203053125*^9, 3.39980205940625*^9}, {
   3.399882263125*^9, 3.399882263359375*^9}, 3.4000664990625*^9, 
   3.400066567125*^9, {3.40007760271875*^9, 3.400077604828125*^9}, {
   3.400078553625*^9, 3.40007857340625*^9}, {3.400082026046875*^9, 
   3.40008209096875*^9}, {3.40024609440625*^9, 3.40024609784375*^9}, {
   3.400256072*^9, 3.40025607684375*^9}, {3.400326687828125*^9, 
   3.40032669040625*^9}, {3.400326768984375*^9, 3.40032677775*^9}, {
   3.4060315940625*^9, 3.406031639046875*^9}, {3.406034827984375*^9, 
   3.406034865734375*^9}, {3.4060390665*^9, 3.406039068484375*^9}, {
   3.4064601285625*^9, 3.4064601299375*^9}, {3.412507060354266*^9, 
   3.412507064647178*^9}, 3.41857061671875*^9, 3.418730075710957*^9, 
   3.438685099857319*^9, 3.447088429334625*^9}],

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.406285634765625*^9, 3.406285639375*^9}}],

Cell["\<\
TwoAxisPlot code adapted from http : // \
web.archive.org/web/20010220085118/http : // \
support.wolfram.com/Graphics/Axes/TwoAxisGraph.html\
\>", "Text",
 CellChangeTimes->{{3.400085230859375*^9, 3.40008526753125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xmin", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", "nyears"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4002461655*^9, 3.40024618228125*^9}, {
   3.40025609784375*^9, 3.40025609846875*^9}, 3.405264475625*^9, {
   3.40526489059375*^9, 3.405264890953125*^9}, {3.40628824590625*^9, 
   3.4062882476875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TwoAxisPlot", "[", 
   RowBox[{"f_List", ",", "g_List", ",", 
    RowBox[{
     RowBox[{"(", "opts___", ")"}], "?", "OptionQ"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "old", ",", "new", ",", "scale", ",", "gmax", ",", "gmin", ",", "fmax", 
      ",", "fmin", ",", "newg"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "==", "Real"}], 
           ",", 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", ",", 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"gmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "==", "Real"}], 
           ",", 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", ",", 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"f", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "==", "Real"}], 
           ",", 
           RowBox[{"f", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", ",", 
           RowBox[{"f", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "f", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"fmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"f", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "==", "Real"}], 
           ",", 
           RowBox[{"f", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", ",", 
           RowBox[{"f", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "f", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"scale", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#1", "-", "gmin"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"fmax", "-", "fmin"}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"gmax", "-", "gmin"}], ")"}]}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"old", "=", 
      RowBox[{
       RowBox[{"FullOptions", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"g", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", 
              RowBox[{"{", 
               RowBox[{"gmin", ",", "gmax"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}], ",", 
         "FrameTicks"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Rest", "[", "#1", "]"}], ",", 
           RowBox[{"fmin", "+", 
            RowBox[{"scale", "[", 
             RowBox[{"First", "[", "#1", "]"}], "]"}]}]}], "]"}], "&"}], 
        ")"}], "/@", "old"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newg", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "g", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"fmin", "+", 
          RowBox[{"Map", "[", 
           RowBox[{"scale", ",", 
            RowBox[{
             RowBox[{"Transpose", "[", "g", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], "}"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ListLogLinearPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "newg"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xmin", ",", "xmax"}], "}"}], ",", "Automatic"}], "}"}]}], 
       ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic", ",", "None", ",", "new"}], 
         "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"1", ",", "0", ",", "0"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"0", ",", "1", ",", "0"}], "]"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"1", ",", "0", ",", "0"}], "]"}], "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"0", ",", "1", ",", "0"}], "]"}], "}"}]}], "}"}]}], ",", 
       "opts"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.4000797499375*^9, {3.400080176171875*^9, 3.400080178765625*^9}, {
   3.400080335796875*^9, 3.400080336359375*^9}, {3.400080429390625*^9, 
   3.400080436140625*^9}, 3.40008047878125*^9, {3.400083974578125*^9, 
   3.40008397546875*^9}, {3.4000840520625*^9, 3.400084123875*^9}, {
   3.400084372796875*^9, 3.400084373359375*^9}, 3.40008452990625*^9, {
   3.400084564765625*^9, 3.4000845756875*^9}, {3.40008473228125*^9, 
   3.400084733453125*^9}, {3.40008489659375*^9, 3.400084924203125*^9}, 
   3.400084992828125*^9, {3.400085145453125*^9, 3.4000851933125*^9}, {
   3.40008566071875*^9, 3.400085669109375*^9}, {3.400231545703125*^9, 
   3.40023158303125*^9}, {3.4002317873125*^9, 3.40023179765625*^9}, {
   3.400246157984375*^9, 3.400246162265625*^9}, {3.400252778671875*^9, 
   3.400252805421875*^9}, {3.400252930890625*^9, 3.400252981984375*^9}, {
   3.405069598728875*^9, 3.40506961477575*^9}, 3.40526446675*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphs", "=", 
   RowBox[{"loggraphs", "=", 
    RowBox[{"timescalegraphs", "=", 
     RowBox[{"timescale2graphs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{",", 
        RowBox[{"{", "nruns", "}"}]}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.400230191015625*^9, 3.40023021478125*^9}, {
   3.400230271109375*^9, 3.40023027178125*^9}, 3.400231616328125*^9, {
   3.40023188815625*^9, 3.40023189925*^9}, 3.40025620171875*^9, {
   3.406283803859375*^9, 3.40628380465625*^9}, {3.406284194484375*^9, 
   3.40628420475*^9}, {3.4062855875*^9, 3.4062855888125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"o1", "=", "1"}], ",", 
     RowBox[{"q1", "=", "1"}], ",", 
     RowBox[{"o2", "=", "2"}], ",", 
     RowBox[{"q2", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newdirectory2", "=", 
     RowBox[{"\"\<graphs comparing \>\"", "~~", 
      RowBox[{"shortfilenames", "[", 
       RowBox[{"[", 
        RowBox[{"o1", ",", "2"}], "]"}], "]"}], "~~", "\"\< (units_\>\"", "~~", 
      RowBox[{"ToString", "[", "q1", "]"}], "~~", "\"\<)\>\"", "~~", 
      "\"\< with \>\"", "~~", 
      RowBox[{"shortfilenames", "[", 
       RowBox[{"[", 
        RowBox[{"o2", ",", "2"}], "]"}], "]"}], "~~", "\"\< (units_\>\"", "~~", 
      RowBox[{"ToString", "[", "q2", "]"}], "~~", "\"\<)\>\""}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CreateDirectory", "[", "newdirectory2", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SetDirectory", "[", "newdirectory2", "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dataset1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data3", "[", 
             RowBox[{"[", 
              RowBox[{"o1", ",", "q1", ",", "1", ",", "i"}], "]"}], "]"}], 
            ",", 
            RowBox[{"data3", "[", 
             RowBox[{"[", 
              RowBox[{"o1", ",", "q1", ",", 
               RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"data3", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "q1", ",", 
                RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dataset2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data3", "[", 
             RowBox[{"[", 
              RowBox[{"o2", ",", "q2", ",", "1", ",", "i"}], "]"}], "]"}], 
            ",", 
            RowBox[{"data3", "[", 
             RowBox[{"[", 
              RowBox[{"o2", ",", "q2", ",", 
               RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"data3", "[", 
              RowBox[{"[", 
               RowBox[{"o2", ",", "q2", ",", 
                RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"graphs", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "=", 
        RowBox[{"TwoAxisPlot", "[", 
         RowBox[{"dataset1", ",", "dataset2", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"600", ",", "400"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<year\>\"", ",", 
             RowBox[{"yaxislabels", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", 
                RowBox[{"2", "+", "q1"}]}], "]"}], "]"}], ",", "\"\<\>\"", 
             ",", 
             RowBox[{"yaxislabels", "[", 
              RowBox[{"[", 
               RowBox[{"o2", ",", 
                RowBox[{"2", "+", "q2"}]}], "]"}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"StyleForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"runids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
              RowBox[{"emissions", "[", 
               RowBox[{"[", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"Ceiling", "[", 
                   RowBox[{"k", "/", "4"}], "]"}], ",", "6", ",", "1"}], 
                 "]"}], "]"}], "]"}], "~~", "\"\<\\n\>\"", "~~", 
              RowBox[{"weathering", "[", 
               RowBox[{"[", 
                RowBox[{"Mod", "[", 
                 RowBox[{"k", ",", "4", ",", "1"}], "]"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "None"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", "Thin"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"runids", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
          RowBox[{"shortfilenames", "[", 
           RowBox[{"[", 
            RowBox[{"o1", ",", "2"}], "]"}], "]"}], "~~", "\"\< (\>\"", "~~", 
          RowBox[{"ToString", "[", "q1", "]"}], "~~", "\"\<)\>\"", "~~", 
          "\"\<_vs_\>\"", "~~", 
          RowBox[{"shortfilenames", "[", 
           RowBox[{"[", 
            RowBox[{"o2", ",", "2"}], "]"}], "]"}], "~~", "\"\< (\>\"", "~~", 
          RowBox[{"ToString", "[", "q2", "]"}], "~~", "\"\<).png\>\""}], ",", 
         RowBox[{"graphs", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"SetDirectory", "[", "\"\<..\>\"", "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"runidsprefix", "~~", 
       RowBox[{"ToString", "[", 
        RowBox[{"runidsrange", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "~~", "\"\<-\>\"", "~~", 
       RowBox[{"ToString", "[", 
        RowBox[{"runidsrange", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "~~", 
       RowBox[{"shortfilenames", "[", 
        RowBox[{"[", 
         RowBox[{"o1", ",", "2"}], "]"}], "]"}], "~~", "\"\< (\>\"", "~~", 
       RowBox[{"ToString", "[", "q1", "]"}], "~~", "\"\<)\>\"", "~~", 
       "\"\<_vs_\>\"", "~~", 
       RowBox[{"shortfilenames", "[", 
        RowBox[{"[", 
         RowBox[{"o2", ",", "2"}], "]"}], "]"}], "~~", "\"\< (\>\"", "~~", 
       RowBox[{"ToString", "[", "q2", "]"}], "~~", "\"\<).png\>\""}], ",", 
      RowBox[{"grid", "=", 
       RowBox[{"GraphicsGrid", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"graphs", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"4", "*", "j"}], "+", "i"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "0", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"DisplayFunction", "\[Rule]", "$DisplayFunction"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]}]}], "]"}], 
    ";"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4062841775625*^9, 3.40628418659375*^9}, {
   3.406284354046875*^9, 3.40628435528125*^9}, {3.4062843969375*^9, 
   3.406284400796875*^9}, {3.406284464515625*^9, 3.4062844784375*^9}, {
   3.4062847435625*^9, 3.406284752234375*^9}, {3.406284875453125*^9, 
   3.406284984328125*^9}, {3.4062850289375*^9, 3.406285115203125*^9}, {
   3.406285200828125*^9, 3.40628529828125*^9}, {3.4062854306875*^9, 
   3.406285454234375*^9}, {3.406285729265625*^9, 3.406285747625*^9}, 
   3.406285791328125*^9, {3.406285898375*^9, 3.40628596753125*^9}, {
   3.406286046453125*^9, 3.406286070234375*^9}, {3.4062862395*^9, 
   3.40628629378125*^9}, {3.406286357953125*^9, 3.40628635875*^9}, {
   3.406286549671875*^9, 3.40628655471875*^9}, {3.4062866686875*^9, 
   3.406286669984375*^9}, {3.40628688559375*^9, 3.406286887828125*^9}, {
   3.4062869371875*^9, 3.40628694421875*^9}, {3.406287026078125*^9, 
   3.40628702896875*^9}, {3.40628733725*^9, 3.40628734575*^9}, {
   3.406287390328125*^9, 3.40628743415625*^9}, {3.406287570859375*^9, 
   3.40628758334375*^9}, {3.406287669171875*^9, 3.406287679234375*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", "grid", "]"}]], "Input",
 CellChangeTimes->{{3.406287656890625*^9, 3.406287659546875*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dataset1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"data3", "[", 
          RowBox[{"[", 
           RowBox[{"o1", ",", "q1", ",", "1", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"data3", "[", 
          RowBox[{"[", 
           RowBox[{"o1", ",", "q1", ",", 
            RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"data3", "[", 
           RowBox[{"[", 
            RowBox[{"o1", ",", "q1", ",", 
             RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dataset2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"data3", "[", 
          RowBox[{"[", 
           RowBox[{"o2", ",", "q2", ",", "1", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"data3", "[", 
          RowBox[{"[", 
           RowBox[{"o2", ",", "q2", ",", 
            RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"data3", "[", 
           RowBox[{"[", 
            RowBox[{"o2", ",", "q2", ",", 
             RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"TwoAxisPlot", "[", 
     RowBox[{"dataset1", ",", "dataset2", ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"600", ",", "400"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<year\>\"", ",", 
         RowBox[{"yaxislabels", "[", 
          RowBox[{"[", 
           RowBox[{"o1", ",", 
            RowBox[{"2", "+", "q1"}]}], "]"}], "]"}], ",", "\"\<\>\"", ",", 
         RowBox[{"yaxislabels", "[", 
          RowBox[{"[", 
           RowBox[{"o2", ",", 
            RowBox[{"2", "+", "q2"}]}], "]"}], "]"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"StyleForm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"shortfilenames", "[", 
           RowBox[{"[", 
            RowBox[{"o1", ",", "2"}], "]"}], "]"}], "~~", "\"\< vs \>\"", "~~", 
          RowBox[{"shortfilenames", "[", 
           RowBox[{"[", 
            RowBox[{"o2", ",", "2"}], "]"}], "]"}], "~~", "\"\<\\n\>\"", "~~", 
          RowBox[{"runids", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
          RowBox[{"weathering", "[", 
           RowBox[{"[", 
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "4", ",", "1"}], "]"}], "]"}], "]"}], "~~", 
          "\"\<; \>\"", "~~", 
          RowBox[{"emissions", "[", 
           RowBox[{"[", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{"k", "/", "4"}], "]"}], ",", "6", ",", "1"}], "]"}], 
            "]"}], "]"}]}], ",", 
         RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
         RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", "900", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"GridLinesStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Thin", ",", "Thin"}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"o1", ",", "1", ",", "\"\<variable 1\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nfilenames"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"o2", ",", "1", ",", "\"\<variable 2\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nfilenames"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q1", ",", "1", ",", "\"\<units 1\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"data3", "[", 
           RowBox[{"[", "o1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q2", ",", "1", ",", "\"\<units 2\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"data3", "[", 
           RowBox[{"[", "o2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "\"\<run ID\>\""}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.399802215546875*^9, 3.399802383140625*^9}, {
   3.39980242046875*^9, 3.399802496328125*^9}, {3.399802546453125*^9, 
   3.399802570390625*^9}, {3.399802622046875*^9, 3.399802665625*^9}, {
   3.399802799484375*^9, 3.3998028529375*^9}, {3.399802930859375*^9, 
   3.39980307659375*^9}, {3.39980311275*^9, 3.399803145015625*^9}, {
   3.399803228078125*^9, 3.399803254625*^9}, {3.399803504703125*^9, 
   3.3998035993125*^9}, {3.399803845796875*^9, 3.39980388490625*^9}, {
   3.399803940890625*^9, 3.399803965921875*^9}, {3.399804274375*^9, 
   3.399804298125*^9}, {3.399804331984375*^9, 3.399804332234375*^9}, {
   3.399804367640625*^9, 3.399804375875*^9}, {3.39980465*^9, 
   3.399804699390625*^9}, {3.399804811984375*^9, 3.399804921453125*^9}, {
   3.399805093765625*^9, 3.39980515209375*^9}, {3.399805188421875*^9, 
   3.399805229609375*^9}, {3.399805281671875*^9, 3.3998052821875*^9}, {
   3.399805317390625*^9, 3.39980531784375*^9}, {3.399805361484375*^9, 
   3.399805406625*^9}, {3.399805464109375*^9, 3.39980549253125*^9}, {
   3.39980554003125*^9, 3.399805559671875*^9}, {3.39980573365625*^9, 
   3.3998058186875*^9}, {3.399805872171875*^9, 3.399805900765625*^9}, {
   3.3998059914375*^9, 3.399806032234375*^9}, {3.399806079171875*^9, 
   3.399806088203125*^9}, {3.399806137546875*^9, 3.399806165015625*^9}, 
   3.39980631121875*^9, {3.399806428796875*^9, 3.399806465421875*^9}, {
   3.399806513296875*^9, 3.399806530203125*^9}, {3.39980658909375*^9, 
   3.3998065908125*^9}, 3.3998066975*^9, {3.3998067385625*^9, 
   3.399806741984375*^9}, {3.3998068225625*^9, 3.399806822859375*^9}, {
   3.399806857140625*^9, 3.39980688875*^9}, {3.39980706328125*^9, 
   3.399807112625*^9}, {3.399807257734375*^9, 3.399807315796875*^9}, {
   3.3998078945625*^9, 3.39980789490625*^9}, {3.399807937*^9, 
   3.3998079471875*^9}, {3.39980801978125*^9, 3.399808040296875*^9}, {
   3.399808643046875*^9, 3.399808646140625*^9}, {3.399808687984375*^9, 
   3.39980885309375*^9}, {3.399808903359375*^9, 3.39980892865625*^9}, {
   3.3998089685*^9, 3.399809003234375*^9}, {3.399809437359375*^9, 
   3.3998094624375*^9}, {3.399812059890625*^9, 3.39981207515625*^9}, {
   3.399812131734375*^9, 3.399812138*^9}, 3.3998121695625*^9, {
   3.39981353325*^9, 3.399813571953125*^9}, {3.399813617515625*^9, 
   3.399813626234375*^9}, {3.399813699234375*^9, 3.399813699515625*^9}, {
   3.399813804234375*^9, 3.3998138060625*^9}, {3.39981383925*^9, 
   3.39981387409375*^9}, {3.399813927859375*^9, 3.39981393828125*^9}, 
   3.3998140469375*^9, {3.39981412225*^9, 3.399814122421875*^9}, {
   3.39981418846875*^9, 3.399814290703125*^9}, {3.399814334671875*^9, 
   3.3998143513125*^9}, {3.399814490453125*^9, 3.39981451796875*^9}, {
   3.39981469209375*^9, 3.399814739890625*^9}, {3.399814807578125*^9, 
   3.399814850109375*^9}, {3.399814894140625*^9, 3.3998149041875*^9}, 
   3.399814940359375*^9, {3.39981499978125*^9, 3.399815007609375*^9}, {
   3.39981503803125*^9, 3.399815067671875*^9}, {3.3998152955625*^9, 
   3.399815300875*^9}, {3.3998153395625*^9, 3.39981536596875*^9}, {
   3.3998154519375*^9, 3.399815456421875*^9}, {3.3998167785625*^9, 
   3.399817003328125*^9}, {3.39981748321875*^9, 3.399817488359375*^9}, {
   3.39981752996875*^9, 3.399817544953125*^9}, {3.3998176238125*^9, 
   3.399817689171875*^9}, {3.3998182713125*^9, 3.399818281953125*^9}, {
   3.400065533703125*^9, 3.4000655338125*^9}, 3.400066499078125*^9, 
   3.400066567125*^9, {3.40022856978125*^9, 3.40022860265625*^9}, {
   3.400246474265625*^9, 3.400246477828125*^9}, {3.400313103421875*^9, 
   3.40031310365625*^9}, {3.40031340453125*^9, 3.400313405875*^9}, 
   3.400913551328125*^9, {3.40092106834375*^9, 3.400921072484375*^9}, {
   3.4009211148125*^9, 3.40092113275*^9}, 3.4009400641875*^9, {
   3.402396705421875*^9, 3.40239671475*^9}, {3.404486792578125*^9, 
   3.404486795671875*^9}, 3.404553764515625*^9, 3.404652035265625*^9, {
   3.404742854203125*^9, 3.40474286246875*^9}, {3.4047433488125*^9, 
   3.404743371765625*^9}, {3.4047434075625*^9, 3.404743424234375*^9}, {
   3.40474385228125*^9, 3.40474386396875*^9}, 3.40506599040075*^9, {
   3.40506705815075*^9, 3.405067058291375*^9}, {3.40507001652575*^9, 
   3.405070020853875*^9}, 3.405174842322625*^9, {3.405175980135125*^9, 
   3.4051759802445*^9}, {3.40517605115075*^9, 3.405176053510125*^9}, {
   3.405347353640625*^9, 3.405347362*^9}, 3.4060317349375*^9, {
   3.406034676640625*^9, 3.406034682140625*^9}, {3.4060350235*^9, 
   3.40603506378125*^9}, {3.40603518359375*^9, 3.40603518625*^9}, {
   3.40603521959375*^9, 3.406035311734375*^9}, {3.406035484328125*^9, 
   3.40603548440625*^9}, {3.4060355195*^9, 3.40603552171875*^9}, 
   3.40603558621875*^9, {3.40603562325*^9, 3.406035630171875*^9}, {
   3.4060357995625*^9, 3.4060358579375*^9}, {3.40603600509375*^9, 
   3.406036012296875*^9}, {3.406036104015625*^9, 3.4060361326875*^9}, {
   3.406036809453125*^9, 3.406036833328125*^9}, {3.40603688309375*^9, 
   3.4060369260625*^9}, {3.40603716503125*^9, 3.40603718265625*^9}, {
   3.406037214546875*^9, 3.40603724534375*^9}, {3.4060373131875*^9, 
   3.406037347421875*^9}, {3.406037412609375*^9, 3.406037428515625*^9}, {
   3.4060374625*^9, 3.4060374796875*^9}, {3.40603759159375*^9, 
   3.406037659109375*^9}, {3.406037805203125*^9, 3.406037818140625*^9}, {
   3.40603801615625*^9, 3.406038017734375*^9}, {3.4060381910625*^9, 
   3.406038200734375*^9}, {3.406038327453125*^9, 3.406038343828125*^9}, {
   3.40603846653125*^9, 3.406038472515625*^9}, 3.406038557796875*^9, {
   3.406040687015625*^9, 3.406040710546875*^9}, {3.406280406140625*^9, 
   3.406280456265625*^9}, {3.406280498515625*^9, 3.406280517734375*^9}, {
   3.406280653484375*^9, 3.406280714359375*^9}, {3.4062816714375*^9, 
   3.406281672640625*^9}, {3.406288062375*^9, 3.406288067125*^9}, {
   3.40628817153125*^9, 3.406288218234375*^9}, {3.406288257171875*^9, 
   3.406288270453125*^9}, {3.4062883850625*^9, 3.40628846040625*^9}, {
   3.406288514171875*^9, 3.4062885215*^9}, {3.40628879853125*^9, 
   3.4062888848125*^9}, {3.4062891035*^9, 3.406289104828125*^9}, {
   3.406289316828125*^9, 3.406289419890625*^9}, {3.4062894705625*^9, 
   3.406289472671875*^9}, {3.4062895236875*^9, 3.406289545484375*^9}, {
   3.406289575609375*^9, 3.406289576140625*^9}, {3.406289616203125*^9, 
   3.406289757015625*^9}, {3.40628979834375*^9, 3.406289803890625*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ii. Read in data direct from ouptut folders", "Subsection",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066498234375*^9}, 
   3.40006656671875*^9, {3.400072210765625*^9, 3.400072236359375*^9}, 
   3.438600140410165*^9, {3.447090987428429*^9, 3.447091015395765*^9}, {
   3.447091066548961*^9, 3.447091089810422*^9}, 3.447091145747695*^9, {
   3.447091183428233*^9, 3.447091183650327*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"data2", "=", 
    RowBox[{"columntitles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nfilenames", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", "nruns", "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"filename", "=", 
     RowBox[{"filenames", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", 
        RowBox[{"filenamenos", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\n-- \>\"", "~~", "filename", "~~", "\"\< --\\n\>\""}], 
     "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<processing \>\"", "~~", 
         RowBox[{"runids", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", 
        RowBox[{"outputfolder", "~~", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
           "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
         RowBox[{"runids", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "~~", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
           "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
         RowBox[{"modules", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Import", "[", "filename", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "data", "]"}], "\[Equal]", "List"}], ",", 
         RowBox[{
          RowBox[{"data", "=", 
           RowBox[{"ToString", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"data", "//", "TableForm"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"data", "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"data", ",", 
             RowBox[{"\"\<      \>\"", "->", "\"\<        \>\""}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"data", "=", 
           RowBox[{"StringInsert", "[", 
            RowBox[{"data", ",", "\"\<  \>\"", ",", "1"}], "]"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"data", ",", 
          RowBox[{"\"\<,\>\"", "->", "\"\</\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"StringInsert", "[", 
         RowBox[{"data", ",", "\"\<\\n\>\"", ",", 
          RowBox[{"1", "+", 
           RowBox[{"StringLength", "[", "data", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"data", ",", 
          RowBox[{"\"\<\\n\\n\>\"", "\[Rule]", "\"\<\\n\>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"data", ",", 
          RowBox[{"\"\<\\n\>\"", "\[Rule]", "\"\<\\n   \>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"data", ",", "\"\<\\n\>\""}], "]"}]}], ";", 
       RowBox[{"nx", "=", 
        RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "nx"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"spaces", "=", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"data", ",", 
          RowBox[{"\"\< \>\"", ".."}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"i", "=", "0"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "++"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"spaces", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"spaces", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"spaces", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"spaces", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}]}], ";", 
             RowBox[{"i", "--"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "spaces", "]"}], "-", "1"}], "}"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"i", "=", "1"}], ";", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"spaces", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", 
          RowBox[{"y", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"i", "++"}], ";"}]}], "]"}], ";", 
       RowBox[{"i", "--"}], ";", "\[IndentingNewLine]", 
       RowBox[{"spaces2", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"jj", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"jj", "+", "1"}], "\[LessEqual]", 
              RowBox[{"Length", "[", "y", "]"}]}], "&&", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "spaces", "]"}]}], "&&", 
             RowBox[{
              RowBox[{"spaces", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ">", 
              RowBox[{"y", "[", 
               RowBox[{"[", "jj", "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{"spaces", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", 
              RowBox[{"y", "[", 
               RowBox[{"[", 
                RowBox[{"jj", "+", "1"}], "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"spaces2", ",", 
              RowBox[{
               RowBox[{"spaces", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"[", "jj", "]"}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"jj", "++"}], ";", 
             RowBox[{"i", "--"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "spaces", "]"}], "-", "1"}], "}"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{
           RowBox[{"Length", "[", "spaces2", "]"}], "-", "1"}]}], ";", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"spaces2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", 
            RowBox[{"spaces2", "[", 
             RowBox[{"[", 
              RowBox[{"Length", "[", "spaces2", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"i", "--"}]}], "]"}], ";", 
         RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"spaces3", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"spaces2", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "i", ",", 
              RowBox[{"Length", "[", "spaces2", "]"}]}], "}"}]}], "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"spaces3", "=", 
        RowBox[{"Union", "[", "spaces2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"spaces3", ",", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"y", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"spaces3", "=", 
        RowBox[{"Sort", "[", "spaces3", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"spaces3", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"spaces3", ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Differences", "[", "spaces3", "]"}], ",", "1"}], "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{
           RowBox[{"data2", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"data", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "+", 
                  RowBox[{"spaces3", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "+", 
                  RowBox[{"spaces3", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"Length", "[", "spaces3", "]"}], "-", "1"}]}], 
              "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"nx", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"yy", "=", 
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"data", ",", "\"\<\\n\>\""}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"slashes", "=", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"data", ",", 
          RowBox[{"columntitledividers", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"slashes", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"slashes", ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Differences", "[", "slashes", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"slashes2", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"slashes", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "slashes", "]"}]}], "}"}]}], "]"}], 
            ",", "2"}], "]"}], ",", "yy"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"slashes3", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"slashes2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"slashes2", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"Length", "[", "slashes2", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"columntitles", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"data", ",", 
            RowBox[{"slashes3", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "slashes3", "]"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "o", ",", "k", ",", "l", ",", "m"}], "]"}], 
           "]"}], "=", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"data2", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "o", ",", "k", ",", "l", ",", "m"}], "]"}], 
             "]"}], ",", 
            RowBox[{"\"\<E\>\"", "\[Rule]", "\"\< 10^\>\""}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"l", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"data2", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"data2", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "o", ",", "k", ",", "l"}], "]"}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data2", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"data2", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "]"}]}], ";"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", " ", "nruns"}], "}"}]}], "]"}], ";"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"j", ",", "nmodules"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"o", ",", 
     RowBox[{"nfilenames", "[", 
      RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.447088725380843*^9, 3.447088776101388*^9}, {
   3.447088822996318*^9, 3.44708887284533*^9}, {3.447089459271929*^9, 
   3.447089459733745*^9}, {3.447089667822595*^9, 3.447089759162603*^9}, {
   3.447090447507308*^9, 3.447090474784355*^9}, {3.447090516057886*^9, 
   3.447090541288518*^9}, {3.447090689194683*^9, 3.447090693952982*^9}, {
   3.447090730299028*^9, 3.447090739046455*^9}, {3.449333524517349*^9, 
   3.449333533059364*^9}, {3.449333563151858*^9, 3.449333569141156*^9}, {
   3.44933423436889*^9, 3.449334237075439*^9}, {3.449334296520988*^9, 
   3.449334297548524*^9}, {3.449334354673919*^9, 3.449334357998608*^9}, {
   3.449334499082287*^9, 3.449334533442565*^9}, {3.44933482791892*^9, 
   3.449334828205659*^9}, {3.449334903191051*^9, 3.449334907811626*^9}, 
   3.449335060402785*^9, {3.449336452764031*^9, 3.449336455422215*^9}, {
   3.449339636643377*^9, 3.449339648251328*^9}, 3.451383879694612*^9, {
   3.451384060572503*^9, 3.451384061234438*^9}, {3.451384105944348*^9, 
   3.451384106701307*^9}, 3.451384939589035*^9, 3.451385450338742*^9, {
   3.451385498878995*^9, 3.45138549976556*^9}, {3.451732034666686*^9, 
   3.451732087232742*^9}, {3.451732167641644*^9, 3.451732168851642*^9}, {
   3.451732383146074*^9, 3.451732389078899*^9}, {3.451732796626199*^9, 
   3.451732805486141*^9}, {3.451732956046756*^9, 3.45173295860457*^9}, {
   3.451732997029121*^9, 3.451733062571257*^9}, {3.451733218956022*^9, 
   3.451733219613291*^9}, {3.451734004097474*^9, 3.451734008148481*^9}, 
   3.451734055119762*^9, {3.451735854084636*^9, 3.451735855087784*^9}, {
   3.451736335064507*^9, 3.451736337141128*^9}, {3.451737219786357*^9, 
   3.45173722049471*^9}, {3.451737276749307*^9, 3.451737277348518*^9}, {
   3.451737320686572*^9, 3.451737334980499*^9}, {3.451737369089003*^9, 
   3.451737369709502*^9}, {3.451737409463422*^9, 3.451737414164876*^9}, {
   3.45173744612565*^9, 3.451737453254104*^9}, {3.451737978316956*^9, 
   3.451737992333976*^9}, 3.451738030590705*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["0. Set-up I/O", "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.40006644521875*^9}, {
   3.40006649821875*^9, 3.400066566703125*^9}, {3.437727312162577*^9, 
   3.437727319537369*^9}, 3.438600136025002*^9, {3.438600171194145*^9, 
   3.438600178312529*^9}}],

Cell["to read in ensemble data load and execute ensemble .nb file", "Text",
 CellChangeTimes->{{3.438600185950473*^9, 3.438600205838151*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"outputnotebook", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.4385998503239*^9, 3.438599875159067*^9}, 
   3.438603119651833*^9, 3.441542863823042*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"outputnotebook", "\[Equal]", "1"}], ",", 
    RowBox[{
     RowBox[{"$nb", "=", 
      RowBox[{"NotebookCreate", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$DisplayFunction", "=", 
      RowBox[{
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"$nb", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"GraphicsData", "[", 
            RowBox[{"\"\<PostScript\>\"", ",", 
             RowBox[{"DisplayString", "[", "#", "]"}]}], "]"}], ",", 
           "\"\<Graphics\>\""}], "]"}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$Post", "=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", "=!=", "Null"}], ",", 
         RowBox[{"NotebookWrite", "[", 
          RowBox[{"$nb", ",", 
           RowBox[{"Cell", "[", 
            RowBox[{
             RowBox[{"BoxData", "[", 
              RowBox[{"MakeBoxes", "[", 
               RowBox[{"#", ",", "StandardForm"}], "]"}], "]"}], ",", 
             "\"\<Output\>\""}], "]"}]}], "]"}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Unprotect", "[", "Print", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "x_", "]"}], ":=", 
      RowBox[{"NotebookWrite", "[", 
       RowBox[{"$nb", ",", 
        RowBox[{"Cell", "[", 
         RowBox[{"BoxData", "[", 
          RowBox[{"MakeBoxes", "[", 
           RowBox[{"x", ",", "StandardForm"}], "]"}], "]"}], "]"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "x__", "]"}], ":=", 
      RowBox[{"M", " ", 
       RowBox[{"ap", "[", 
        RowBox[{"Print", ",", 
         RowBox[{"{", "x", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Protect", "[", "Print", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Unprotect", "[", "StylePrint", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"StylePrint", "[", "x_", "]"}], ":=", 
      RowBox[{"NotebookWrite", "[", 
       RowBox[{"$nb", ",", 
        RowBox[{"Cell", "[", 
         RowBox[{
          RowBox[{"BoxData", "[", 
           RowBox[{"ToBoxes", "[", "x", "]"}], "]"}], ",", "\"\<Output\>\""}],
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"StylePrint", "[", 
       RowBox[{"x_", ",", "rest__"}], "]"}], ":=", 
      RowBox[{"NotebookWrite", "[", 
       RowBox[{"$nb", ",", 
        RowBox[{"Cell", "[", 
         RowBox[{
          RowBox[{"BoxData", "[", 
           RowBox[{"ToBoxes", "[", "x", "]"}], "]"}], ",", "rest"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Protect", "[", "StylePrint", "]"}], ";"}]}], "]"}], 
  ";"}]], "Input"]
}, Closed]]
}, Closed]]
},
CellGrouping->Manual,
WindowSize->{1272, 942},
WindowMargins->{{0, Automatic}, {24, Automatic}},
FrontEndVersion->"7.0 for Linux x86 (32-bit) (February 25, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 223, 3, 73, "Section"],
Cell[793, 27, 938, 27, 99, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1734, 56, 441, 8, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2178, 66, 407, 8, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2588, 76, 206, 4, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2797, 82, 1014, 25, 55, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[3814, 109, 219, 4, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[4036, 115, 719, 16, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[4758, 133, 835, 23, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[5596, 158, 571, 16, 55, "Input"],
Cell[6170, 176, 127, 2, 32, "Input"],
Cell[6300, 180, 904, 19, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[7207, 201, 4736, 116, 275, "Input"],
Cell[11946, 319, 256, 7, 32, "Input"],
Cell[12205, 328, 1101, 23, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[13309, 353, 286, 6, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[13598, 361, 856, 18, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[14457, 381, 561, 16, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[15021, 399, 874, 23, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[15898, 424, 641, 13, 165, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[16542, 439, 480, 10, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[17025, 451, 634, 11, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[17662, 464, 263, 5, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[17928, 471, 1324, 30, 55, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[19255, 503, 206, 4, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[19464, 509, 1690, 49, 99, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[21157, 560, 381, 8, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[21541, 570, 672, 13, 32, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[22250, 588, 221, 3, 43, "Section"],
Cell[22474, 593, 1860, 42, 143, "Input"],
Cell[24337, 637, 1216, 34, 77, "Input"],
Cell[25556, 673, 201, 3, 32, "Input"],
Cell[25760, 678, 181, 3, 32, "Input"],
Cell[25944, 683, 737, 16, 55, "Input"],
Cell[26684, 701, 5656, 129, 209, "Input"],
Cell[32343, 832, 337, 9, 32, "Input"],
Cell[32683, 843, 913, 24, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[33633, 872, 319, 4, 43, "Section"],
Cell[CellGroupData[{
Cell[33977, 880, 220, 3, 32, "Subsubtitle"],
Cell[CellGroupData[{
Cell[34222, 887, 396, 5, 39, "Subsection"],
Cell[34621, 894, 5723, 148, 539, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40393, 1048, 252, 3, 32, "Subsubtitle"],
Cell[40648, 1053, 1004, 26, 32, "Input"],
Cell[41655, 1081, 378, 10, 32, "Input"],
Cell[42036, 1093, 959, 26, 32, "Input"],
Cell[42998, 1121, 135, 2, 32, "Input"],
Cell[43136, 1125, 39, 0, 32, "Input"],
Cell[43178, 1127, 1301, 35, 55, "Input"],
Cell[44482, 1164, 4019, 92, 165, "Input"],
Cell[48504, 1258, 1309, 27, 143, "Input"],
Cell[49816, 1287, 168, 3, 32, "Input"],
Cell[49987, 1292, 555, 11, 32, "Input"],
Cell[50545, 1305, 2421, 50, 99, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[53015, 1361, 265, 4, 43, "Section"],
Cell[CellGroupData[{
Cell[53305, 1369, 198, 3, 32, "Subsubtitle"],
Cell[53506, 1374, 1484, 27, 55, "Input"],
Cell[54993, 1403, 1270, 30, 99, "Input"],
Cell[56266, 1435, 37, 0, 32, "Input"],
Cell[56306, 1437, 2207, 48, 77, "Input"],
Cell[58516, 1487, 1083, 32, 32, "Input"],
Cell[59602, 1521, 139, 3, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[59778, 1529, 355, 5, 32, "Subsubtitle"],
Cell[60136, 1536, 169, 3, 32, "Input"],
Cell[60308, 1541, 869, 21, 32, "Input"],
Cell[61180, 1564, 1762, 48, 77, "Input"],
Cell[62945, 1614, 1704, 46, 77, "Input"],
Cell[64652, 1662, 2748, 65, 165, "Input"],
Cell[67403, 1729, 678, 18, 32, "Input"],
Cell[68084, 1749, 2506, 70, 165, "Input"],
Cell[70593, 1821, 511, 13, 32, "Input"],
Cell[71107, 1836, 302, 7, 32, "Input"],
Cell[71412, 1845, 202, 5, 32, "Input"],
Cell[71617, 1852, 195, 3, 32, "Input"],
Cell[71815, 1857, 722, 14, 77, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[72574, 1876, 382, 5, 32, "Subsubtitle"],
Cell[72959, 1883, 181, 4, 32, "Input"],
Cell[73143, 1889, 924, 24, 32, "Input"],
Cell[74070, 1915, 1023, 27, 55, "Input"],
Cell[75096, 1944, 1204, 31, 55, "Input"],
Cell[76303, 1977, 2053, 54, 99, "Input"],
Cell[78359, 2033, 646, 17, 32, "Input"],
Cell[79008, 2052, 698, 18, 32, "Input"],
Cell[79709, 2072, 1141, 28, 32, "Input"],
Cell[80853, 2102, 1256, 32, 55, "Input"],
Cell[82112, 2136, 7142, 152, 495, "Input"],
Cell[89257, 2290, 2784, 83, 165, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[92078, 2378, 429, 6, 32, "Subsubtitle"],
Cell[92510, 2386, 574, 12, 32, "Input"],
Cell[93087, 2400, 854, 24, 77, "Input"],
Cell[93944, 2426, 35443, 747, 1639, "Input"],
Cell[129390, 3175, 134, 4, 32, "Input"],
Cell[129527, 3181, 415, 11, 32, "Input"],
Cell[129945, 3194, 328, 8, 32, "Input"],
Cell[130276, 3204, 157, 3, 32, "Input"],
Cell[130436, 3209, 154, 3, 32, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[130639, 3218, 496, 7, 32, "Subsubtitle"],
Cell[131138, 3227, 143, 3, 32, "Input"],
Cell[131284, 3232, 574, 12, 32, "Input"],
Cell[131861, 3246, 854, 24, 77, "Input"],
Cell[132718, 3272, 36074, 793, 1793, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[168829, 4070, 484, 7, 32, "Subsubtitle"],
Cell[169316, 4079, 574, 12, 32, "Input"],
Cell[169893, 4093, 854, 24, 77, "Input"],
Cell[170750, 4119, 1582, 41, 143, "Input"],
Cell[172335, 4162, 36866, 749, 1573, "Input"],
Cell[209204, 4913, 556, 16, 32, "Input"],
Cell[209763, 4931, 850, 20, 32, "Input"],
Cell[210616, 4953, 98, 1, 32, "Input"],
Cell[210717, 4956, 751, 21, 32, "Input"],
Cell[211471, 4979, 261, 7, 32, "Input"],
Cell[211735, 4988, 189, 4, 32, "Input"],
Cell[211927, 4994, 417, 11, 32, "Input"],
Cell[212347, 5007, 134, 4, 32, "Input"],
Cell[212484, 5013, 367, 10, 32, "Input"],
Cell[212854, 5025, 328, 8, 32, "Input"],
Cell[213185, 5035, 157, 3, 32, "Input"],
Cell[213345, 5040, 154, 3, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[213536, 5048, 381, 5, 43, "Section"],
Cell[213920, 5055, 1875, 56, 77, "Input"],
Cell[215798, 5113, 8313, 222, 407, "Input"],
Cell[CellGroupData[{
Cell[224136, 5339, 1080, 32, 55, "Input"],
Cell[225219, 5373, 1035, 31, 55, "Input"]
}, Closed]],
Cell[226269, 5407, 265, 6, 55, "Input"],
Cell[226537, 5415, 22142, 475, 1353, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[248716, 5895, 772, 22, 45, "Section"],
Cell[249491, 5919, 605, 12, 32, "Input"],
Cell[250099, 5933, 628, 10, 121, "Input"],
Cell[250730, 5945, 142, 2, 32, "Input"],
Cell[250875, 5949, 626, 16, 32, "Input"],
Cell[251504, 5967, 524, 11, 32, "Input"],
Cell[252031, 5980, 219, 4, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[252287, 5989, 397, 6, 43, "Section"],
Cell[CellGroupData[{
Cell[252709, 5999, 626, 9, 32, "Subsubtitle"],
Cell[253338, 6010, 77, 1, 32, "Input"],
Cell[253418, 6013, 466, 9, 55, "Input"],
Cell[253887, 6024, 1112, 26, 77, "Input"],
Cell[255002, 6052, 129, 2, 32, "Input"],
Cell[255134, 6056, 466, 11, 32, "Input"],
Cell[255603, 6069, 1678, 36, 77, "Input"],
Cell[257284, 6107, 1202, 30, 55, "Input"],
Cell[258489, 6139, 402, 13, 32, "Input"],
Cell[258894, 6154, 198, 4, 32, "Input"],
Cell[259095, 6160, 590, 16, 32, "Input"],
Cell[259688, 6178, 1135, 29, 77, "Input"],
Cell[260826, 6209, 1065, 28, 55, "Input"],
Cell[261894, 6239, 1125, 31, 55, "Input"],
Cell[263022, 6272, 1373, 39, 55, "Input"],
Cell[264398, 6313, 1608, 39, 55, "Input"],
Cell[266009, 6354, 1481, 40, 55, "Input"],
Cell[267493, 6396, 1670, 40, 55, "Input"],
Cell[269166, 6438, 640, 19, 32, "Input"],
Cell[269809, 6459, 401, 8, 32, "Input"],
Cell[270213, 6469, 1719, 45, 99, "Input"],
Cell[271935, 6516, 1841, 52, 121, "Input"],
Cell[273779, 6570, 365, 10, 55, "Input"],
Cell[274147, 6582, 1689, 46, 99, "Input"],
Cell[275839, 6630, 759, 20, 55, "Input"],
Cell[276601, 6652, 405, 9, 32, "Input"],
Cell[277009, 6663, 9043, 229, 495, "Input"],
Cell[286055, 6894, 5597, 151, 231, "Input"],
Cell[291655, 7047, 4455, 110, 209, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[296147, 7162, 636, 9, 32, "Subsubtitle"],
Cell[296786, 7173, 16673, 417, 825, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[313496, 7595, 698, 10, 32, "Subsubtitle"],
Cell[314197, 7607, 16833, 401, 847, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[331067, 8013, 799, 11, 32, "Subsubtitle"],
Cell[331869, 8026, 22036, 536, 1111, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[353942, 8567, 857, 12, 32, "Subsubtitle"],
Cell[354802, 8581, 27412, 639, 1375, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[382251, 9225, 901, 12, 32, "Subsubtitle"],
Cell[383155, 9239, 32950, 766, 1661, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[416142, 10010, 867, 12, 32, "Subsubtitle"],
Cell[417012, 10024, 47806, 1053, 2079, "Input"],
Cell[464821, 11079, 409, 12, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[465267, 11096, 815, 11, 32, "Subsubtitle"],
Cell[466085, 11109, 56069, 1244, 2475, "Input"],
Cell[522157, 12355, 409, 12, 32, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[522615, 12373, 463, 6, 73, "Section"],
Cell[CellGroupData[{
Cell[523103, 12383, 477, 8, 39, "Subsection"],
Cell[523583, 12393, 1311, 26, 55, "Input"],
Cell[524897, 12421, 4300, 96, 231, "Input"],
Cell[529200, 12519, 97, 1, 32, "Input"],
Cell[529300, 12522, 373, 10, 32, "Input"],
Cell[529676, 12534, 2645, 62, 121, "Input"],
Cell[532324, 12598, 376, 11, 55, "Input"],
Cell[532703, 12611, 294, 6, 32, "Input"],
Cell[533000, 12619, 46543, 1017, 2959, "Input"]
}, Closed]],
Cell[579558, 13639, 206, 3, 26, "Input"],
Cell[CellGroupData[{
Cell[579789, 13646, 355, 5, 39, "Subsection"],
Cell[580147, 13653, 305, 7, 32, "Input"],
Cell[580455, 13662, 1222, 22, 32, "Input"],
Cell[581680, 13686, 120, 2, 32, "Input"],
Cell[581803, 13690, 229, 5, 31, "Text"],
Cell[582035, 13697, 374, 8, 55, "Input"],
Cell[582412, 13707, 7653, 203, 275, "Input"],
Cell[590068, 13912, 612, 13, 32, "Input"],
Cell[CellGroupData[{
Cell[590705, 13929, 8534, 195, 649, "Input"],
Cell[599242, 14126, 126, 2, 32, "Input"]
}, Open  ]],
Cell[599383, 14131, 11901, 240, 429, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[611321, 14376, 396, 5, 31, "Subsection"],
Cell[611720, 14383, 17145, 417, 1309, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[628902, 14805, 268, 4, 43, "Section"],
Cell[629173, 14811, 141, 1, 31, "Text"],
Cell[629317, 14814, 192, 4, 32, "Input"],
Cell[629512, 14820, 2768, 72, 253, "Input"]
}, Closed]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
